
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Estimating Equilibrium Climate Sensitivity &#8212; CMIP6 Cookbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-pythia-theme.min.css?v=e502140d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../../_static/custom.css?v=6c0083f7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-T52X8HNYE8"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-T52X8HNYE8');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-T52X8HNYE8');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"9da2efd4b3ea4e7fa370e6a9d54ce0fc": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "7c1f8e389f1e4ae7b52a1d54d4d62f98": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "bd6d6f42bfcc4a35a70f0b93ad40d172": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_9da2efd4b3ea4e7fa370e6a9d54ce0fc", "max": 7.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_7c1f8e389f1e4ae7b52a1d54d4d62f98", "tabbable": null, "tooltip": null, "value": 7.0}}, "df1281467dba4c63b44af9d38fca34f9": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f702a3ee6a7a44479cf1115f705eadba": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "c2167f41e4534a1fab6e58281e174698": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_df1281467dba4c63b44af9d38fca34f9", "placeholder": "\u200b", "style": "IPY_MODEL_f702a3ee6a7a44479cf1115f705eadba", "tabbable": null, "tooltip": null, "value": "100%"}}, "c0fc82afc5a946b183ee501ee1ea2d71": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2efb0922d43b44b9b06a28ce288391bf": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "1a72c03f715743a291181fe913dd7c29": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_c0fc82afc5a946b183ee501ee1ea2d71", "placeholder": "\u200b", "style": "IPY_MODEL_2efb0922d43b44b9b06a28ce288391bf", "tabbable": null, "tooltip": null, "value": "\u20077/7\u2007[00:01&lt;00:00,\u2007\u20073.72it/s]"}}, "8b954eea521a4e9493e28c4a15cea6d4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2304b963ce884c41895cae1685d0364b": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_c2167f41e4534a1fab6e58281e174698", "IPY_MODEL_bd6d6f42bfcc4a35a70f0b93ad40d172", "IPY_MODEL_1a72c03f715743a291181fe913dd7c29"], "layout": "IPY_MODEL_8b954eea521a4e9493e28c4a15cea6d4", "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/example-workflows/ecs-cmip6';</script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Global Mean Surface Temperature" href="gmst.html" />
    <link rel="prev" title="Search and Load CMIP6 Data via ESGF/OPeNDAP" href="../foundations/esgf-opendap.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
    <meta name="docbuild:last-update" content="24 May 2024"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>

  
  <div class="pst-scroll-pixel-helper"></div>
    <header class="bd-header navbar navbar-dark navbar-expand-lg bg-dark fixed-top bd-navbar shadow" id="navbar-main">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

   

<a class="navbar-brand logo" href="https://projectpythia.org">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/pythia_logo-white-rtext.svg" class="logo__image only-light" alt="CMIP6 Cookbook - Home"/>
    <script>document.write(`<img src="../../_static/pythia_logo-white-rtext.svg" class="logo__image only-dark" alt="CMIP6 Cookbook - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><ul id="navbar-main-elements" class="navbar-nav">
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org">Home</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://foundations.projectpythia.org">Foundations</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://cookbooks.projectpythia.org">Cookbooks</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org/resource-gallery.html">Resources</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org/index.html#join-us">Community</a>
  </li>
  
  
</ul></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ProjectPythia" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/project_pythia" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/channel/UCoZPBqJal5uKpO8ZiwzavCw" title="YouTube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-youtube-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">YouTube</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </header>
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
        
        
        
        <div class="bd-sidebar-primary bd-sidebar">
          

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><ul id="navbar-main-elements" class="navbar-nav">
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org">Home</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://foundations.projectpythia.org">Foundations</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://cookbooks.projectpythia.org">Cookbooks</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org/resource-gallery.html">Resources</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://projectpythia.org/index.html#join-us">Community</a>
  </li>
  
  
</ul></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/ProjectPythia" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/project_pythia" title="Twitter" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">Twitter</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://www.youtube.com/channel/UCoZPBqJal5uKpO8ZiwzavCw" title="YouTube" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fab fa-youtube-square fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">YouTube</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../README.html">
                    CMIP6 Cookbook
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Preamble</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../how-to-cite.html">How to Cite This Cookbook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Foundations</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../foundations/intake-esm.html">Load CMIP6 Data with Intake-ESM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../foundations/google-cloud-basic.html">Google Cloud CMIP6 Public Data: Basic Python Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../foundations/esgf-opendap.html">Search and Load CMIP6 Data via ESGF/OPeNDAP</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Example workflows</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Estimating Equilibrium Climate Sensitivity</a></li>
<li class="toctree-l1"><a class="reference internal" href="gmst.html">Global Mean Surface Temperature</a></li>
<li class="toctree-l1"><a class="reference internal" href="precip-freq.html">Precipitation Frequency Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="xesmf-ohu.html">Regridding with xESMF and calculating a multi-model mean</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


        </div>

        
        <main id="main-content" class="bd-main" role="main">
          

            <div class="bd-content">

              <div class="bd-article-container">

                
                  
                  
<div id="searchbox"></div>
                  <article class="bd-article">
                    
  <p><a class="reference internal" href="../../_images/cmip6-cookbook-thumbnail.png"><img alt="CMIP6 image" src="../../_images/cmip6-cookbook-thumbnail.png" style="width: 250px;" /></a></img></p>
<section class="tex2jax_ignore mathjax_ignore" id="estimating-equilibrium-climate-sensitivity">
<h1>Estimating Equilibrium Climate Sensitivity<a class="headerlink" href="#estimating-equilibrium-climate-sensitivity" title="Link to this heading"><i class="fas fa-link"></i></a></h1>
<hr class="docutils" />
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<p>Equilibrium Climate Sensitivity (ECS) is defined as change in global-mean near-surface air temperature (GMST) change due to an instantaneous doubling of CO<span class="math notranslate nohighlight">\(_2\)</span> concentrations and once the coupled ocean-atmosphere-sea ice system has acheived a statistical equilibrium (i.e. at the top-of-atmosphere, incoming solar shortwave radiation is balanced by reflected solar shortwave and outgoing thermal longwave radiation).</p>
<p>This notebook uses the “<a class="reference external" href="https://doi.org/10.1029/2003GL018747">Gregory method</a>” to approximate the ECS of CMIP6 models based on the first 150 years after an abrupt doubling of CO<span class="math notranslate nohighlight">\(_2\)</span>
concentrations. The Gregory method extrapolates the quasi-linear relationship between GMST and radiative imbalance at the top-of-atmosphere to estimate how much warming would occur if the system were in radiative balance at the top-of-atmosphere, which is by definition the equilibrium response. In particular, we extrapolate the linear relationship that occurs between 100 and 150 years after the abrupt quadrupling.</p>
<p>Since the radiative forcing due to CO<span class="math notranslate nohighlight">\(_2\)</span> is a logarithmic function of the CO<span class="math notranslate nohighlight">\(_2\)</span> concentration, the GMST change from a first doubling is roughly the same as for a second doubling (to first order, we can assume feedbacks as constant), which means that the GMST change due to a quadrupling of CO<span class="math notranslate nohighlight">\(_2\)</span> is roughly <span class="math notranslate nohighlight">\(\Delta T_{4\times\mathrm{CO}_2}=2\times\mathrm{ECS}\)</span>. See also <a class="reference external" href="https://doi.org/10.1029/2018MS001400">Mauritsen et al. 2019</a> for a detailed application of the Gregory method (with modifications) for the case of one specific CMIP6 model, the MPI-M Earth System Model.</p>
<p>For another take on applying the Gregory method to estimate ECS, see <a class="reference external" href="https://github.com/apendergrass/cmip6-ecs">Angeline Pendergrass’ code</a>.</p>
</section>
<section id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Concepts</p></th>
<th class="head"><p>Importance</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://foundations.projectpythia.org/core/xarray/xarray-intro.html">Intro to Xarray</a></p></td>
<td><p>Necessary</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://foundations.projectpythia.org/core/data-formats/netcdf-cf.html">Understanding of NetCDF</a></p></td>
<td><p>Helpful</p></td>
<td><p>Familiarity with metadata structure</p></td>
</tr>
<tr class="row-even"><td><p>Dask</p></td>
<td><p>Helpful</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>Climate sensitivity</p></td>
<td><p>Helpful</p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p><strong>Time to learn</strong>: 30 minutes</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">cartopy</span>
<span class="kn">import</span> <span class="nn">dask</span>
<span class="kn">from</span> <span class="nn">tqdm.autonotebook</span> <span class="kn">import</span> <span class="n">tqdm</span>  <span class="c1"># Fancy progress bars for our loops!</span>
<span class="kn">import</span> <span class="nn">intake</span>
<span class="kn">import</span> <span class="nn">fsspec</span>
<span class="kn">from</span> <span class="nn">dask_gateway</span> <span class="kn">import</span> <span class="n">Gateway</span>
<span class="kn">from</span> <span class="nn">dask.distributed</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">6</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/1804016931.py:8: TqdmExperimentalWarning: Using `tqdm.autonotebook.tqdm` in notebook mode. Use `tqdm.tqdm` instead to force console mode (e.g. in jupyter console)
  from tqdm.autonotebook import tqdm  # Fancy progress bars for our loops!
</pre></div>
</div>
</div>
</div>
</section>
<section id="compute-cluster">
<h2>Compute Cluster<a class="headerlink" href="#compute-cluster" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<p>Here we use a dask cluster to parallelize our analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">platform</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span>

<span class="k">if</span> <span class="p">(</span><span class="n">platform</span> <span class="o">==</span> <span class="s1">&#39;win32&#39;</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">multiprocessing.popen_spawn_win32</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">multiprocessing.popen_spawn_posix</span>
</pre></div>
</div>
</div>
</div>
<p>Initiate the Dask client:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
<span class="n">client</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;"> </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px;">Client</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">Client-ecf74c25-19f1-11ef-8a3f-6045bd00a54f</p>
        <table style="width: 100%; text-align: left;">

        <tr>
        
            <td style="text-align: left;"><strong>Connection method:</strong> Cluster object</td>
            <td style="text-align: left;"><strong>Cluster type:</strong> distributed.LocalCluster</td>
        
        </tr>

        
            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard: </strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                </td>
                <td style="text-align: left;"></td>
            </tr>
        

        </table>

        

        
            <details>
            <summary style="margin-bottom: 20px;"><h3 style="display: inline;">Cluster Info</h3></summary>
            <div class="jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output">
    <div style="width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;">
    </div>
    <div style="margin-left: 48px;">
        <h3 style="margin-bottom: 0px; margin-top: 0px;">LocalCluster</h3>
        <p style="color: #9D9D9D; margin-bottom: 0px;">6533e735</p>
        <table style="width: 100%; text-align: left;">
            <tr>
                <td style="text-align: left;">
                    <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                </td>
                <td style="text-align: left;">
                    <strong>Workers:</strong> 4
                </td>
            </tr>
            <tr>
                <td style="text-align: left;">
                    <strong>Total threads:</strong> 4
                </td>
                <td style="text-align: left;">
                    <strong>Total memory:</strong> 15.61 GiB
                </td>
            </tr>
            
            <tr>
    <td style="text-align: left;"><strong>Status:</strong> running</td>
    <td style="text-align: left;"><strong>Using processes:</strong> True</td>
</tr>

            
        </table>

        <details>
            <summary style="margin-bottom: 20px;">
                <h3 style="display: inline;">Scheduler Info</h3>
            </summary>

            <div style="">
    <div>
        <div style="width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;"> </div>
        <div style="margin-left: 48px;">
            <h3 style="margin-bottom: 0px;">Scheduler</h3>
            <p style="color: #9D9D9D; margin-bottom: 0px;">Scheduler-3d9e4c62-9cdd-4611-bda0-08ff9e24d41b</p>
            <table style="width: 100%; text-align: left;">
                <tr>
                    <td style="text-align: left;">
                        <strong>Comm:</strong> tcp://127.0.0.1:41331
                    </td>
                    <td style="text-align: left;">
                        <strong>Workers:</strong> 4
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Dashboard:</strong> <a href="http://127.0.0.1:8787/status" target="_blank">http://127.0.0.1:8787/status</a>
                    </td>
                    <td style="text-align: left;">
                        <strong>Total threads:</strong> 4
                    </td>
                </tr>
                <tr>
                    <td style="text-align: left;">
                        <strong>Started:</strong> Just now
                    </td>
                    <td style="text-align: left;">
                        <strong>Total memory:</strong> 15.61 GiB
                    </td>
                </tr>
            </table>
        </div>
    </div>

    <details style="margin-left: 48px;">
        <summary style="margin-bottom: 20px;">
            <h3 style="display: inline;">Workers</h3>
        </summary>

        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 0</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:35263
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:44945/status" target="_blank">http://127.0.0.1:44945/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 3.90 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:38609
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-umkykbkx
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 1</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:38155
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:35741/status" target="_blank">http://127.0.0.1:35741/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 3.90 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:39189
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-9lg50ndz
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 2</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:41221
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:36903/status" target="_blank">http://127.0.0.1:36903/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 3.90 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:32843
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-ekgen8oo
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        
        <div style="margin-bottom: 20px;">
            <div style="width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;"> </div>
            <div style="margin-left: 48px;">
            <details>
                <summary>
                    <h4 style="margin-bottom: 0px; display: inline;">Worker: 3</h4>
                </summary>
                <table style="width: 100%; text-align: left;">
                    <tr>
                        <td style="text-align: left;">
                            <strong>Comm: </strong> tcp://127.0.0.1:43169
                        </td>
                        <td style="text-align: left;">
                            <strong>Total threads: </strong> 1
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Dashboard: </strong> <a href="http://127.0.0.1:37393/status" target="_blank">http://127.0.0.1:37393/status</a>
                        </td>
                        <td style="text-align: left;">
                            <strong>Memory: </strong> 3.90 GiB
                        </td>
                    </tr>
                    <tr>
                        <td style="text-align: left;">
                            <strong>Nanny: </strong> tcp://127.0.0.1:35595
                        </td>
                        <td style="text-align: left;"></td>
                    </tr>
                    <tr>
                        <td colspan="2" style="text-align: left;">
                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-bad6e44v
                        </td>
                    </tr>

                    

                    

                </table>
            </details>
            </div>
        </div>
        

    </details>
</div>

        </details>
    </div>
</div>
            </details>
        

    </div>
</div></div></div>
</div>
<section id="data-catalogs">
<h3>Data catalogs<a class="headerlink" href="#data-catalogs" title="Link to this heading"><i class="fas fa-link"></i></a></h3>
<p>This notebook uses <a class="reference external" href="https://intake-esm.readthedocs.io/en/latest/"><code class="docutils literal notranslate"><span class="pre">intake-esm</span></code></a> to ingest and organize climate model output from the fresh-off-the-supercomputers Phase 6 of the Coupled Model Intercomparison Project (CMIP6).</p>
<p>The file <code class="docutils literal notranslate"><span class="pre">https://storage.googleapis.com/cmip6/cmip6-zarr-consolidated-stores.csv</span></code> in Google Cloud Storage contains thousands of lines of metadata, each describing an individual climate model experiment’s simulated data.</p>
<p>For example, the first line in the <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file contains the precipitation rate (<code class="docutils literal notranslate"><span class="pre">variable_id</span> <span class="pre">=</span> <span class="pre">'pr'</span></code>), as a function of latitude, longitude, and time, in an individual climate model experiment with the BCC-ESM1 model (<code class="docutils literal notranslate"><span class="pre">source_id</span> <span class="pre">=</span> <span class="pre">'BCC-ESM1'</span></code>) developed by the Beijing Climate Center (<code class="docutils literal notranslate"><span class="pre">institution_id</span> <span class="pre">=</span> <span class="pre">'BCC'</span></code>). The model is forced by the forcing experiment SSP370 (<code class="docutils literal notranslate"><span class="pre">experiment_id</span> <span class="pre">=</span> <span class="pre">'ssp370'</span></code>), which stands for the Shared Socio-Economic Pathway 3 that results in a change in radiative forcing of <span class="math notranslate nohighlight">\(\Delta F=7.0\)</span> W m<span class="math notranslate nohighlight">\(^{-2}\)</span> from pre-industrial to 2100. This simulation was run as part of the <code class="docutils literal notranslate"><span class="pre">AerChemMIP</span></code> activity, which is a spin-off of the CMIP activity that focuses specifically on how aerosol chemistry affects climate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://storage.googleapis.com/cmip6/cmip6-zarr-consolidated-stores.csv&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>activity_id</th>
      <th>institution_id</th>
      <th>source_id</th>
      <th>experiment_id</th>
      <th>member_id</th>
      <th>table_id</th>
      <th>variable_id</th>
      <th>grid_label</th>
      <th>zstore</th>
      <th>dcpp_init_year</th>
      <th>version</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>HighResMIP</td>
      <td>CMCC</td>
      <td>CMCC-CM2-HR4</td>
      <td>highresSST-present</td>
      <td>r1i1p1f1</td>
      <td>Amon</td>
      <td>ps</td>
      <td>gn</td>
      <td>gs://cmip6/CMIP6/HighResMIP/CMCC/CMCC-CM2-HR4/...</td>
      <td>NaN</td>
      <td>20170706</td>
    </tr>
    <tr>
      <th>1</th>
      <td>HighResMIP</td>
      <td>CMCC</td>
      <td>CMCC-CM2-HR4</td>
      <td>highresSST-present</td>
      <td>r1i1p1f1</td>
      <td>Amon</td>
      <td>rsds</td>
      <td>gn</td>
      <td>gs://cmip6/CMIP6/HighResMIP/CMCC/CMCC-CM2-HR4/...</td>
      <td>NaN</td>
      <td>20170706</td>
    </tr>
    <tr>
      <th>2</th>
      <td>HighResMIP</td>
      <td>CMCC</td>
      <td>CMCC-CM2-HR4</td>
      <td>highresSST-present</td>
      <td>r1i1p1f1</td>
      <td>Amon</td>
      <td>rlus</td>
      <td>gn</td>
      <td>gs://cmip6/CMIP6/HighResMIP/CMCC/CMCC-CM2-HR4/...</td>
      <td>NaN</td>
      <td>20170706</td>
    </tr>
    <tr>
      <th>3</th>
      <td>HighResMIP</td>
      <td>CMCC</td>
      <td>CMCC-CM2-HR4</td>
      <td>highresSST-present</td>
      <td>r1i1p1f1</td>
      <td>Amon</td>
      <td>rlds</td>
      <td>gn</td>
      <td>gs://cmip6/CMIP6/HighResMIP/CMCC/CMCC-CM2-HR4/...</td>
      <td>NaN</td>
      <td>20170706</td>
    </tr>
    <tr>
      <th>4</th>
      <td>HighResMIP</td>
      <td>CMCC</td>
      <td>CMCC-CM2-HR4</td>
      <td>highresSST-present</td>
      <td>r1i1p1f1</td>
      <td>Amon</td>
      <td>psl</td>
      <td>gn</td>
      <td>gs://cmip6/CMIP6/HighResMIP/CMCC/CMCC-CM2-HR4/...</td>
      <td>NaN</td>
      <td>20170706</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The file <code class="docutils literal notranslate"><span class="pre">pangeo-cmip6.json</span></code> describes the structure of the CMIP6 metadata and is formatted so as to be read in by the <code class="docutils literal notranslate"><span class="pre">intake.open_esm_datastore</span></code> method, which categorizes all of the data pointers into a tiered collection. For example, this collection contains the simulated data from 28691 individual experiments, representing 48 different models from 23 different scientific institutions. There are 190 different climate variables (e.g. sea surface temperature, sea ice concentration, atmospheric winds, dissolved organic carbon in the ocean, etc.) available for 29 different forcing experiments.</p>
</section>
</section>
<section id="use-intake-esm">
<h2>Use Intake-ESM<a class="headerlink" href="#use-intake-esm" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<p><a class="reference external" href="https://intake-esm.readthedocs.io/en/stable/">Intake-ESM</a> is a new package designed to make working with these data archives a bit simpler.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">col</span> <span class="o">=</span> <span class="n">intake</span><span class="o">.</span><span class="n">open_esm_datastore</span><span class="p">(</span><span class="s2">&quot;https://storage.googleapis.com/cmip6/pangeo-cmip6.json&quot;</span><span class="p">)</span>
<span class="n">col</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/intake_esm/cat.py:283: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  .applymap(type)
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/intake_esm/cat.py:283: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  .applymap(type)
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/intake_esm/cat.py:283: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  .applymap(type)
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/intake_esm/cat.py:283: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  .applymap(type)
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/intake_esm/cat.py:283: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  .applymap(type)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/intake_esm/cat.py:283: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  .applymap(type)
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/intake_esm/cat.py:283: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  .applymap(type)
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/intake_esm/cat.py:283: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  .applymap(type)
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/intake_esm/cat.py:283: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  .applymap(type)
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/intake_esm/cat.py:283: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  .applymap(type)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/intake_esm/cat.py:283: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  .applymap(type)
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/intake_esm/cat.py:283: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  .applymap(type)
</pre></div>
</div>
<div class="output text_html"><p><strong>pangeo-cmip6 catalog with 7674 dataset(s) from 514818 asset(s)</strong>:</p> <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>activity_id</th>
      <td>18</td>
    </tr>
    <tr>
      <th>institution_id</th>
      <td>36</td>
    </tr>
    <tr>
      <th>source_id</th>
      <td>88</td>
    </tr>
    <tr>
      <th>experiment_id</th>
      <td>170</td>
    </tr>
    <tr>
      <th>member_id</th>
      <td>657</td>
    </tr>
    <tr>
      <th>table_id</th>
      <td>37</td>
    </tr>
    <tr>
      <th>variable_id</th>
      <td>700</td>
    </tr>
    <tr>
      <th>grid_label</th>
      <td>10</td>
    </tr>
    <tr>
      <th>zstore</th>
      <td>514818</td>
    </tr>
    <tr>
      <th>dcpp_init_year</th>
      <td>60</td>
    </tr>
    <tr>
      <th>version</th>
      <td>736</td>
    </tr>
    <tr>
      <th>derived_variable_id</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Here, we show the various forcing experiments that climate modellers ran in these simulations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;experiment_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;highresSST-present&#39;, &#39;piControl&#39;, &#39;control-1950&#39;, &#39;hist-1950&#39;,
       &#39;historical&#39;, &#39;amip&#39;, &#39;abrupt-4xCO2&#39;, &#39;abrupt-2xCO2&#39;,
       &#39;abrupt-0p5xCO2&#39;, &#39;1pctCO2&#39;, &#39;ssp585&#39;, &#39;esm-piControl&#39;, &#39;esm-hist&#39;,
       &#39;hist-piAer&#39;, &#39;histSST-1950HC&#39;, &#39;ssp245&#39;, &#39;hist-1950HC&#39;, &#39;histSST&#39;,
       &#39;piClim-2xVOC&#39;, &#39;piClim-2xNOx&#39;, &#39;piClim-2xdust&#39;, &#39;piClim-2xss&#39;,
       &#39;piClim-histall&#39;, &#39;hist-piNTCF&#39;, &#39;histSST-piNTCF&#39;,
       &#39;aqua-control-lwoff&#39;, &#39;piClim-lu&#39;, &#39;histSST-piO3&#39;, &#39;piClim-CH4&#39;,
       &#39;piClim-NTCF&#39;, &#39;piClim-NOx&#39;, &#39;piClim-O3&#39;, &#39;piClim-HC&#39;,
       &#39;faf-heat-NA0pct&#39;, &#39;ssp370SST-lowCH4&#39;, &#39;piClim-VOC&#39;,
       &#39;ssp370-lowNTCF&#39;, &#39;piClim-control&#39;, &#39;piClim-aer&#39;, &#39;hist-aer&#39;,
       &#39;faf-heat&#39;, &#39;faf-heat-NA50pct&#39;, &#39;ssp370SST-lowNTCF&#39;,
       &#39;ssp370SST-ssp126Lu&#39;, &#39;ssp370SST&#39;, &#39;ssp370pdSST&#39;, &#39;histSST-piAer&#39;,
       &#39;piClim-ghg&#39;, &#39;piClim-anthro&#39;, &#39;faf-all&#39;, &#39;hist-nat&#39;, &#39;hist-GHG&#39;,
       &#39;ssp119&#39;, &#39;piClim-histnat&#39;, &#39;piClim-4xCO2&#39;, &#39;ssp370&#39;,
       &#39;piClim-histghg&#39;, &#39;highresSST-future&#39;, &#39;esm-ssp585-ssp126Lu&#39;,
       &#39;ssp126-ssp370Lu&#39;, &#39;ssp370-ssp126Lu&#39;, &#39;land-noLu&#39;, &#39;histSST-piCH4&#39;,
       &#39;ssp126&#39;, &#39;esm-pi-CO2pulse&#39;, &#39;amip-hist&#39;, &#39;piClim-histaer&#39;,
       &#39;amip-4xCO2&#39;, &#39;faf-water&#39;, &#39;faf-passiveheat&#39;, &#39;1pctCO2-rad&#39;,
       &#39;faf-stress&#39;, &#39;1pctCO2-bgc&#39;, &#39;aqua-control&#39;, &#39;amip-future4K&#39;,
       &#39;amip-p4K&#39;, &#39;aqua-p4K&#39;, &#39;amip-lwoff&#39;, &#39;amip-m4K&#39;, &#39;aqua-4xCO2&#39;,
       &#39;amip-p4K-lwoff&#39;, &#39;hist-noLu&#39;, &#39;1pctCO2-cdr&#39;,
       &#39;land-hist-altStartYear&#39;, &#39;land-hist&#39;, &#39;omip1&#39;, &#39;esm-pi-cdr-pulse&#39;,
       &#39;esm-ssp585&#39;, &#39;abrupt-solp4p&#39;, &#39;piControl-spinup&#39;, &#39;hist-stratO3&#39;,
       &#39;abrupt-solm4p&#39;, &#39;midHolocene&#39;, &#39;lig127k&#39;, &#39;aqua-p4K-lwoff&#39;,
       &#39;esm-piControl-spinup&#39;, &#39;ssp245-GHG&#39;, &#39;ssp245-nat&#39;,
       &#39;dcppC-amv-neg&#39;, &#39;dcppC-amv-ExTrop-neg&#39;, &#39;dcppC-atl-control&#39;,
       &#39;dcppC-amv-pos&#39;, &#39;dcppC-ipv-NexTrop-neg&#39;, &#39;dcppC-ipv-NexTrop-pos&#39;,
       &#39;dcppC-atl-pacemaker&#39;, &#39;dcppC-amv-ExTrop-pos&#39;,
       &#39;dcppC-amv-Trop-neg&#39;, &#39;dcppC-pac-control&#39;, &#39;dcppC-ipv-pos&#39;,
       &#39;dcppC-pac-pacemaker&#39;, &#39;dcppC-ipv-neg&#39;, &#39;dcppC-amv-Trop-pos&#39;,
       &#39;piClim-BC&#39;, &#39;piClim-2xfire&#39;, &#39;piClim-SO2&#39;, &#39;piClim-OC&#39;,
       &#39;piClim-N2O&#39;, &#39;piClim-2xDMS&#39;, &#39;ssp460&#39;, &#39;ssp434&#39;, &#39;ssp534-over&#39;,
       &#39;deforest-globe&#39;, &#39;historical-cmip5&#39;, &#39;hist-bgc&#39;,
       &#39;piControl-cmip5&#39;, &#39;rcp26-cmip5&#39;, &#39;rcp45-cmip5&#39;, &#39;rcp85-cmip5&#39;,
       &#39;pdSST-piArcSIC&#39;, &#39;pdSST-piAntSIC&#39;, &#39;piSST-piSIC&#39;, &#39;piSST-pdSIC&#39;,
       &#39;ssp245-stratO3&#39;, &#39;hist-sol&#39;, &#39;hist-CO2&#39;, &#39;hist-volc&#39;,
       &#39;hist-totalO3&#39;, &#39;hist-nat-cmip5&#39;, &#39;hist-aer-cmip5&#39;,
       &#39;hist-GHG-cmip5&#39;, &#39;pdSST-futAntSIC&#39;, &#39;futSST-pdSIC&#39;, &#39;pdSST-pdSIC&#39;,
       &#39;ssp245-aer&#39;, &#39;pdSST-futArcSIC&#39;, &#39;dcppA-hindcast&#39;, &#39;dcppA-assim&#39;,
       &#39;dcppC-hindcast-noPinatubo&#39;, &#39;dcppC-hindcast-noElChichon&#39;,
       &#39;dcppC-hindcast-noAgung&#39;, &#39;hist-resIPO&#39;, &#39;ssp245-cov-modgreen&#39;,
       &#39;ssp245-cov-fossil&#39;, &#39;ssp245-cov-strgreen&#39;, &#39;ssp245-covid&#39;, &#39;lgm&#39;,
       &#39;ssp585-bgc&#39;, &#39;1pctCO2to4x-withism&#39;, &#39;1pctCO2-4xext&#39;, &#39;past1000&#39;,
       &#39;pa-futArcSIC&#39;, &#39;pa-pdSIC&#39;, &#39;historical-ext&#39;, &#39;pdSST-futArcSICSIT&#39;,
       &#39;pdSST-futOkhotskSIC&#39;, &#39;pdSST-futBKSeasSIC&#39;, &#39;pa-piArcSIC&#39;,
       &#39;pa-piAntSIC&#39;, &#39;pa-futAntSIC&#39;, &#39;pdSST-pdSICSIT&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
</section>
<section id="loading-data">
<h2>Loading Data<a class="headerlink" href="#loading-data" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<p>Intake-ESM enables loading data directly into an <code class="docutils literal notranslate"><span class="pre">xarray.DataArray</span></code>, a metadata-aware extension of numpy arrays. Xarray objects leverage <a class="reference external" href="https://www.dask.org/">Dask</a> to only read data into memory as needed for any specific operation (i.e. lazy evaluation). Think of Xarray Datasets as ways of conveniently organizing large arrays of floating point numbers (e.g. climate model data) on an n-dimensional discrete grid, with important metadata such as units, variable, names, etc.</p>
<p>Note that data on the cloud are in <a class="reference external" href="https://zarr.readthedocs.io/en/stable/">Zarr</a> format, an extension of the metadata-aware format <a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/">NetCDF</a> commonly used in the geosciences.</p>
<p>Intake-ESM has rules for aggegating datasets; these rules are defined in the collection-specification file.</p>
<p>Here, we choose the <code class="docutils literal notranslate"><span class="pre">piControl</span></code> experiment (in which CO<span class="math notranslate nohighlight">\(_2\)</span> concentrations are held fixed at a pre-industrial level of ~300 ppm) and <code class="docutils literal notranslate"><span class="pre">abrupt-2xCO2</span></code> experiment (in which CO<span class="math notranslate nohighlight">\(_2\)</span> concentrations are instantaneously doubled from a pre-industrial control state). Since the radiative forcing of CO<span class="math notranslate nohighlight">\(_2\)</span> is roughly a logarithmic function of CO<span class="math notranslate nohighlight">\(_2\)</span> concentrations, the ECS is roughly independent of the initial CO<span class="math notranslate nohighlight">\(_2\)</span> concentration.</p>
<div class="admonition alert alert-warning">
<p class="admonition-title">Warning</p>
<p>The version of this notebook in the
<a href="http://gallery.pangeo.io/repos/pangeo-gallery/cmip6/">Pangeo Gallery</a>
uses the <code>abrupt-4xCO2</code> forcing experiment, but fewer <code>abrupt-2xCO2</code> datasets are currently avaiable in Google Cloud Storage, which significantly reduces run time. If you want to run this notebook on your own computer with the <code>abrupt-4xCO2</code> experiment instead, change <code>co2_option</code> in the cell below. You will also need to take half of <code>ecs</code>, as described in the Overview.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2_option</span> <span class="o">=</span> <span class="s1">&#39;abrupt-2xCO2&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="prepare-data">
<h2>Prepare Data<a class="headerlink" href="#prepare-data" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">query</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">experiment_id</span><span class="o">=</span><span class="p">[</span><span class="n">co2_option</span><span class="p">,</span><span class="s1">&#39;piControl&#39;</span><span class="p">],</span> <span class="c1"># pick the `abrupt-2xCO2` and `piControl` forcing experiments</span>
    <span class="n">table_id</span><span class="o">=</span><span class="s1">&#39;Amon&#39;</span><span class="p">,</span>                            <span class="c1"># choose to look at atmospheric variables (A) saved at monthly resolution (mon)</span>
    <span class="n">variable_id</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">,</span> <span class="s1">&#39;rsut&#39;</span><span class="p">,</span><span class="s1">&#39;rsdt&#39;</span><span class="p">,</span><span class="s1">&#39;rlut&#39;</span><span class="p">],</span>  <span class="c1"># choose to look at near-surface air temperature (tas) as our variable</span>
    <span class="n">member_id</span> <span class="o">=</span> <span class="s1">&#39;r1i1p1f1&#39;</span><span class="p">,</span>                     <span class="c1"># arbitrarily pick one realization for each model (i.e. just one set of initial conditions)</span>
<span class="p">)</span>

<span class="n">col_subset</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">require_all_on</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;source_id&quot;</span><span class="p">],</span> <span class="o">**</span><span class="n">query</span><span class="p">)</span>
<span class="n">col_subset</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;source_id&quot;</span><span class="p">)[</span>
    <span class="p">[</span><span class="s2">&quot;experiment_id&quot;</span><span class="p">,</span> <span class="s2">&quot;variable_id&quot;</span><span class="p">,</span> <span class="s2">&quot;table_id&quot;</span><span class="p">]</span>
<span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/intake_esm/cat.py:283: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  .applymap(type)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/intake_esm/cat.py:283: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  .applymap(type)
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/intake_esm/cat.py:283: FutureWarning: DataFrame.applymap has been deprecated. Use DataFrame.map instead.
  .applymap(type)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>experiment_id</th>
      <th>variable_id</th>
      <th>table_id</th>
    </tr>
    <tr>
      <th>source_id</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CESM2</th>
      <td>2</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>GISS-E2-1-G</th>
      <td>2</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>GISS-E2-1-H</th>
      <td>2</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>GISS-E2-2-G</th>
      <td>2</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>IPSL-CM6A-LR</th>
      <td>2</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>MIROC6</th>
      <td>2</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>MRI-ESM2-0</th>
      <td>2</td>
      <td>4</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The following functions help us load and homogenize the data. We use some <a class="reference external" href="https://docs.dask.org/en/latest/delayed.html"><code class="docutils literal notranslate"><span class="pre">dask.delayed</span></code></a> programming to open the datasets in parallel.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">drop_all_bounds</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Drop coordinates like &#39;time_bounds&#39; from datasets,</span>
<span class="sd">    which can lead to issues when merging.&quot;&quot;&quot;</span>
    <span class="n">drop_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">vname</span> <span class="k">for</span> <span class="n">vname</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">coords</span>
                 <span class="k">if</span> <span class="p">((</span><span class="s1">&#39;_bounds&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">vname</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;_bnds&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="n">vname</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ds</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">drop_vars</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">open_dsets</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Open datasets from cloud storage and return xarray dataset.&quot;&quot;&quot;</span>
    <span class="n">dsets</span> <span class="o">=</span> <span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">open_zarr</span><span class="p">(</span><span class="n">fsspec</span><span class="o">.</span><span class="n">get_mapper</span><span class="p">(</span><span class="n">ds_url</span><span class="p">),</span> <span class="n">consolidated</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
             <span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">drop_all_bounds</span><span class="p">)</span>
             <span class="k">for</span> <span class="n">ds_url</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">zstore</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">dsets</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;exact&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ds</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

<span class="k">def</span> <span class="nf">open_delayed</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A dask.delayed wrapper around `open_dsets`.</span>
<span class="sd">    Allows us to open many datasets in parallel.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dask</span><span class="o">.</span><span class="n">delayed</span><span class="p">(</span><span class="n">open_dsets</span><span class="p">)(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Create a nested dictionary of models and experiments. It will be structured like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;CESM2&#39;</span><span class="p">:</span>
  <span class="p">{</span>
    <span class="s1">&#39;piControl&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="o">&gt;</span><span class="p">,</span>
    <span class="s1">&#39;abrupt-2xCO2&#39;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">xarray</span><span class="o">.</span><span class="n">Dataset</span><span class="o">&gt;</span>
  <span class="p">},</span>
  <span class="o">...</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>

<span class="n">dsets</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
<span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="n">col_subset</span><span class="o">.</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;source_id&#39;</span><span class="p">,</span> <span class="s1">&#39;experiment_id&#39;</span><span class="p">]):</span>
    <span class="n">dsets</span><span class="p">[</span><span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">group</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">open_delayed</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Open one of the datasets directly, just to show what it looks like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">time</span> open_dsets(df)
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  return ds.drop(drop_vars)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  return ds.drop(drop_vars)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  return ds.drop(drop_vars)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 1.39 s, sys: 134 ms, total: 1.53 s
Wall time: 3.17 s
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  return ds.drop(drop_vars)
</pre></div>
</div>
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 7GB
Dimensions:  (lat: 160, lon: 320, time: 8412)
Coordinates:
    height   float64 8B ...
  * lat      (lat) float64 1kB -89.14 -88.03 -86.91 -85.79 ... 86.91 88.03 89.14
  * lon      (lon) float64 3kB 0.0 1.125 2.25 3.375 ... 355.5 356.6 357.8 358.9
  * time     (time) object 67kB 1850-01-16 00:00:00 ... 2550-12-16 00:00:00
Data variables:
    tas      (time, lat, lon) float32 2GB dask.array&lt;chunksize=(600, 160, 320), meta=np.ndarray&gt;
    rsut     (time, lat, lon) float32 2GB dask.array&lt;chunksize=(600, 160, 320), meta=np.ndarray&gt;
    rsdt     (time, lat, lon) float32 2GB dask.array&lt;chunksize=(600, 160, 320), meta=np.ndarray&gt;
    rlut     (time, lat, lon) float32 2GB dask.array&lt;chunksize=(600, 160, 320), meta=np.ndarray&gt;
Attributes: (12/47)
    Conventions:            CF-1.7 CMIP-6.2
    activity_id:            CMIP
    branch_method:          standard
    branch_time_in_child:   0.0
    branch_time_in_parent:  365243.0
    cmor_version:           3.4.0
    ...                     ...
    tracking_id:            hdl:21.14100/a0bd7d8f-4785-4687-b510-fd87808051b6
    variable_id:            tas
    variant_label:          r1i1p1f1
    status:                 2019-10-25;created;by nhn2@columbia.edu
    netcdf_tracking_ids:    hdl:21.14100/a0bd7d8f-4785-4687-b510-fd87808051b6
    version_id:             v20190222</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-54b1511f-236d-4955-b348-38a1f8dd1b9c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-54b1511f-236d-4955-b348-38a1f8dd1b9c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lat</span>: 160</li><li><span class='xr-has-index'>lon</span>: 320</li><li><span class='xr-has-index'>time</span>: 8412</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b3e9345e-b71c-4c7a-ab7d-354d577448e8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b3e9345e-b71c-4c7a-ab7d-354d577448e8' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>height</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-19d0d155-7a30-455c-8ec2-9dbef4fd7767' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-19d0d155-7a30-455c-8ec2-9dbef4fd7767' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-637712f4-5e06-44f6-922e-016df725e545' class='xr-var-data-in' type='checkbox'><label for='data-637712f4-5e06-44f6-922e-016df725e545' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Z</dd><dt><span>long_name :</span></dt><dd>height</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-89.14 -88.03 ... 88.03 89.14</div><input id='attrs-59ec9c7a-e734-438f-9184-fe5bbc9b2056' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-59ec9c7a-e734-438f-9184-fe5bbc9b2056' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5a8a7eee-9a6f-4f3b-b913-bb01dffeca55' class='xr-var-data-in' type='checkbox'><label for='data-5a8a7eee-9a6f-4f3b-b913-bb01dffeca55' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>bounds :</span></dt><dd>lat_bnds</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([-89.14152, -88.02943, -86.91077, -85.79063, -84.66992, -83.54895,
       -82.42782, -81.30659, -80.18531, -79.06398, -77.94262, -76.82124,
       -75.69984, -74.57843, -73.45701, -72.33558, -71.21414, -70.09269,
       -68.97124, -67.84978, -66.72833, -65.60686, -64.4854 , -63.36393,
       -62.24246, -61.12099, -59.99952, -58.87804, -57.75657, -56.63509,
       -55.51361, -54.39214, -53.27066, -52.14917, -51.02769, -49.90621,
       -48.78473, -47.66325, -46.54176, -45.42028, -44.29879, -43.17731,
       -42.05582, -40.93434, -39.81285, -38.69137, -37.56988, -36.44839,
       -35.32691, -34.20542, -33.08393, -31.96244, -30.84096, -29.71947,
       -28.59798, -27.47649, -26.355  , -25.23351, -24.11203, -22.99054,
       -21.86905, -20.74756, -19.62607, -18.50458, -17.38309, -16.2616 ,
       -15.14011, -14.01862, -12.89713, -11.77564, -10.65415,  -9.53266,
        -8.41117,  -7.28968,  -6.16819,  -5.0467 ,  -3.92521,  -2.80372,
        -1.68223,  -0.56074,   0.56074,   1.68223,   2.80372,   3.92521,
         5.0467 ,   6.16819,   7.28968,   8.41117,   9.53266,  10.65415,
        11.77564,  12.89713,  14.01862,  15.14011,  16.2616 ,  17.38309,
        18.50458,  19.62607,  20.74756,  21.86905,  22.99054,  24.11203,
        25.23351,  26.355  ,  27.47649,  28.59798,  29.71947,  30.84096,
        31.96244,  33.08393,  34.20542,  35.32691,  36.44839,  37.56988,
        38.69137,  39.81285,  40.93434,  42.05582,  43.17731,  44.29879,
        45.42028,  46.54176,  47.66325,  48.78473,  49.90621,  51.02769,
        52.14917,  53.27066,  54.39214,  55.51361,  56.63509,  57.75657,
        58.87804,  59.99952,  61.12099,  62.24246,  63.36393,  64.4854 ,
        65.60686,  66.72833,  67.84978,  68.97124,  70.09269,  71.21414,
        72.33558,  73.45701,  74.57843,  75.69984,  76.82124,  77.94262,
        79.06398,  80.18531,  81.30659,  82.42782,  83.54895,  84.66992,
        85.79063,  86.91077,  88.02943,  89.14152])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.125 2.25 ... 357.8 358.9</div><input id='attrs-bd4ddb8f-5706-483c-bbf9-704ea0f952ae' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bd4ddb8f-5706-483c-bbf9-704ea0f952ae' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-710a64a5-a6db-442f-8fee-f81e0265e444' class='xr-var-data-in' type='checkbox'><label for='data-710a64a5-a6db-442f-8fee-f81e0265e444' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>bounds :</span></dt><dd>lon_bnds</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([  0.   ,   1.125,   2.25 , ..., 356.625, 357.75 , 358.875])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>1850-01-16 00:00:00 ... 2550-12-...</div><input id='attrs-6b54a5ed-c43a-4377-8cc6-bf1ca0c0d7d1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6b54a5ed-c43a-4377-8cc6-bf1ca0c0d7d1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dac2e93a-a3c3-41ae-9c58-f67a0f9a4142' class='xr-var-data-in' type='checkbox'><label for='data-dac2e93a-a3c3-41ae-9c58-f67a0f9a4142' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([cftime.Datetime360Day(1850, 1, 16, 0, 0, 0, 0, has_year_zero=True),
       cftime.Datetime360Day(1850, 2, 16, 0, 0, 0, 0, has_year_zero=True),
       cftime.Datetime360Day(1850, 3, 16, 0, 0, 0, 0, has_year_zero=True), ...,
       cftime.Datetime360Day(2550, 10, 16, 0, 0, 0, 0, has_year_zero=True),
       cftime.Datetime360Day(2550, 11, 16, 0, 0, 0, 0, has_year_zero=True),
       cftime.Datetime360Day(2550, 12, 16, 0, 0, 0, 0, has_year_zero=True)],
      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-782ddecf-c4d1-400a-b3ac-7d52965742d5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-782ddecf-c4d1-400a-b3ac-7d52965742d5' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tas</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(600, 160, 320), meta=np.ndarray&gt;</div><input id='attrs-d48df70c-0866-4a9e-af6f-5f8ca20ae6eb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d48df70c-0866-4a9e-af6f-5f8ca20ae6eb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5eec8108-33a8-4900-8b7b-92ba4690a838' class='xr-var-data-in' type='checkbox'><label for='data-5eec8108-33a8-4900-8b7b-92ba4690a838' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_measures :</span></dt><dd>area: areacella</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>comment :</span></dt><dd>near-surface (usually, 2 meter) air temperature</dd><dt><span>history :</span></dt><dd>2019-02-20T08:13:34Z altered by CMOR: Treated scalar dimension: &#x27;height&#x27;. 2019-02-20T08:13:34Z altered by CMOR: replaced missing value flag (-9.99e+33) with standard missing value (1e+20).</dd><dt><span>long_name :</span></dt><dd>Near-Surface Air Temperature</dd><dt><span>original_name :</span></dt><dd>TA</dd><dt><span>standard_name :</span></dt><dd>air_temperature</dd><dt><span>units :</span></dt><dd>K</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 1.60 GiB </td>
                        <td> 117.19 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (8412, 160, 320) </td>
                        <td> (600, 160, 320) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 15 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="163" height="149" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="28" x2="80" y2="99" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="28" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="33" />
  <line x1="20" y1="10" x2="20" y2="38" />
  <line x1="25" y1="15" x2="25" y2="43" />
  <line x1="30" y1="20" x2="30" y2="48" />
  <line x1="35" y1="25" x2="35" y2="53" />
  <line x1="40" y1="30" x2="40" y2="58" />
  <line x1="45" y1="35" x2="45" y2="63" />
  <line x1="50" y1="40" x2="50" y2="69" />
  <line x1="55" y1="45" x2="55" y2="74" />
  <line x1="60" y1="50" x2="60" y2="79" />
  <line x1="65" y1="55" x2="65" y2="84" />
  <line x1="70" y1="60" x2="70" y2="89" />
  <line x1="75" y1="65" x2="75" y2="94" />
  <line x1="80" y1="70" x2="80" y2="99" />
  <line x1="80" y1="70" x2="80" y2="99" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,99.33761857428638 10.0,28.749383280168736" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="42" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="47" y2="5" />
  <line x1="20" y1="10" x2="52" y2="10" />
  <line x1="25" y1="15" x2="57" y2="15" />
  <line x1="30" y1="20" x2="62" y2="20" />
  <line x1="35" y1="25" x2="68" y2="25" />
  <line x1="40" y1="30" x2="73" y2="30" />
  <line x1="45" y1="35" x2="78" y2="35" />
  <line x1="50" y1="40" x2="83" y2="40" />
  <line x1="55" y1="45" x2="88" y2="45" />
  <line x1="60" y1="50" x2="93" y2="50" />
  <line x1="65" y1="55" x2="98" y2="55" />
  <line x1="70" y1="60" x2="103" y2="60" />
  <line x1="75" y1="65" x2="108" y2="65" />
  <line x1="80" y1="70" x2="113" y2="70" />
  <line x1="80" y1="70" x2="113" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="42" y1="0" x2="113" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 42.8270979884903,0.0 113.41533328260795,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="113" y2="70" style="stroke-width:2" />
  <line x1="80" y1="99" x2="113" y2="99" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="99" style="stroke-width:2" />
  <line x1="113" y1="70" x2="113" y2="99" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 113.41533328260795,70.58823529411765 113.41533328260795,99.33761857428638 80.58823529411765,99.33761857428638" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="97.001784" y="119.337619" font-size="1.0rem" font-weight="100" text-anchor="middle" >320</text>
  <text x="133.415333" y="84.962927" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,133.415333,84.962927)">160</text>
  <text x="35.294118" y="84.043501" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,84.043501)">8412</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rsut</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(600, 160, 320), meta=np.ndarray&gt;</div><input id='attrs-9b72c22d-b711-4d92-84df-1a75926675e2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9b72c22d-b711-4d92-84df-1a75926675e2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b888473d-3d89-43e6-a39d-278ca73ec456' class='xr-var-data-in' type='checkbox'><label for='data-b888473d-3d89-43e6-a39d-278ca73ec456' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_measures :</span></dt><dd>area: areacella</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>comment :</span></dt><dd>at the top of the atmosphere</dd><dt><span>history :</span></dt><dd>2019-02-20T09:29:39Z altered by CMOR: replaced missing value flag (-9.99e+33) with standard missing value (1e+20).</dd><dt><span>long_name :</span></dt><dd>TOA Outgoing Shortwave Radiation</dd><dt><span>original_name :</span></dt><dd>USWT</dd><dt><span>standard_name :</span></dt><dd>toa_outgoing_shortwave_flux</dd><dt><span>units :</span></dt><dd>W m-2</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 1.60 GiB </td>
                        <td> 117.19 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (8412, 160, 320) </td>
                        <td> (600, 160, 320) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 15 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="163" height="149" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="28" x2="80" y2="99" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="28" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="33" />
  <line x1="20" y1="10" x2="20" y2="38" />
  <line x1="25" y1="15" x2="25" y2="43" />
  <line x1="30" y1="20" x2="30" y2="48" />
  <line x1="35" y1="25" x2="35" y2="53" />
  <line x1="40" y1="30" x2="40" y2="58" />
  <line x1="45" y1="35" x2="45" y2="63" />
  <line x1="50" y1="40" x2="50" y2="69" />
  <line x1="55" y1="45" x2="55" y2="74" />
  <line x1="60" y1="50" x2="60" y2="79" />
  <line x1="65" y1="55" x2="65" y2="84" />
  <line x1="70" y1="60" x2="70" y2="89" />
  <line x1="75" y1="65" x2="75" y2="94" />
  <line x1="80" y1="70" x2="80" y2="99" />
  <line x1="80" y1="70" x2="80" y2="99" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,99.33761857428638 10.0,28.749383280168736" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="42" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="47" y2="5" />
  <line x1="20" y1="10" x2="52" y2="10" />
  <line x1="25" y1="15" x2="57" y2="15" />
  <line x1="30" y1="20" x2="62" y2="20" />
  <line x1="35" y1="25" x2="68" y2="25" />
  <line x1="40" y1="30" x2="73" y2="30" />
  <line x1="45" y1="35" x2="78" y2="35" />
  <line x1="50" y1="40" x2="83" y2="40" />
  <line x1="55" y1="45" x2="88" y2="45" />
  <line x1="60" y1="50" x2="93" y2="50" />
  <line x1="65" y1="55" x2="98" y2="55" />
  <line x1="70" y1="60" x2="103" y2="60" />
  <line x1="75" y1="65" x2="108" y2="65" />
  <line x1="80" y1="70" x2="113" y2="70" />
  <line x1="80" y1="70" x2="113" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="42" y1="0" x2="113" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 42.8270979884903,0.0 113.41533328260795,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="113" y2="70" style="stroke-width:2" />
  <line x1="80" y1="99" x2="113" y2="99" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="99" style="stroke-width:2" />
  <line x1="113" y1="70" x2="113" y2="99" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 113.41533328260795,70.58823529411765 113.41533328260795,99.33761857428638 80.58823529411765,99.33761857428638" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="97.001784" y="119.337619" font-size="1.0rem" font-weight="100" text-anchor="middle" >320</text>
  <text x="133.415333" y="84.962927" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,133.415333,84.962927)">160</text>
  <text x="35.294118" y="84.043501" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,84.043501)">8412</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rsdt</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(600, 160, 320), meta=np.ndarray&gt;</div><input id='attrs-d65e100a-eb82-46fe-8c18-d4a49ca1dbb6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d65e100a-eb82-46fe-8c18-d4a49ca1dbb6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cc5dc70b-93e5-45a4-840f-95f604e91090' class='xr-var-data-in' type='checkbox'><label for='data-cc5dc70b-93e5-45a4-840f-95f604e91090' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_measures :</span></dt><dd>area: areacella</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>comment :</span></dt><dd>Shortwave radiation incident at the top of the atmosphere</dd><dt><span>history :</span></dt><dd>2019-02-20T09:27:14Z altered by CMOR: replaced missing value flag (-9.99e+33) with standard missing value (1e+20).</dd><dt><span>long_name :</span></dt><dd>TOA Incident Shortwave Radiation</dd><dt><span>original_name :</span></dt><dd>DSWT</dd><dt><span>standard_name :</span></dt><dd>toa_incoming_shortwave_flux</dd><dt><span>units :</span></dt><dd>W m-2</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 1.60 GiB </td>
                        <td> 117.19 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (8412, 160, 320) </td>
                        <td> (600, 160, 320) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 15 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="163" height="149" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="28" x2="80" y2="99" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="28" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="33" />
  <line x1="20" y1="10" x2="20" y2="38" />
  <line x1="25" y1="15" x2="25" y2="43" />
  <line x1="30" y1="20" x2="30" y2="48" />
  <line x1="35" y1="25" x2="35" y2="53" />
  <line x1="40" y1="30" x2="40" y2="58" />
  <line x1="45" y1="35" x2="45" y2="63" />
  <line x1="50" y1="40" x2="50" y2="69" />
  <line x1="55" y1="45" x2="55" y2="74" />
  <line x1="60" y1="50" x2="60" y2="79" />
  <line x1="65" y1="55" x2="65" y2="84" />
  <line x1="70" y1="60" x2="70" y2="89" />
  <line x1="75" y1="65" x2="75" y2="94" />
  <line x1="80" y1="70" x2="80" y2="99" />
  <line x1="80" y1="70" x2="80" y2="99" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,99.33761857428638 10.0,28.749383280168736" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="42" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="47" y2="5" />
  <line x1="20" y1="10" x2="52" y2="10" />
  <line x1="25" y1="15" x2="57" y2="15" />
  <line x1="30" y1="20" x2="62" y2="20" />
  <line x1="35" y1="25" x2="68" y2="25" />
  <line x1="40" y1="30" x2="73" y2="30" />
  <line x1="45" y1="35" x2="78" y2="35" />
  <line x1="50" y1="40" x2="83" y2="40" />
  <line x1="55" y1="45" x2="88" y2="45" />
  <line x1="60" y1="50" x2="93" y2="50" />
  <line x1="65" y1="55" x2="98" y2="55" />
  <line x1="70" y1="60" x2="103" y2="60" />
  <line x1="75" y1="65" x2="108" y2="65" />
  <line x1="80" y1="70" x2="113" y2="70" />
  <line x1="80" y1="70" x2="113" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="42" y1="0" x2="113" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 42.8270979884903,0.0 113.41533328260795,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="113" y2="70" style="stroke-width:2" />
  <line x1="80" y1="99" x2="113" y2="99" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="99" style="stroke-width:2" />
  <line x1="113" y1="70" x2="113" y2="99" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 113.41533328260795,70.58823529411765 113.41533328260795,99.33761857428638 80.58823529411765,99.33761857428638" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="97.001784" y="119.337619" font-size="1.0rem" font-weight="100" text-anchor="middle" >320</text>
  <text x="133.415333" y="84.962927" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,133.415333,84.962927)">160</text>
  <text x="35.294118" y="84.043501" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,84.043501)">8412</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rlut</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(600, 160, 320), meta=np.ndarray&gt;</div><input id='attrs-ce8d640f-3522-4bab-b29d-57147235d4e1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ce8d640f-3522-4bab-b29d-57147235d4e1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-70476de7-b87f-4378-aaa7-965afd38358c' class='xr-var-data-in' type='checkbox'><label for='data-70476de7-b87f-4378-aaa7-965afd38358c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_measures :</span></dt><dd>area: areacella</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>comment :</span></dt><dd>at the top of the atmosphere (to be compared with satellite measurements)</dd><dt><span>history :</span></dt><dd>2019-02-20T09:32:16Z altered by CMOR: replaced missing value flag (-9.99e+33) with standard missing value (1e+20).</dd><dt><span>long_name :</span></dt><dd>TOA Outgoing Longwave Radiation</dd><dt><span>original_name :</span></dt><dd>ULWT</dd><dt><span>standard_name :</span></dt><dd>toa_outgoing_longwave_flux</dd><dt><span>units :</span></dt><dd>W m-2</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 1.60 GiB </td>
                        <td> 117.19 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (8412, 160, 320) </td>
                        <td> (600, 160, 320) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 15 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="163" height="149" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="28" x2="80" y2="99" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="28" style="stroke-width:2" />
  <line x1="15" y1="5" x2="15" y2="33" />
  <line x1="20" y1="10" x2="20" y2="38" />
  <line x1="25" y1="15" x2="25" y2="43" />
  <line x1="30" y1="20" x2="30" y2="48" />
  <line x1="35" y1="25" x2="35" y2="53" />
  <line x1="40" y1="30" x2="40" y2="58" />
  <line x1="45" y1="35" x2="45" y2="63" />
  <line x1="50" y1="40" x2="50" y2="69" />
  <line x1="55" y1="45" x2="55" y2="74" />
  <line x1="60" y1="50" x2="60" y2="79" />
  <line x1="65" y1="55" x2="65" y2="84" />
  <line x1="70" y1="60" x2="70" y2="89" />
  <line x1="75" y1="65" x2="75" y2="94" />
  <line x1="80" y1="70" x2="80" y2="99" />
  <line x1="80" y1="70" x2="80" y2="99" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,99.33761857428638 10.0,28.749383280168736" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="42" y2="0" style="stroke-width:2" />
  <line x1="15" y1="5" x2="47" y2="5" />
  <line x1="20" y1="10" x2="52" y2="10" />
  <line x1="25" y1="15" x2="57" y2="15" />
  <line x1="30" y1="20" x2="62" y2="20" />
  <line x1="35" y1="25" x2="68" y2="25" />
  <line x1="40" y1="30" x2="73" y2="30" />
  <line x1="45" y1="35" x2="78" y2="35" />
  <line x1="50" y1="40" x2="83" y2="40" />
  <line x1="55" y1="45" x2="88" y2="45" />
  <line x1="60" y1="50" x2="93" y2="50" />
  <line x1="65" y1="55" x2="98" y2="55" />
  <line x1="70" y1="60" x2="103" y2="60" />
  <line x1="75" y1="65" x2="108" y2="65" />
  <line x1="80" y1="70" x2="113" y2="70" />
  <line x1="80" y1="70" x2="113" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="42" y1="0" x2="113" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 42.8270979884903,0.0 113.41533328260795,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="113" y2="70" style="stroke-width:2" />
  <line x1="80" y1="99" x2="113" y2="99" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="99" style="stroke-width:2" />
  <line x1="113" y1="70" x2="113" y2="99" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 113.41533328260795,70.58823529411765 113.41533328260795,99.33761857428638 80.58823529411765,99.33761857428638" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="97.001784" y="119.337619" font-size="1.0rem" font-weight="100" text-anchor="middle" >320</text>
  <text x="133.415333" y="84.962927" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,133.415333,84.962927)">160</text>
  <text x="35.294118" y="84.043501" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,84.043501)">8412</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-39ad0ecb-0383-4e35-94a8-61aae93b6b28' class='xr-section-summary-in' type='checkbox'  ><label for='section-39ad0ecb-0383-4e35-94a8-61aae93b6b28' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-cd804a62-c1fb-40d8-9617-107da92a2c2a' class='xr-index-data-in' type='checkbox'/><label for='index-cd804a62-c1fb-40d8-9617-107da92a2c2a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([-89.14152, -88.02943, -86.91077, -85.79063, -84.66992, -83.54895,
       -82.42782, -81.30659, -80.18531, -79.06398,
       ...
        79.06398,  80.18531,  81.30659,  82.42782,  83.54895,  84.66992,
        85.79063,  86.91077,  88.02943,  89.14152],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;, length=160))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-bd69661a-6907-4f03-901a-474696a65f9d' class='xr-index-data-in' type='checkbox'/><label for='index-bd69661a-6907-4f03-901a-474696a65f9d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([    0.0,   1.125,    2.25,   3.375,     4.5,   5.625,    6.75,   7.875,
           9.0,  10.125,
       ...
        348.75, 349.875,   351.0, 352.125,  353.25, 354.375,   355.5, 356.625,
        357.75, 358.875],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=320))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3160acb4-5036-4ca3-be86-24cf8a6499c3' class='xr-index-data-in' type='checkbox'/><label for='index-3160acb4-5036-4ca3-be86-24cf8a6499c3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(CFTimeIndex([1850-01-16 00:00:00, 1850-02-16 00:00:00, 1850-03-16 00:00:00,
             1850-04-16 00:00:00, 1850-05-16 00:00:00, 1850-06-16 00:00:00,
             1850-07-16 00:00:00, 1850-08-16 00:00:00, 1850-09-16 00:00:00,
             1850-10-16 00:00:00,
             ...
             2550-03-16 00:00:00, 2550-04-16 00:00:00, 2550-05-16 00:00:00,
             2550-06-16 00:00:00, 2550-07-16 00:00:00, 2550-08-16 00:00:00,
             2550-09-16 00:00:00, 2550-10-16 00:00:00, 2550-11-16 00:00:00,
             2550-12-16 00:00:00],
            dtype=&#x27;object&#x27;, length=8412, calendar=&#x27;360_day&#x27;, freq=&#x27;30D&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-62305fcd-d0cd-4eae-a611-5ebc77b6f692' class='xr-section-summary-in' type='checkbox'  ><label for='section-62305fcd-d0cd-4eae-a611-5ebc77b6f692' class='xr-section-summary' >Attributes: <span>(47)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.7 CMIP-6.2</dd><dt><span>activity_id :</span></dt><dd>CMIP</dd><dt><span>branch_method :</span></dt><dd>standard</dd><dt><span>branch_time_in_child :</span></dt><dd>0.0</dd><dt><span>branch_time_in_parent :</span></dt><dd>365243.0</dd><dt><span>cmor_version :</span></dt><dd>3.4.0</dd><dt><span>creation_date :</span></dt><dd>2019-02-20T08:13:34Z</dd><dt><span>data_specs_version :</span></dt><dd>01.00.29</dd><dt><span>experiment :</span></dt><dd>pre-industrial control</dd><dt><span>experiment_id :</span></dt><dd>piControl</dd><dt><span>external_variables :</span></dt><dd>areacella</dd><dt><span>forcing_index :</span></dt><dd>1</dd><dt><span>frequency :</span></dt><dd>mon</dd><dt><span>further_info_url :</span></dt><dd>https://furtherinfo.es-doc.org/CMIP6.MRI.MRI-ESM2-0.piControl.none.r1i1p1f1</dd><dt><span>grid :</span></dt><dd>native atmosphere TL159 gaussian grid (160x320 latxlon)</dd><dt><span>grid_label :</span></dt><dd>gn</dd><dt><span>history :</span></dt><dd>2019-02-20T08:13:34Z ; CMOR rewrote data to be consistent with CMIP6, CF-1.7 CMIP-6.2 and CF standards.;
Output from run-Dr060_piControl_100 (sfc_avr_mon.ctl)</dd><dt><span>initialization_index :</span></dt><dd>1</dd><dt><span>institution :</span></dt><dd>Meteorological Research Institute, Tsukuba, Ibaraki 305-0052, Japan</dd><dt><span>institution_id :</span></dt><dd>MRI</dd><dt><span>license :</span></dt><dd>CMIP6 model data produced by MRI is licensed under a Creative Commons Attribution-ShareAlike 4.0 International License (https://creativecommons.org/licenses/). Consult https://pcmdi.llnl.gov/CMIP6/TermsOfUse for terms of use governing CMIP6 output, including citation requirements and proper acknowledgment. Further information about this data, including some limitations, can be found via the further_info_url (recorded as a global attribute in this file). The data producers and data providers make no warranty, either express or implied, including, but not limited to, warranties of merchantability and fitness for a particular purpose. All liabilities arising from the supply of the information (including any liability arising in negligence) are excluded to the fullest extent permitted by law.</dd><dt><span>mip_era :</span></dt><dd>CMIP6</dd><dt><span>nominal_resolution :</span></dt><dd>100 km</dd><dt><span>parent_activity_id :</span></dt><dd>CMIP</dd><dt><span>parent_experiment_id :</span></dt><dd>piControl-spinup</dd><dt><span>parent_mip_era :</span></dt><dd>CMIP6</dd><dt><span>parent_source_id :</span></dt><dd>MRI-ESM2-0</dd><dt><span>parent_time_units :</span></dt><dd>days since 1850-01-01</dd><dt><span>parent_variant_label :</span></dt><dd>r1i1p1f1</dd><dt><span>physics_index :</span></dt><dd>1</dd><dt><span>product :</span></dt><dd>model-output</dd><dt><span>realization_index :</span></dt><dd>1</dd><dt><span>realm :</span></dt><dd>atmos</dd><dt><span>source :</span></dt><dd>MRI-ESM2.0 (2017): 
aerosol: MASINGAR mk2r4 (TL95; 192 x 96 longitude/latitude; 80 levels; top level 0.01 hPa)
atmos: MRI-AGCM3.5 (TL159; 320 x 160 longitude/latitude; 80 levels; top level 0.01 hPa)
atmosChem: MRI-CCM2.1 (T42; 128 x 64 longitude/latitude; 80 levels; top level 0.01 hPa)
land: HAL 1.0
landIce: none
ocean: MRI.COM4.4 (tripolar primarily 0.5 deg latitude/1 deg longitude with meridional refinement down to 0.3 deg within 10 degrees north and south of the equator; 360 x 364 longitude/latitude; 61 levels; top grid cell 0-2 m)
ocnBgchem: MRI.COM4.4
seaIce: MRI.COM4.4</dd><dt><span>source_id :</span></dt><dd>MRI-ESM2-0</dd><dt><span>source_type :</span></dt><dd>AOGCM AER CHEM</dd><dt><span>sub_experiment :</span></dt><dd>none</dd><dt><span>sub_experiment_id :</span></dt><dd>none</dd><dt><span>table_id :</span></dt><dd>Amon</dd><dt><span>table_info :</span></dt><dd>Creation Date:(14 December 2018) MD5:b2d32d1a0d9b196411429c8895329d8f</dd><dt><span>title :</span></dt><dd>MRI-ESM2-0 output prepared for CMIP6</dd><dt><span>tracking_id :</span></dt><dd>hdl:21.14100/a0bd7d8f-4785-4687-b510-fd87808051b6</dd><dt><span>variable_id :</span></dt><dd>tas</dd><dt><span>variant_label :</span></dt><dd>r1i1p1f1</dd><dt><span>status :</span></dt><dd>2019-10-25;created;by nhn2@columbia.edu</dd><dt><span>netcdf_tracking_ids :</span></dt><dd>hdl:21.14100/a0bd7d8f-4785-4687-b510-fd87808051b6</dd><dt><span>version_id :</span></dt><dd>v20190222</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Now use dask to do this in parallel on all of the datasets:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dsets_</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">dsets</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/coding/times.py:987: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  dtype = _decode_cf_datetime_dtype(data, units, calendar, self.use_cftime)
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/coding/times.py:987: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  dtype = _decode_cf_datetime_dtype(data, units, calendar, self.use_cftime)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/core/indexing.py:524: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  return np.asarray(self.get_duck_array(), dtype=dtype)
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/core/indexing.py:524: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  return np.asarray(self.get_duck_array(), dtype=dtype)
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/coding/times.py:987: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  dtype = _decode_cf_datetime_dtype(data, units, calendar, self.use_cftime)
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/coding/times.py:987: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  dtype = _decode_cf_datetime_dtype(data, units, calendar, self.use_cftime)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/core/indexing.py:524: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  return np.asarray(self.get_duck_array(), dtype=dtype)
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/core/indexing.py:524: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  return np.asarray(self.get_duck_array(), dtype=dtype)
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/coding/times.py:987: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  dtype = _decode_cf_datetime_dtype(data, units, calendar, self.use_cftime)
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/coding/times.py:987: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  dtype = _decode_cf_datetime_dtype(data, units, calendar, self.use_cftime)
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/core/indexing.py:524: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  return np.asarray(self.get_duck_array(), dtype=dtype)
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/coding/times.py:987: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  dtype = _decode_cf_datetime_dtype(data, units, calendar, self.use_cftime)
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/core/indexing.py:524: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  return np.asarray(self.get_duck_array(), dtype=dtype)
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/coding/times.py:987: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  dtype = _decode_cf_datetime_dtype(data, units, calendar, self.use_cftime)
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/core/indexing.py:524: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  return np.asarray(self.get_duck_array(), dtype=dtype)
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/core/indexing.py:524: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  return np.asarray(self.get_duck_array(), dtype=dtype)
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/coding/times.py:987: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  dtype = _decode_cf_datetime_dtype(data, units, calendar, self.use_cftime)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/core/indexing.py:524: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  return np.asarray(self.get_duck_array(), dtype=dtype)
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/coding/times.py:987: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  dtype = _decode_cf_datetime_dtype(data, units, calendar, self.use_cftime)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/core/indexing.py:524: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  return np.asarray(self.get_duck_array(), dtype=dtype)
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/coding/times.py:987: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  dtype = _decode_cf_datetime_dtype(data, units, calendar, self.use_cftime)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/core/indexing.py:524: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  return np.asarray(self.get_duck_array(), dtype=dtype)
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/coding/times.py:987: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  dtype = _decode_cf_datetime_dtype(data, units, calendar, self.use_cftime)
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/runner/miniconda3/envs/cookbook-dev/lib/python3.10/site-packages/xarray/core/indexing.py:524: SerializationWarning: Unable to decode time axis into full numpy.datetime64 objects, continuing using cftime.datetime objects instead, reason: dates out of range
  return np.asarray(self.get_duck_array(), dtype=dtype)
/tmp/ipykernel_2623/947684616.py:6: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
</pre></div>
</div>
</div>
</div>
</section>
<section id="reduce-data-via-global-mean">
<h2>Reduce Data via Global Mean<a class="headerlink" href="#reduce-data-via-global-mean" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<p>We don’t want to load all of the raw model data into memory right away. Instead, we want to reduce the data by taking the global mean. We need to remember to weight this global mean by a factor proportional to <code class="docutils literal notranslate"><span class="pre">cos(lat)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_lat_name</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Figure out what is the latitude coordinate for each dataset.&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">lat_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">lat_name</span> <span class="ow">in</span> <span class="n">ds</span><span class="o">.</span><span class="n">coords</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">lat_name</span>
    <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Couldn&#39;t find a latitude coordinate&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">global_mean</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return global mean of a whole dataset.&quot;&quot;&quot;</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">get_lat_name</span><span class="p">(</span><span class="n">ds</span><span class="p">)]</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span>
    <span class="n">weight</span> <span class="o">/=</span> <span class="n">weight</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">other_dims</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span> <span class="o">-</span> <span class="p">{</span><span class="s1">&#39;time&#39;</span><span class="p">}</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ds</span> <span class="o">*</span> <span class="n">weight</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">other_dims</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We now apply this function, plus resampling to annual mean data, to all of the datasets. We also concatenate the experiments together into a single Dataset for each model. This is the most complex cell in the notebook. A lot is happening here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">expts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;piControl&#39;</span><span class="p">,</span> <span class="n">co2_option</span><span class="p">]</span>
<span class="n">expt_da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">expts</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="s1">&#39;experiment_id&#39;</span><span class="p">,</span>
                       <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;experiment_id&#39;</span><span class="p">:</span> <span class="n">expts</span><span class="p">})</span>

<span class="n">dsets_aligned</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">tqdm</span><span class="p">(</span><span class="n">dsets_</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">expt_dsets</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">d</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">expt_dsets</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing experiment for </span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">continue</span>

    <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">expt_dsets</span><span class="p">:</span>
        <span class="n">ds</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span> <span class="o">-</span> <span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># workaround for</span>
    <span class="c1"># https://github.com/pydata/xarray/issues/2237#issuecomment-620961663</span>
    <span class="n">dsets_ann_mean</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">expt</span><span class="p">]</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">global_mean</span><span class="p">)</span>
                             <span class="o">.</span><span class="n">swap_dims</span><span class="p">({</span><span class="s1">&#39;time&#39;</span><span class="p">:</span> <span class="s1">&#39;year&#39;</span><span class="p">})</span>
                             <span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
                             <span class="o">.</span><span class="n">coarsen</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
                      <span class="k">for</span> <span class="n">expt</span> <span class="ow">in</span> <span class="n">expts</span><span class="p">]</span>

    <span class="c1"># align everything with the 2xCO2 experiment</span>
    <span class="n">dsets_aligned</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dsets_ann_mean</span><span class="p">,</span> <span class="n">join</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
                                 <span class="n">dim</span><span class="o">=</span><span class="n">expt_da</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "2304b963ce884c41895cae1685d0364b"}</script><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/3716224114.py:20: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  .drop(&#39;time&#39;)
/tmp/ipykernel_2623/3716224114.py:20: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  .drop(&#39;time&#39;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/3716224114.py:20: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  .drop(&#39;time&#39;)
/tmp/ipykernel_2623/3716224114.py:20: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  .drop(&#39;time&#39;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/3716224114.py:20: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  .drop(&#39;time&#39;)
/tmp/ipykernel_2623/3716224114.py:20: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  .drop(&#39;time&#39;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/3716224114.py:20: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  .drop(&#39;time&#39;)
/tmp/ipykernel_2623/3716224114.py:20: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  .drop(&#39;time&#39;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/3716224114.py:20: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  .drop(&#39;time&#39;)
/tmp/ipykernel_2623/3716224114.py:20: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  .drop(&#39;time&#39;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/3716224114.py:20: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  .drop(&#39;time&#39;)
/tmp/ipykernel_2623/3716224114.py:20: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  .drop(&#39;time&#39;)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/3716224114.py:20: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  .drop(&#39;time&#39;)
/tmp/ipykernel_2623/3716224114.py:20: DeprecationWarning: dropping variables using `drop` is deprecated; use drop_vars.
  .drop(&#39;time&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section id="do-the-computation">
<h2>Do the Computation<a class="headerlink" href="#do-the-computation" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<p>Up to this point, no computations have actually happened. Everything has been “lazy”. Now we trigger the computation to actual occur and load the global/annual mean data into memory.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dsets_aligned_</span> <span class="o">=</span> <span class="n">dask</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">dsets_aligned</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Now we concatenate across models to produce one big dataset with all the required variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">source_ids</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dsets_aligned_</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">source_da</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">source_ids</span><span class="p">,</span> <span class="n">dims</span><span class="o">=</span><span class="s1">&#39;source_id&#39;</span><span class="p">,</span>
                         <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;source_id&#39;</span><span class="p">:</span> <span class="n">source_ids</span><span class="p">})</span>

<span class="n">big_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ds</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">dsets_aligned_</span><span class="o">.</span><span class="n">values</span><span class="p">()],</span>
                   <span class="n">dim</span><span class="o">=</span><span class="n">source_da</span><span class="p">)</span>
<span class="n">big_ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 114kB
Dimensions:        (source_id: 7, experiment_id: 2, year: 250)
Coordinates:
  * year           (year) float64 2kB 0.0 1.0 2.0 3.0 ... 247.0 248.0 249.0
  * experiment_id  (experiment_id) &lt;U12 96B &#x27;piControl&#x27; &#x27;abrupt-2xCO2&#x27;
  * source_id      (source_id) &lt;U12 336B &#x27;CESM2&#x27; &#x27;GISS-E2-1-G&#x27; ... &#x27;MRI-ESM2-0&#x27;
Data variables:
    rsut           (source_id, experiment_id, year) float64 28kB 99.36 ... nan
    tas            (source_id, experiment_id, year) float64 28kB 287.0 ... nan
    rsdt           (source_id, experiment_id, year) float64 28kB 340.3 ... nan
    rlut           (source_id, experiment_id, year) float64 28kB 240.2 ... nan</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-6fe642fc-47dc-41d1-a1b3-d0445483530f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6fe642fc-47dc-41d1-a1b3-d0445483530f' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>source_id</span>: 7</li><li><span class='xr-has-index'>experiment_id</span>: 2</li><li><span class='xr-has-index'>year</span>: 250</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-0c193dd4-36ac-4658-99a6-db625303a52c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0c193dd4-36ac-4658-99a6-db625303a52c' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.0 2.0 ... 247.0 248.0 249.0</div><input id='attrs-63e67253-bcd3-4ea0-b652-424f4151ed3d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-63e67253-bcd3-4ea0-b652-424f4151ed3d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e15f9065-2875-440c-98ab-34aa54fdbf57' class='xr-var-data-in' type='checkbox'><label for='data-e15f9065-2875-440c-98ab-34aa54fdbf57' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0.,   1.,   2., ..., 247., 248., 249.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>experiment_id</span></div><div class='xr-var-dims'>(experiment_id)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;piControl&#x27; &#x27;abrupt-2xCO2&#x27;</div><input id='attrs-39a47c8c-f3b5-47e9-ad50-dd78ced438c9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-39a47c8c-f3b5-47e9-ad50-dd78ced438c9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a0578aa0-dff6-4756-a19d-edf6d27ebb52' class='xr-var-data-in' type='checkbox'><label for='data-a0578aa0-dff6-4756-a19d-edf6d27ebb52' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;piControl&#x27;, &#x27;abrupt-2xCO2&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>source_id</span></div><div class='xr-var-dims'>(source_id)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;CESM2&#x27; ... &#x27;MRI-ESM2-0&#x27;</div><input id='attrs-10985923-1c62-43b8-8b20-8d56265b2fa1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-10985923-1c62-43b8-8b20-8d56265b2fa1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a85d2009-69c9-4347-9672-1b0e035557d1' class='xr-var-data-in' type='checkbox'><label for='data-a85d2009-69c9-4347-9672-1b0e035557d1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;CESM2&#x27;, &#x27;GISS-E2-1-G&#x27;, &#x27;GISS-E2-1-H&#x27;, &#x27;GISS-E2-2-G&#x27;, &#x27;IPSL-CM6A-LR&#x27;,
       &#x27;MIROC6&#x27;, &#x27;MRI-ESM2-0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-70fe7a98-678c-4632-a942-a02f3c790d7d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-70fe7a98-678c-4632-a942-a02f3c790d7d' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>rsut</span></div><div class='xr-var-dims'>(source_id, experiment_id, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>99.36 99.8 98.94 ... nan nan nan</div><input id='attrs-e7bec80e-f292-4104-a2d5-838297862c74' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e7bec80e-f292-4104-a2d5-838297862c74' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2477e485-4cc9-4fbf-a88e-a4424466cbef' class='xr-var-data-in' type='checkbox'><label for='data-2477e485-4cc9-4fbf-a88e-a4424466cbef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[ 99.36393586,  99.80283632,  98.94191234, ...,          nan,
                  nan,          nan],
        [ 97.82037343,  97.79000894,  97.01762283, ...,          nan,
                  nan,          nan]],

       [[101.4390611 , 101.56296953, 101.4972957 , ...,          nan,
                  nan,          nan],
        [101.0366182 , 101.00232906, 100.84826946, ...,          nan,
                  nan,          nan]],

       [[100.66435273, 100.51116956, 100.89353578, ...,          nan,
                  nan,          nan],
        [100.60859904, 100.53582333, 100.60002885, ...,          nan,
                  nan,          nan]],

       ...,

       [[102.75021362, 103.10281372, 102.87644196, ...,          nan,
                  nan,          nan],
        [100.99295807, 101.50688934, 101.97058105, ...,          nan,
                  nan,          nan]],

       [[108.8646907 , 108.49889761, 108.90849884, ..., 108.70599882,
         108.96811199, 108.72818105],
        [108.12545905, 108.27118498, 107.91076284, ..., 107.34994386,
         107.12170546, 107.09244583]],

       [[ 98.00645259,  97.99298826,  98.13119018, ...,          nan,
                  nan,          nan],
        [ 96.58950119,  96.63950599,  96.21623569, ...,          nan,
                  nan,          nan]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tas</span></div><div class='xr-var-dims'>(source_id, experiment_id, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>287.0 287.1 287.0 ... nan nan nan</div><input id='attrs-b971168b-1a93-4481-b5aa-74aa0bf547ac' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b971168b-1a93-4481-b5aa-74aa0bf547ac' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-353af12a-7eab-498f-abab-08d362bda5c1' class='xr-var-data-in' type='checkbox'><label for='data-353af12a-7eab-498f-abab-08d362bda5c1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[286.9850739 , 287.06653368, 286.98444303, ...,          nan,
                  nan,          nan],
        [287.48014449, 287.7394101 , 288.01731092, ...,          nan,
                  nan,          nan]],

       [[286.9343543 , 286.9199378 , 286.92800874, ...,          nan,
                  nan,          nan],
        [287.47643137, 287.64304425, 287.92338648, ...,          nan,
                  nan,          nan]],

       [[287.23218778, 287.35340132, 287.36071829, ...,          nan,
                  nan,          nan],
        [287.82533396, 288.24506914, 288.49300187, ...,          nan,
                  nan,          nan]],

       ...,

       [[286.09158325, 286.10717773, 286.03372192, ...,          nan,
                  nan,          nan],
        [286.59127808, 287.17440796, 287.36087036, ...,          nan,
                  nan,          nan]],

       [[288.31629875, 288.45178258, 288.4777738 , ..., 288.45273041,
         288.37086858, 288.48120669],
        [288.8184018 , 289.08524988, 289.31636523, ..., 290.57012689,
         290.34771036, 290.18482772]],

       [[286.90136665, 286.87541207, 286.83983702, ...,          nan,
                  nan,          nan],
        [287.44460171, 287.60650445, 287.87638255, ...,          nan,
                  nan,          nan]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rsdt</span></div><div class='xr-var-dims'>(source_id, experiment_id, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>340.3 340.3 340.3 ... nan nan nan</div><input id='attrs-558bb3fd-bad5-4d0d-a3c7-c1aece499fd9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-558bb3fd-bad5-4d0d-a3c7-c1aece499fd9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1fa828f6-b846-459a-9d4d-7846bc811476' class='xr-var-data-in' type='checkbox'><label for='data-1fa828f6-b846-459a-9d4d-7846bc811476' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[340.25427344, 340.25427344, 340.25427344, ...,          nan,
                  nan,          nan],
        [340.25427344, 340.25427344, 340.25427344, ...,          nan,
                  nan,          nan]],

       [[340.31299703, 340.31299703, 340.31299703, ...,          nan,
                  nan,          nan],
        [340.31299573, 340.31299573, 340.31299573, ...,          nan,
                  nan,          nan]],

       [[340.31299573, 340.31299573, 340.31299573, ...,          nan,
                  nan,          nan],
        [340.31299573, 340.31299573, 340.31299573, ...,          nan,
                  nan,          nan]],

       ...,

       [[341.65182495, 341.65182495, 341.66079712, ...,          nan,
                  nan,          nan],
        [341.65182495, 341.65182495, 341.66079712, ...,          nan,
                  nan,          nan]],

       [[340.22406601, 340.24657384, 340.24656962, ..., 340.24657516,
         340.2240696 , 340.24657389],
        [340.22406187, 340.24658263, 340.24657275, ..., 340.2465728 ,
         340.22406728, 340.24657341]],

       [[340.254947  , 340.254947  , 340.2640629 , ...,          nan,
                  nan,          nan],
        [340.254947  , 340.254947  , 340.2640629 , ...,          nan,
                  nan,          nan]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rlut</span></div><div class='xr-var-dims'>(source_id, experiment_id, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>240.2 240.5 240.1 ... nan nan nan</div><input id='attrs-903bd2c7-8711-474b-84e0-5ae9e1e9f07b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-903bd2c7-8711-474b-84e0-5ae9e1e9f07b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-df77969e-866f-4cb6-8d18-9767feb3ce43' class='xr-var-data-in' type='checkbox'><label for='data-df77969e-866f-4cb6-8d18-9767feb3ce43' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[240.191604  , 240.48018287, 240.14496437, ...,          nan,
                  nan,          nan],
        [237.65958533, 238.36057267, 238.90966217, ...,          nan,
                  nan,          nan]],

       [[238.63641591, 238.79870786, 238.71907378, ...,          nan,
                  nan,          nan],
        [235.99094115, 236.40002371, 236.7402137 , ...,          nan,
                  nan,          nan]],

       [[239.20591515, 239.51517967, 239.280247  , ...,          nan,
                  nan,          nan],
        [236.23198909, 237.14592423, 237.39700028, ...,          nan,
                  nan,          nan]],

       ...,

       [[238.27838135, 238.13494873, 238.2039032 , ...,          nan,
                  nan,          nan],
        [236.03692627, 236.82038879, 237.15605164, ...,          nan,
                  nan,          nan]],

       [[230.1649978 , 230.32354978, 230.40610909, ..., 230.28280645,
         230.28065609, 230.35605828],
        [228.11024163, 228.6672724 , 229.18270831, ..., 231.98662039,
         231.32286213, 231.08566087]],

       [[241.70191145, 241.46380205, 241.5131782 , ...,          nan,
                  nan,          nan],
        [239.70625678, 240.17113091, 240.5943591 , ...,          nan,
                  nan,          nan]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bbeb9ff3-46fe-4c5a-8942-10033f02b2c0' class='xr-section-summary-in' type='checkbox'  ><label for='section-bbeb9ff3-46fe-4c5a-8942-10033f02b2c0' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-29495331-c7ca-48d4-907c-00716203be24' class='xr-index-data-in' type='checkbox'/><label for='index-29495331-c7ca-48d4-907c-00716203be24' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,
       ...
       240.0, 241.0, 242.0, 243.0, 244.0, 245.0, 246.0, 247.0, 248.0, 249.0],
      dtype=&#x27;float64&#x27;, name=&#x27;year&#x27;, length=250))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>experiment_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-8487eaa1-9000-41cf-8076-6ecea44ad84d' class='xr-index-data-in' type='checkbox'/><label for='index-8487eaa1-9000-41cf-8076-6ecea44ad84d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;piControl&#x27;, &#x27;abrupt-2xCO2&#x27;], dtype=&#x27;object&#x27;, name=&#x27;experiment_id&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>source_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b8356597-daad-4d58-a1a4-8f8151e17ed6' class='xr-index-data-in' type='checkbox'/><label for='index-b8356597-daad-4d58-a1a4-8f8151e17ed6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;CESM2&#x27;, &#x27;GISS-E2-1-G&#x27;, &#x27;GISS-E2-1-H&#x27;, &#x27;GISS-E2-2-G&#x27;, &#x27;IPSL-CM6A-LR&#x27;,
       &#x27;MIROC6&#x27;, &#x27;MRI-ESM2-0&#x27;],
      dtype=&#x27;object&#x27;, name=&#x27;source_id&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-87b77350-5cbd-4787-a87f-7644c5fac2c0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-87b77350-5cbd-4787-a87f-7644c5fac2c0' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="calculated-derived-variables">
<h2>Calculated Derived Variables<a class="headerlink" href="#calculated-derived-variables" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<p>We need to calculate the net radiative imbalance, plus the anomaly of the abrupt 2xCO2 run compared to the piControl run.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">big_ds</span><span class="p">[</span><span class="s1">&#39;imbalance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">big_ds</span><span class="p">[</span><span class="s1">&#39;rsdt&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">big_ds</span><span class="p">[</span><span class="s1">&#39;rsut&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">big_ds</span><span class="p">[</span><span class="s1">&#39;rlut&#39;</span><span class="p">]</span>

<span class="n">ds_mean</span> <span class="o">=</span> <span class="n">big_ds</span><span class="p">[[</span><span class="s1">&#39;tas&#39;</span><span class="p">,</span> <span class="s1">&#39;imbalance&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">experiment_id</span><span class="o">=</span><span class="s1">&#39;piControl&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">)</span>
<span class="n">ds_anom</span> <span class="o">=</span> <span class="n">big_ds</span><span class="p">[[</span><span class="s1">&#39;tas&#39;</span><span class="p">,</span> <span class="s1">&#39;imbalance&#39;</span><span class="p">]]</span> <span class="o">-</span> <span class="n">ds_mean</span>

<span class="c1"># add some metadata</span>
<span class="n">ds_anom</span><span class="o">.</span><span class="n">tas</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Global Mean Surface Temp Anom&#39;</span>
<span class="n">ds_anom</span><span class="o">.</span><span class="n">tas</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span>
<span class="n">ds_anom</span><span class="o">.</span><span class="n">imbalance</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Global Mean Radiative Imbalance&#39;</span>
<span class="n">ds_anom</span><span class="o">.</span><span class="n">imbalance</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;W m$^{-2}$&#39;</span>

<span class="n">ds_anom</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 58kB
Dimensions:        (year: 250, experiment_id: 2, source_id: 7)
Coordinates:
  * year           (year) float64 2kB 0.0 1.0 2.0 3.0 ... 247.0 248.0 249.0
  * experiment_id  (experiment_id) &lt;U12 96B &#x27;piControl&#x27; &#x27;abrupt-2xCO2&#x27;
  * source_id      (source_id) &lt;U12 336B &#x27;CESM2&#x27; &#x27;GISS-E2-1-G&#x27; ... &#x27;MRI-ESM2-0&#x27;
Data variables:
    tas            (source_id, experiment_id, year) float64 28kB 0.06312 ... nan
    imbalance      (source_id, experiment_id, year) float64 28kB -0.04953 ......</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-2c1fc379-11b6-4e47-ab9b-94068aec2640' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2c1fc379-11b6-4e47-ab9b-94068aec2640' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 250</li><li><span class='xr-has-index'>experiment_id</span>: 2</li><li><span class='xr-has-index'>source_id</span>: 7</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-a4135f93-09ea-4284-8436-a4cff983bd66' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a4135f93-09ea-4284-8436-a4cff983bd66' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.0 2.0 ... 247.0 248.0 249.0</div><input id='attrs-3c75fb85-9c85-48b4-a5a5-7414ab6a0af6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3c75fb85-9c85-48b4-a5a5-7414ab6a0af6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-25b86c94-122f-4149-9456-c83895ac0083' class='xr-var-data-in' type='checkbox'><label for='data-25b86c94-122f-4149-9456-c83895ac0083' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0.,   1.,   2., ..., 247., 248., 249.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>experiment_id</span></div><div class='xr-var-dims'>(experiment_id)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;piControl&#x27; &#x27;abrupt-2xCO2&#x27;</div><input id='attrs-2aa945b6-270e-4849-b2e3-d85cb608f609' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2aa945b6-270e-4849-b2e3-d85cb608f609' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-70e25f87-a7c7-42af-8ee0-465e8524975d' class='xr-var-data-in' type='checkbox'><label for='data-70e25f87-a7c7-42af-8ee0-465e8524975d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;piControl&#x27;, &#x27;abrupt-2xCO2&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>source_id</span></div><div class='xr-var-dims'>(source_id)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;CESM2&#x27; ... &#x27;MRI-ESM2-0&#x27;</div><input id='attrs-f2586e09-f864-4944-975c-0f7b68488503' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f2586e09-f864-4944-975c-0f7b68488503' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4453282a-85d7-4d8e-8d73-38b106dce8e7' class='xr-var-data-in' type='checkbox'><label for='data-4453282a-85d7-4d8e-8d73-38b106dce8e7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;CESM2&#x27;, &#x27;GISS-E2-1-G&#x27;, &#x27;GISS-E2-1-H&#x27;, &#x27;GISS-E2-2-G&#x27;, &#x27;IPSL-CM6A-LR&#x27;,
       &#x27;MIROC6&#x27;, &#x27;MRI-ESM2-0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5409bbc5-7356-4aa7-b99d-da2fa296beec' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5409bbc5-7356-4aa7-b99d-da2fa296beec' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tas</span></div><div class='xr-var-dims'>(source_id, experiment_id, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.06312 0.1446 0.06249 ... nan nan</div><input id='attrs-6eed74b1-5c1c-4639-9bcd-945f5f024ec0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6eed74b1-5c1c-4639-9bcd-945f5f024ec0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6bbdf457-b0a1-4165-a9a3-48b71132f170' class='xr-var-data-in' type='checkbox'><label for='data-6bbdf457-b0a1-4165-a9a3-48b71132f170' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Global Mean Surface Temp Anom</dd><dt><span>units :</span></dt><dd>K</dd></dl></div><div class='xr-var-data'><pre>array([[[ 0.06312165,  0.14458142,  0.06249077, ...,         nan,
                 nan,         nan],
        [ 0.55819223,  0.81745784,  1.09535866, ...,         nan,
                 nan,         nan]],

       [[ 0.02001347,  0.00559697,  0.01366791, ...,         nan,
                 nan,         nan],
        [ 0.56209054,  0.72870342,  1.00904565, ...,         nan,
                 nan,         nan]],

       [[-0.04873387,  0.07247968,  0.07979664, ...,         nan,
                 nan,         nan],
        [ 0.54441231,  0.96414749,  1.21208022, ...,         nan,
                 nan,         nan]],

       ...,

       [[ 0.19686259,  0.21245707,  0.13900126, ...,         nan,
                 nan,         nan],
        [ 0.69655741,  1.2796873 ,  1.4661497 , ...,         nan,
                 nan,         nan]],

       [[-0.03490859,  0.10057523,  0.12656646, ...,  0.10152306,
          0.01966124,  0.12999935],
        [ 0.46719446,  0.73404254,  0.96515788, ...,  2.21891955,
          1.99650302,  1.83362038]],

       [[-0.0086573 , -0.03461188, -0.07018693, ...,         nan,
                 nan,         nan],
        [ 0.53457776,  0.6964805 ,  0.9663586 , ...,         nan,
                 nan,         nan]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>imbalance</span></div><div class='xr-var-dims'>(source_id, experiment_id, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.04953 -0.777 0.4191 ... nan nan</div><input id='attrs-c9dff8b2-e0c6-426c-ab0f-209aa25a874b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c9dff8b2-e0c6-426c-ab0f-209aa25a874b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0d8eaa76-a07f-488a-b8dc-1d0646f35b29' class='xr-var-data-in' type='checkbox'><label for='data-0d8eaa76-a07f-488a-b8dc-1d0646f35b29' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Global Mean Radiative Imbalance</dd><dt><span>units :</span></dt><dd>W m$^{-2}$</dd></dl></div><div class='xr-var-data'><pre>array([[[-0.04953143, -0.77701077,  0.41913172, ...,         nan,
                 nan,         nan],
        [ 4.02604967,  3.35542682,  3.57872343, ...,         nan,
                 nan,         nan]],

       [[ 0.12200747, -0.16419291, -0.018885  , ...,         nan,
                 nan,         nan],
        [ 3.16992385,  2.79513042,  2.60900003, ...,         nan,
                 nan,         nan]],

       [[ 0.36922609,  0.21314474,  0.06571119, ...,         nan,
                 nan,         nan],
        [ 3.39890584,  2.55774641,  2.24246484, ...,         nan,
                 nan,         nan]],

       ...,

       [[-0.091017  , -0.30018448, -0.13379501, ...,         nan,
                 nan,         nan],
        [ 3.90769363,  2.61029984,  1.81991745, ...,         nan,
                 nan,         nan]],

       [[ 0.05491239,  0.28466133, -0.20750343, ...,  0.11830477,
         -0.1641636 ,  0.02286943],
        [ 2.84889607,  2.16866012,  2.01363648, ..., -0.22945657,
          0.64003458,  0.92900159]],

       [[-0.41629225, -0.16471851, -0.34318069, ...,         nan,
                 nan,         nan],
        [ 2.99631382,  2.48143489,  2.49059289, ...,         nan,
                 nan,         nan]]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1e598ee7-7f7c-4ae1-8ff3-f4198ba1ae66' class='xr-section-summary-in' type='checkbox'  ><label for='section-1e598ee7-7f7c-4ae1-8ff3-f4198ba1ae66' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d9d3d766-f73b-4c24-a0e1-06ddf3b821f7' class='xr-index-data-in' type='checkbox'/><label for='index-d9d3d766-f73b-4c24-a0e1-06ddf3b821f7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,
       ...
       240.0, 241.0, 242.0, 243.0, 244.0, 245.0, 246.0, 247.0, 248.0, 249.0],
      dtype=&#x27;float64&#x27;, name=&#x27;year&#x27;, length=250))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>experiment_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c4bccf7f-095d-4bbb-8c62-7db9e8f061a8' class='xr-index-data-in' type='checkbox'/><label for='index-c4bccf7f-095d-4bbb-8c62-7db9e8f061a8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;piControl&#x27;, &#x27;abrupt-2xCO2&#x27;], dtype=&#x27;object&#x27;, name=&#x27;experiment_id&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>source_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d1e99799-f29d-4ef1-bfcb-77d1c21a07dd' class='xr-index-data-in' type='checkbox'/><label for='index-d1e99799-f29d-4ef1-bfcb-77d1c21a07dd' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;CESM2&#x27;, &#x27;GISS-E2-1-G&#x27;, &#x27;GISS-E2-1-H&#x27;, &#x27;GISS-E2-2-G&#x27;, &#x27;IPSL-CM6A-LR&#x27;,
       &#x27;MIROC6&#x27;, &#x27;MRI-ESM2-0&#x27;],
      dtype=&#x27;object&#x27;, name=&#x27;source_id&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ac77a38d-c61c-45b8-b747-87c8e38aa9f7' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-ac77a38d-c61c-45b8-b747-87c8e38aa9f7' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="plot-timeseries">
<h2>Plot Timeseries<a class="headerlink" href="#plot-timeseries" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<p>Here we plot the global mean surface temperature for each model:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_anom</span><span class="o">.</span><span class="n">tas</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;source_id&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.plot.facetgrid.FacetGrid at 0x7f71fc863340&gt;
</pre></div>
</div>
<img alt="../../_images/1eef20804178bf331f3b26e122078eb84a8780453ceaec656c830b0ce0695655.png" src="../../_images/1eef20804178bf331f3b26e122078eb84a8780453ceaec656c830b0ce0695655.png" />
</div>
</div>
<p>We can see that the models cover different time intervals. Let’s limit the rest of our analysis to the first 150 years.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_150_years</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">149</span><span class="p">)</span>
<span class="n">ds_anom</span><span class="o">.</span><span class="n">tas</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">first_150_years</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;source_id&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.plot.facetgrid.FacetGrid at 0x7f71fc29f880&gt;
</pre></div>
</div>
<img alt="../../_images/a290ff1179109b0606d83e4a3c026ab9f7befb7cded947b4c5d5372e63feed81.png" src="../../_images/a290ff1179109b0606d83e4a3c026ab9f7befb7cded947b4c5d5372e63feed81.png" />
</div>
</div>
<p>Same thing for radiative imbalance:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_anom</span><span class="o">.</span><span class="n">imbalance</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">first_150_years</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s1">&#39;source_id&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.plot.facetgrid.FacetGrid at 0x7f71f4f59660&gt;
</pre></div>
</div>
<img alt="../../_images/bfdda9fb02e2aa2173853f036422a7723d45cf9dfed5679b703768159a466cd6.png" src="../../_images/bfdda9fb02e2aa2173853f036422a7723d45cf9dfed5679b703768159a466cd6.png" />
</div>
</div>
</section>
<section id="calculate-ecs">
<h2>Calculate ECS<a class="headerlink" href="#calculate-ecs" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_abrupt</span> <span class="o">=</span> <span class="n">ds_anom</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">year</span><span class="o">=</span><span class="n">first_150_years</span><span class="p">,</span> <span class="n">experiment_id</span><span class="o">=</span><span class="n">co2_option</span><span class="p">)</span><span class="o">.</span><span class="n">reset_coords</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">calc_ecs</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="c1"># Some sources don&#39;t have all 150 years, drop those missing values.</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">tas</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">),</span>
                      <span class="n">ds</span><span class="o">.</span><span class="n">imbalance</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="s2">&quot;year&quot;</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ecs</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span><span class="o">/</span><span class="n">a</span><span class="p">)</span> <span class="c1"># Change -1.0 to -0.5 if using 4xCO2</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">ecs</span><span class="p">)</span>

<span class="n">ds_abrupt</span><span class="p">[</span><span class="s1">&#39;ecs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_abrupt</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;source_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">calc_ecs</span><span class="p">)</span>
<span class="n">ds_abrupt</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_2623/2946594559.py:10: UserWarning: The `squeeze` kwarg to GroupBy is being removed.Pass .groupby(..., squeeze=False) to disable squeezing, which is the new default, and to silence this warning.
  ds_abrupt[&#39;ecs&#39;] = ds_abrupt.groupby(&#39;source_id&#39;).apply(calc_ecs)
</pre></div>
</div>
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 18kB
Dimensions:    (year: 150, source_id: 7)
Coordinates:
  * year       (year) float64 1kB 0.0 1.0 2.0 3.0 ... 146.0 147.0 148.0 149.0
  * source_id  (source_id) &lt;U12 336B &#x27;CESM2&#x27; &#x27;GISS-E2-1-G&#x27; ... &#x27;MRI-ESM2-0&#x27;
Data variables:
    tas        (source_id, year) float64 8kB 0.5582 0.8175 1.095 ... 1.646 1.616
    imbalance  (source_id, year) float64 8kB 4.026 3.355 3.579 ... 1.022 0.7031
    ecs        (source_id) float64 56B 3.526 2.659 2.932 2.501 3.827 2.235 2.552</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-5c9b60af-2e50-47ed-b4b1-e1ca7a6956df' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5c9b60af-2e50-47ed-b4b1-e1ca7a6956df' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 150</li><li><span class='xr-has-index'>source_id</span>: 7</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f124c795-43cd-421a-88f6-db7aee106fce' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f124c795-43cd-421a-88f6-db7aee106fce' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.0 2.0 ... 147.0 148.0 149.0</div><input id='attrs-f671f65d-8dea-4087-903a-d464a6323c74' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f671f65d-8dea-4087-903a-d464a6323c74' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5cca67f4-6e95-437d-a430-514439af86a4' class='xr-var-data-in' type='checkbox'><label for='data-5cca67f4-6e95-437d-a430-514439af86a4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0.,   1.,   2.,   3.,   4.,   5.,   6.,   7.,   8.,   9.,  10.,  11.,
        12.,  13.,  14.,  15.,  16.,  17.,  18.,  19.,  20.,  21.,  22.,  23.,
        24.,  25.,  26.,  27.,  28.,  29.,  30.,  31.,  32.,  33.,  34.,  35.,
        36.,  37.,  38.,  39.,  40.,  41.,  42.,  43.,  44.,  45.,  46.,  47.,
        48.,  49.,  50.,  51.,  52.,  53.,  54.,  55.,  56.,  57.,  58.,  59.,
        60.,  61.,  62.,  63.,  64.,  65.,  66.,  67.,  68.,  69.,  70.,  71.,
        72.,  73.,  74.,  75.,  76.,  77.,  78.,  79.,  80.,  81.,  82.,  83.,
        84.,  85.,  86.,  87.,  88.,  89.,  90.,  91.,  92.,  93.,  94.,  95.,
        96.,  97.,  98.,  99., 100., 101., 102., 103., 104., 105., 106., 107.,
       108., 109., 110., 111., 112., 113., 114., 115., 116., 117., 118., 119.,
       120., 121., 122., 123., 124., 125., 126., 127., 128., 129., 130., 131.,
       132., 133., 134., 135., 136., 137., 138., 139., 140., 141., 142., 143.,
       144., 145., 146., 147., 148., 149.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>source_id</span></div><div class='xr-var-dims'>(source_id)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;CESM2&#x27; ... &#x27;MRI-ESM2-0&#x27;</div><input id='attrs-48ef053f-3cf0-48eb-9a36-f279a03d12d0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-48ef053f-3cf0-48eb-9a36-f279a03d12d0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8ac5c433-6f63-4f26-9615-8839ce4bd132' class='xr-var-data-in' type='checkbox'><label for='data-8ac5c433-6f63-4f26-9615-8839ce4bd132' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;CESM2&#x27;, &#x27;GISS-E2-1-G&#x27;, &#x27;GISS-E2-1-H&#x27;, &#x27;GISS-E2-2-G&#x27;, &#x27;IPSL-CM6A-LR&#x27;,
       &#x27;MIROC6&#x27;, &#x27;MRI-ESM2-0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7dd35a3d-7215-471d-8801-3a0c864f80f0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7dd35a3d-7215-471d-8801-3a0c864f80f0' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tas</span></div><div class='xr-var-dims'>(source_id, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.5582 0.8175 1.095 ... 1.646 1.616</div><input id='attrs-26da0ffb-70f2-4283-a12c-b7e30978f5db' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-26da0ffb-70f2-4283-a12c-b7e30978f5db' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3089558d-69ec-4a29-b077-fa22c71d4ee4' class='xr-var-data-in' type='checkbox'><label for='data-3089558d-69ec-4a29-b077-fa22c71d4ee4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Global Mean Surface Temp Anom</dd><dt><span>units :</span></dt><dd>K</dd></dl></div><div class='xr-var-data'><pre>array([[0.55819223, 0.81745784, 1.09535866, ..., 2.78579546, 2.81815608,
        2.84298753],
       [0.56209054, 0.72870342, 1.00904565, ..., 2.30772005, 2.2496876 ,
        2.14807954],
       [0.54441231, 0.96414749, 1.21208022, ..., 2.63851405, 2.42792187,
        2.34847531],
       ...,
       [0.69655741, 1.2796873 , 1.4661497 , ..., 3.09743632, 3.02495707,
        3.20421733],
       [0.46719446, 0.73404254, 0.96515788, ..., 2.01300088, 1.91896167,
        1.96757883],
       [0.53457776, 0.6964805 , 0.9663586 , ..., 1.89364471, 1.64573962,
        1.61609827]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>imbalance</span></div><div class='xr-var-dims'>(source_id, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.026 3.355 3.579 ... 1.022 0.7031</div><input id='attrs-37341bc1-15e7-483e-9f12-6af12c77f31c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-37341bc1-15e7-483e-9f12-6af12c77f31c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-38da9830-cea1-475d-b06b-974322129af3' class='xr-var-data-in' type='checkbox'><label for='data-38da9830-cea1-475d-b06b-974322129af3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Global Mean Radiative Imbalance</dd><dt><span>units :</span></dt><dd>W m$^{-2}$</dd></dl></div><div class='xr-var-data'><pre>array([[4.02604967, 3.35542682, 3.57872343, ..., 0.65531467, 1.46648058,
        1.09784156],
       [3.16992385, 2.79513042, 2.60900003, ..., 0.46905707, 0.54642323,
        0.5188314 ],
       [3.39890584, 2.55774641, 2.24246484, ..., 0.16186796, 0.48404896,
        1.12914552],
       ...,
       [3.90769363, 2.61029984, 1.81991745, ..., 0.58088089, 0.90067459,
        1.13007523],
       [2.84889607, 2.16866012, 2.01363648, ..., 1.03411792, 0.76245993,
        0.66630028],
       [2.99631382, 2.48143489, 2.49059289, ..., 0.81439704, 1.02247347,
        0.70310016]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ecs</span></div><div class='xr-var-dims'>(source_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>3.526 2.659 2.932 ... 2.235 2.552</div><input id='attrs-ad831d0a-2512-45d8-ac8c-cbd1e29ae15c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ad831d0a-2512-45d8-ac8c-cbd1e29ae15c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-96628e9d-d11f-4551-8247-bea53b2f0165' class='xr-var-data-in' type='checkbox'><label for='data-96628e9d-d11f-4551-8247-bea53b2f0165' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([3.52587433, 2.65858194, 2.93219464, 2.50138386, 3.82672137,
       2.23504735, 2.55244043])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-388e61b8-9eaf-409d-b43f-40403e22fa9f' class='xr-section-summary-in' type='checkbox'  ><label for='section-388e61b8-9eaf-409d-b43f-40403e22fa9f' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-353700ef-b2fa-4b30-88f3-959a0976acfc' class='xr-index-data-in' type='checkbox'/><label for='index-353700ef-b2fa-4b30-88f3-959a0976acfc' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,
       ...
       140.0, 141.0, 142.0, 143.0, 144.0, 145.0, 146.0, 147.0, 148.0, 149.0],
      dtype=&#x27;float64&#x27;, name=&#x27;year&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>source_id</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-9243bcc5-ccc9-4494-8496-fb7476c28edf' class='xr-index-data-in' type='checkbox'/><label for='index-9243bcc5-ccc9-4494-8496-fb7476c28edf' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;CESM2&#x27;, &#x27;GISS-E2-1-G&#x27;, &#x27;GISS-E2-1-H&#x27;, &#x27;GISS-E2-2-G&#x27;, &#x27;IPSL-CM6A-LR&#x27;,
       &#x27;MIROC6&#x27;, &#x27;MRI-ESM2-0&#x27;],
      dtype=&#x27;object&#x27;, name=&#x27;source_id&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-36440ac8-27b6-44bf-8afe-1c6626ff3251' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-36440ac8-27b6-44bf-8afe-1c6626ff3251' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<p>Also, make sure that we set a couple of the variables to be coordinates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_abrupt</span> <span class="o">=</span> <span class="n">ds_abrupt</span><span class="o">.</span><span class="n">set_coords</span><span class="p">([</span><span class="s1">&#39;tas&#39;</span><span class="p">,</span> <span class="s1">&#39;imbalance&#39;</span><span class="p">])</span>

<span class="n">fg</span> <span class="o">=</span> <span class="n">ds_abrupt</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;tas&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;imbalance&#39;</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="s1">&#39;source_id&#39;</span><span class="p">,</span> <span class="n">col_wrap</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">calc_and_plot_ecs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">y</span><span class="p">)]</span>
    <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ecs</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">*</span> <span class="n">b</span><span class="o">/</span><span class="n">a</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">polyval</span><span class="p">([</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">]),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;ECS = </span><span class="si">{</span><span class="n">ecs</span><span class="si">:</span><span class="s1">3.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;weight&#39;</span><span class="p">:</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">})</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">fg</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">calc_and_plot_ecs</span><span class="p">,</span> <span class="s1">&#39;tas&#39;</span><span class="p">,</span> <span class="s1">&#39;imbalance&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.plot.facetgrid.FacetGrid at 0x7f71f4a8bb50&gt;
</pre></div>
</div>
<img alt="../../_images/dc7d947fb0518076d8f528fceb9facd16e68dcf04f657eaa36d2649a641b6889.png" src="../../_images/dc7d947fb0518076d8f528fceb9facd16e68dcf04f657eaa36d2649a641b6889.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_abrupt</span><span class="o">.</span><span class="n">ecs</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/43bd08648b54180cc8c56c64f1fc876090549f27cdc592b5e790626bccabffda.png" src="../../_images/43bd08648b54180cc8c56c64f1fc876090549f27cdc592b5e790626bccabffda.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_abrupt</span><span class="o">.</span><span class="n">ecs</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;ecs&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Axes: xlabel=&#39;source_id&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/2a0eeec45aabb1d3a06b467c1c8ee4409b6d171c320ea0d6c08318d2b3d02677.png" src="../../_images/2a0eeec45aabb1d3a06b467c1c8ee4409b6d171c320ea0d6c08318d2b3d02677.png" />
</div>
</div>
<p>We’re at the end of the notebook, so let’s shutdown our Dask cluster.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">client</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<p>In this notebook, we estimated ECS for a subset of CMIP6 models using the Gregory method.</p>
<section id="whats-next">
<h3>What’s next?<a class="headerlink" href="#whats-next" title="Link to this heading"><i class="fas fa-link"></i></a></h3>
<p>We will plot global average surface air temperature for a historical run and two branching emissions scenarios.</p>
</section>
</section>
<section id="resources-and-references">
<h2>Resources and references<a class="headerlink" href="#resources-and-references" title="Link to this heading"><i class="fas fa-link"></i></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="http://gallery.pangeo.io/repos/pangeo-gallery/cmip6/ECS_Gregory_method.html">Original notebook in the Pangeo Gallery</a> by Henri Drake and <a class="reference external" href="https://ocean-transport.github.io/">Ryan Abernathey</a></p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/example-workflows"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                  </article>

                
                

                
                
                  <footer class="prev-next-footer">
                    
<div class="prev-next-area">
    <a class="left-prev"
       href="../foundations/esgf-opendap.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Search and Load CMIP6 Data via ESGF/OPeNDAP</p>
      </div>
    </a>
    <a class="right-next"
       href="gmst.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Global Mean Surface Temperature</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                  </footer>
                
              </div>

              
              
                
                  <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prerequisites">Prerequisites</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#imports">Imports</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-cluster">Compute Cluster</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#data-catalogs">Data catalogs</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#use-intake-esm">Use Intake-ESM</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-data">Loading Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#prepare-data">Prepare Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reduce-data-via-global-mean">Reduce Data via Global Mean</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#do-the-computation">Do the Computation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculated-derived-variables">Calculated Derived Variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-timeseries">Plot Timeseries</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-ecs">Calculate ECS</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#whats-next">What’s next?</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#resources-and-references">Resources and references</a></li>
</ul>
  </nav></div>

</div></div>
                
              


                
                <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://binder.projectpythia.org/v2/gh/ProjectPythia/cmip6-cookbook/main?urlpath=lab/tree/notebooks/example-workflows/ecs-cmip6.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://nimbus6.llnl.gov/hub/user-redirect/git-pull?repo=https%3A//github.com/ProjectPythia/cmip6-cookbook&urlpath=lab/tree/cmip6-cookbook/notebooks/example-workflows/ecs-cmip6.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ProjectPythia/cmip6-cookbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ProjectPythia/cmip6-cookbook/edit/main/notebooks/example-workflows/ecs-cmip6.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ProjectPythia/cmip6-cookbook/issues/new?title=Issue%20on%20page%20%2Fnotebooks/example-workflows/ecs-cmip6.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/example-workflows/ecs-cmip6.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
            </div>

            <footer class="bd-footer-content">
              
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Ryan Abernathey, Henri Drake, Robert Ford
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on 24 May 2024.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
            </footer>

        </main>
    </div>
  </div>
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
     
  
  
  
  
    <div class="footer-items__start">
      <div class="container-fluid m-0 p-0">
      
        <div class="footer-item">
  <div class="container-fluid footer-logos">
    <div class="container-xl">
      <div class="row d-flex flex-wrap align-items-center">
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="NCAR" src="../../_images/NSF-NCAR_Lockup-UCAR-Dark_102523.svg" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="Unidata" src="../../_images/Unidata_logo_horizontal_1200x300.svg" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="UAlbany" src="../../_images/UAlbany-A2-logo-purple-gold.svg" style="width: 100%">
        </div>
      </div>
    </div>
  </div></div>
      
        <div class="footer-item">  <div class="container-fluid footer-info">
    <div class="container-xl">
      <div class="d-flex justify-content-center">
        <p class="py-1 m-0">
            &copy;&nbsp;2024.
        
          By Ryan Abernathey, Henri Drake, Robert Ford.
        
          Last updated on 24 May 2024.
        </p>
      </div>
    </div>
  </div></div>
      
        <div class="footer-item"><div class="container-fluid footer-extra">
    <div class="container">
      <center>
        Theme by <a href="https://projectpythia.org">Project Pythia</a>. All code
        in Pythia Cookbooks is licensed under
        <a href="https://opensource.org/license/apache-2-0">Apache 2.0</a>. All
        other non-code content is licensed under
        <a href="https://creativecommons.org/licenses/by/4.0/">
          Creative Commons BY 4.0 (CC BY 4.0)</a
        >.
      </center>
      <br /><br />
      <div class="row">
        <p class="m-0">
          <img
            src="../../_static/footer-logo-nsf.png"
            style="float: left; width: 60px; height: 60px; margin-right: 1rem"
          />
          This material is based upon work supported by the National Science
          Foundation under Grant Nos. 2026863 and 2026899. Any opinions, findings,
          and conclusions or recommendations expressed in this material are those
          of the author(s) and do not necessarily reflect the views of the
          National Science Foundation.
        </p>
      </div>
    </div>
  </div></div>
      
      </div>
    </div>
  

  </footer>
  </body>
</html>