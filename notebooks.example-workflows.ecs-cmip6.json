{"version":2,"kind":"Notebook","sha256":"d942cfe025ad0a0ed33dc31bb71d7f600910ebdc3e9e282ccc5ccfcba9136361","slug":"notebooks.example-workflows.ecs-cmip6","location":"/notebooks/example-workflows/ecs-cmip6.ipynb","dependencies":[],"frontmatter":{"title":"Estimating Equilibrium Climate Sensitivity","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"authors":[{"nameParsed":{"literal":"Ryan Abernathey","given":"Ryan","family":"Abernathey"},"name":"Ryan Abernathey","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Henri Drake","given":"Henri","family":"Drake"},"name":"Henri Drake","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Robert Ford","given":"Robert","family":"Ford"},"name":"Robert Ford","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Max Grover","given":"Max","family":"Grover"},"name":"Max Grover","id":"contributors-myst-generated-uid-3"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/projectpythia/cmip6-cookbook","copyright":"2024","affiliations":[{"id":"University at Albany (State University of New York)","name":"University at Albany (State University of New York)"},{"id":"UCAR/NCAR","name":"UCAR/NCAR"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/cmip6-cookbook/blob/main/notebooks/example-workflows/ecs-cmip6.ipynb","exports":[{"format":"ipynb","filename":"ecs-cmip6.ipynb","url":"/cmip6-cookbook/build/ecs-cmip6-ae74f376cd3e3b870ddabbb8275b0cf6.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cwEptgZ1dv"}],"key":"Gl53G5Kce4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lLpuAFA0Fw"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"zePQdGsleJ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Equilibrium Climate Sensitivity (ECS) is defined as change in global-mean near-surface air temperature (GMST) change due to an instantaneous doubling of CO","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"alb7UVbEgK"},{"type":"inlineMath","value":"_2","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow></mrow><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4511em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"GiprfKAosj"},{"type":"text","value":" concentrations and once the coupled ocean-atmosphere-sea ice system has acheived a statistical equilibrium (i.e. at the top-of-atmosphere, incoming solar shortwave radiation is balanced by reflected solar shortwave and outgoing thermal longwave radiation).","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"p4smfkBGas"}],"key":"ZTqXPXiNON"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This notebook uses the “","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"zhQI23ehWd"},{"type":"cite","url":"https://doi.org/10.1029/2003GL018747","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Gregory method","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uBpZX9DAXM"}],"kind":"narrative","label":"Gregory_2004","identifier":"https://doi.org/10.1029/2003GL018747","enumerator":"1","key":"UOJSIYFOVJ"},{"type":"text","value":"” to approximate the ECS of CMIP6 models based on the first 150 years after an abrupt doubling of CO","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XOlCKRyg3l"},{"type":"inlineMath","value":"_2","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow></mrow><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4511em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"tgjwbYlfik"},{"type":"text","value":"\nconcentrations. The Gregory method extrapolates the quasi-linear relationship between GMST and radiative imbalance at the top-of-atmosphere to estimate how much warming would occur if the system were in radiative balance at the top-of-atmosphere, which is by definition the equilibrium response. In particular, we extrapolate the linear relationship that occurs between 100 and 150 years after the abrupt quadrupling.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"qQr3eHTtLZ"}],"key":"OAPx34Gy2U"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Since the radiative forcing due to CO","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"DEzmcvsWS2"},{"type":"inlineMath","value":"_2","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow></mrow><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4511em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"Q2s8MH8OM3"},{"type":"text","value":" is a logarithmic function of the CO","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"eeFSX21Tl8"},{"type":"inlineMath","value":"_2","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow></mrow><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4511em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"rwTO031SFw"},{"type":"text","value":" concentration, the GMST change from a first doubling is roughly the same as for a second doubling (to first order, we can assume feedbacks as constant), which means that the GMST change due to a quadrupling of CO","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"cfW3q7pvG6"},{"type":"inlineMath","value":"_2","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow></mrow><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4511em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"LtDcE1TNsc"},{"type":"text","value":" is roughly ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"lO7jKnYwlc"},{"type":"inlineMath","value":"\\Delta T_{4\\times\\mathrm{CO}_2}=2\\times\\mathrm{ECS}","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><msub><mi>T</mi><mrow><mn>4</mn><mo>×</mo><msub><mrow><mi mathvariant=\"normal\">C</mi><mi mathvariant=\"normal\">O</mi></mrow><mn>2</mn></msub></mrow></msub><mo>=</mo><mn>2</mn><mo>×</mo><mrow><mi mathvariant=\"normal\">E</mi><mi mathvariant=\"normal\">C</mi><mi mathvariant=\"normal\">S</mi></mrow></mrow><annotation encoding=\"application/x-tex\">\\Delta T_{4\\times\\mathrm{CO}_2}=2\\times\\mathrm{ECS}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9334em;vertical-align:-0.2501em;\"></span><span class=\"mord\">Δ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">T</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">4</span><span class=\"mbin mtight\">×</span><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mord mathrm mtight\">CO</span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3173em;\"><span style=\"top:-2.357em;margin-right:0.0714em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.143em;\"><span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2501em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">×</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\"><span class=\"mord mathrm\">ECS</span></span></span></span></span>","key":"iKe80XtWCT"},{"type":"text","value":". See also ","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"cQebzH3K4c"},{"type":"cite","url":"https://doi.org/10.1029/2018MS001400","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Mauritsen et al. 2019","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"JVmiq4YFzl"}],"kind":"narrative","label":"Mauritsen_2019","identifier":"https://doi.org/10.1029/2018MS001400","enumerator":"2","key":"sjuMHbreTm"},{"type":"text","value":" for a detailed application of the Gregory method (with modifications) for the case of one specific CMIP6 model, the MPI-M Earth System Model.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"fgHxNbKiJM"}],"key":"eYLDdoMNr0"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"For another take on applying the Gregory method to estimate ECS, see ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"VpqXfCpFOn"},{"type":"link","url":"https://github.com/apendergrass/cmip6-ecs","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Angeline Pendergrass’ code","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"DFBR8wx6Rx"}],"urlSource":"https://github.com/apendergrass/cmip6-ecs","error":true,"key":"lcG5xYfjlN"},{"type":"text","value":".","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"d8hFWSLlgo"}],"key":"drVMgvZNE9"}],"key":"c5KmBOzthJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VwH5sXotmk"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"x4Bcg5Jy3f"},{"type":"table","position":{"start":{"line":3,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Concepts","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"rjsIJwwpR4"}],"key":"nqK6y3j5Pa"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Importance","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IJ38mowZQ4"}],"key":"i9wW44WtDw"},{"type":"tableCell","header":true,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Notes","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QRIyEOW9WH"}],"key":"bB43DGBVFg"}],"key":"qeBGurOEIw"},{"type":"tableRow","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/xarray/xarray-intro.html","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Intro to Xarray","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"nTyAvzgig9"}],"urlSource":"https://foundations.projectpythia.org/core/xarray/xarray-intro.html","key":"Y8vGv5IDj7"}],"key":"uflFoH9UPk"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Necessary","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"EDiIsnE2A9"}],"key":"ePpsUq8S2H"},{"type":"tableCell","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[],"key":"x24iES88Xl"}],"key":"VLGjpYM7G1"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://foundations.projectpythia.org/core/data-formats/netcdf-cf.html","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Understanding of NetCDF","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"fKbiXBiCzd"}],"urlSource":"https://foundations.projectpythia.org/core/data-formats/netcdf-cf.html","key":"ktgePPeJnU"}],"key":"vJq7VEs0Vl"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"c4zjMpiB39"}],"key":"vFC3tiEXRY"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Familiarity with metadata structure","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"EsguC80NBg"}],"key":"VORvGoDmZx"}],"key":"cp6cmsIOWU"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Dask","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"tXOuKUWrca"}],"key":"LTs6DtDXKf"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"rLL2PMyIE7"}],"key":"ZiWr59xPy9"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[],"key":"ua18qL0wPe"}],"key":"gAeQOGLRxv"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Climate sensitivity","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"xiVDAsCnjW"}],"key":"j6SerFTjaS"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Helpful","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"c6tYhkPsUc"}],"key":"HT7J435Obv"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[],"key":"M1yUmM7Hdg"}],"key":"DPD5cRYpZW"}],"key":"m7xcLtHCno"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Time to learn","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"kiOp2O6pDH"}],"key":"UASTAOWJD1"},{"type":"text","value":": 30 minutes","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"SBVZALucx2"}],"key":"oqxBupmJEg"}],"key":"FrNimhtlxU"}],"key":"pTG0owG4EK"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ypn3TaUwm5"}],"key":"P2xZs1ZESo"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Imports","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aquqjopGk9"}],"identifier":"imports","label":"Imports","html_id":"imports","implicit":true,"key":"muuVGvVgNE"}],"key":"h7XYnzTOHJ"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from matplotlib import pyplot as plt\nimport sys\nimport numpy as np\nimport pandas as pd\nimport xarray as xr\nimport cartopy\nimport dask\nfrom tqdm.autonotebook import tqdm  # Fancy progress bars for our loops!\nimport intake\nimport fsspec\nfrom dask_gateway import Gateway\nfrom dask.distributed import Client\n\n%matplotlib inline\nplt.rcParams['figure.figsize'] = 12, 6","visibility":"show","key":"myGnn3OsFF"},{"type":"output","id":"W2P6uNpCNlx_HCVGvVVoo","data":[{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1804016931.py:8: TqdmExperimentalWarning: Using `tqdm.autonotebook.tqdm` in notebook mode. Use `tqdm.tqdm` instead to force console mode (e.g. in jupyter console)\n  from tqdm.autonotebook import tqdm  # Fancy progress bars for our loops!\n"}],"visibility":"show","key":"OkmXA3wM7h"}],"visibility":"show","key":"rlHNZrARP2"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Compute Cluster","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kxJpRZDXtV"}],"identifier":"compute-cluster","label":"Compute Cluster","html_id":"compute-cluster","implicit":true,"key":"r82khLjiUZ"}],"visibility":"show","key":"FU0dKquxAN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we use a dask cluster to parallelize our analysis.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DGB7jO2j9l"}],"key":"eFZV13vkYY"}],"key":"wQuwinr7Ek"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"platform = sys.platform\n\nif (platform == 'win32'):\n    import multiprocessing.popen_spawn_win32\nelse:\n    import multiprocessing.popen_spawn_posix","visibility":"show","key":"b7KUVTLeAg"},{"type":"output","id":"IvEn5RCH5MZZ8lG50Yu4N","data":[],"visibility":"show","key":"SyHpf9qQDE"}],"visibility":"show","key":"YMKt3TBrSi"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Initiate the Dask client:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oiMG4qhIoI"}],"key":"G0bohDYL7e"}],"key":"VMKKYX8Wdl"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"client = Client()\nclient","visibility":"show","key":"GPtwe2C4LO"},{"type":"output","id":"6iQq_BCm7cq6fHOnnF29O","data":[{"output_type":"stream","name":"stderr","text":"/home/runner/micromamba/envs/cmip6-cookbook-dev/lib/python3.11/site-packages/distributed/node.py:187: UserWarning: Port 8787 is already in use.\nPerhaps you already have a cluster running?\nHosting the HTTP server on port 38685 instead\n  warnings.warn(\n"},{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/plain":{"content":"<Client: 'tcp://127.0.0.1:37083' processes=4 threads=4, memory=15.62 GiB>","content_type":"text/plain"},"text/html":{"content":"<div>\n    <div style=\"width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;\"> </div>\n    <div style=\"margin-left: 48px;\">\n        <h3 style=\"margin-bottom: 0px;\">Client</h3>\n        <p style=\"color: #9D9D9D; margin-bottom: 0px;\">Client-6bfabfcf-52fa-11f0-90a9-6045bd86c3ab</p>\n        <table style=\"width: 100%; text-align: left;\">\n\n        <tr>\n        \n            <td style=\"text-align: left;\"><strong>Connection method:</strong> Cluster object</td>\n            <td style=\"text-align: left;\"><strong>Cluster type:</strong> distributed.LocalCluster</td>\n        \n        </tr>\n\n        \n            <tr>\n                <td style=\"text-align: left;\">\n                    <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:38685/status\" target=\"_blank\">http://127.0.0.1:38685/status</a>\n                </td>\n                <td style=\"text-align: left;\"></td>\n            </tr>\n        \n\n        </table>\n\n        \n\n        \n            <details>\n            <summary style=\"margin-bottom: 20px;\"><h3 style=\"display: inline;\">Cluster Info</h3></summary>\n            <div class=\"jp-RenderedHTMLCommon jp-RenderedHTML jp-mod-trusted jp-OutputArea-output\">\n    <div style=\"width: 24px; height: 24px; background-color: #e1e1e1; border: 3px solid #9D9D9D; border-radius: 5px; position: absolute;\">\n    </div>\n    <div style=\"margin-left: 48px;\">\n        <h3 style=\"margin-bottom: 0px; margin-top: 0px;\">LocalCluster</h3>\n        <p style=\"color: #9D9D9D; margin-bottom: 0px;\">04534ec4</p>\n        <table style=\"width: 100%; text-align: left;\">\n            <tr>\n                <td style=\"text-align: left;\">\n                    <strong>Dashboard:</strong> <a href=\"http://127.0.0.1:38685/status\" target=\"_blank\">http://127.0.0.1:38685/status</a>\n                </td>\n                <td style=\"text-align: left;\">\n                    <strong>Workers:</strong> 4\n                </td>\n            </tr>\n            <tr>\n                <td style=\"text-align: left;\">\n                    <strong>Total threads:</strong> 4\n                </td>\n                <td style=\"text-align: left;\">\n                    <strong>Total memory:</strong> 15.62 GiB\n                </td>\n            </tr>\n            \n            <tr>\n    <td style=\"text-align: left;\"><strong>Status:</strong> running</td>\n    <td style=\"text-align: left;\"><strong>Using processes:</strong> True</td>\n</tr>\n\n            \n        </table>\n\n        <details>\n            <summary style=\"margin-bottom: 20px;\">\n                <h3 style=\"display: inline;\">Scheduler Info</h3>\n            </summary>\n\n            <div style=\"\">\n    <div>\n        <div style=\"width: 24px; height: 24px; background-color: #FFF7E5; border: 3px solid #FF6132; border-radius: 5px; position: absolute;\"> </div>\n        <div style=\"margin-left: 48px;\">\n            <h3 style=\"margin-bottom: 0px;\">Scheduler</h3>\n            <p style=\"color: #9D9D9D; margin-bottom: 0px;\">Scheduler-04285f68-f24e-4cc7-80ed-de2ae5c579a2</p>\n            <table style=\"width: 100%; text-align: left;\">\n                <tr>\n                    <td style=\"text-align: left;\">\n                        <strong>Comm:</strong> tcp://127.0.0.1:37083\n                    </td>\n                    <td style=\"text-align: left;\">\n                        <strong>Workers:</strong> 0 \n                    </td>\n                </tr>\n                <tr>\n                    <td style=\"text-align: left;\">\n                        <strong>Dashboard:</strong> <a href=\"http://127.0.0.1:38685/status\" target=\"_blank\">http://127.0.0.1:38685/status</a>\n                    </td>\n                    <td style=\"text-align: left;\">\n                        <strong>Total threads:</strong> 0\n                    </td>\n                </tr>\n                <tr>\n                    <td style=\"text-align: left;\">\n                        <strong>Started:</strong> Just now\n                    </td>\n                    <td style=\"text-align: left;\">\n                        <strong>Total memory:</strong> 0 B\n                    </td>\n                </tr>\n            </table>\n        </div>\n    </div>\n\n    <details style=\"margin-left: 48px;\">\n        <summary style=\"margin-bottom: 20px;\">\n            <h3 style=\"display: inline;\">Workers</h3>\n        </summary>\n\n        \n        <div style=\"margin-bottom: 20px;\">\n            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n            <div style=\"margin-left: 48px;\">\n            <details>\n                <summary>\n                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 0</h4>\n                </summary>\n                <table style=\"width: 100%; text-align: left;\">\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Comm: </strong> tcp://127.0.0.1:43681\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Total threads: </strong> 1\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:40183/status\" target=\"_blank\">http://127.0.0.1:40183/status</a>\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Memory: </strong> 3.91 GiB\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Nanny: </strong> tcp://127.0.0.1:39771\n                        </td>\n                        <td style=\"text-align: left;\"></td>\n                    </tr>\n                    <tr>\n                        <td colspan=\"2\" style=\"text-align: left;\">\n                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-2c_map8g\n                        </td>\n                    </tr>\n\n                    \n\n                    \n\n                </table>\n            </details>\n            </div>\n        </div>\n        \n        <div style=\"margin-bottom: 20px;\">\n            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n            <div style=\"margin-left: 48px;\">\n            <details>\n                <summary>\n                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 1</h4>\n                </summary>\n                <table style=\"width: 100%; text-align: left;\">\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Comm: </strong> tcp://127.0.0.1:46811\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Total threads: </strong> 1\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:34753/status\" target=\"_blank\">http://127.0.0.1:34753/status</a>\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Memory: </strong> 3.91 GiB\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Nanny: </strong> tcp://127.0.0.1:45557\n                        </td>\n                        <td style=\"text-align: left;\"></td>\n                    </tr>\n                    <tr>\n                        <td colspan=\"2\" style=\"text-align: left;\">\n                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-w8mfeihq\n                        </td>\n                    </tr>\n\n                    \n\n                    \n\n                </table>\n            </details>\n            </div>\n        </div>\n        \n        <div style=\"margin-bottom: 20px;\">\n            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n            <div style=\"margin-left: 48px;\">\n            <details>\n                <summary>\n                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 2</h4>\n                </summary>\n                <table style=\"width: 100%; text-align: left;\">\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Comm: </strong> tcp://127.0.0.1:41733\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Total threads: </strong> 1\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:34963/status\" target=\"_blank\">http://127.0.0.1:34963/status</a>\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Memory: </strong> 3.91 GiB\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Nanny: </strong> tcp://127.0.0.1:36519\n                        </td>\n                        <td style=\"text-align: left;\"></td>\n                    </tr>\n                    <tr>\n                        <td colspan=\"2\" style=\"text-align: left;\">\n                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-gcd1spkl\n                        </td>\n                    </tr>\n\n                    \n\n                    \n\n                </table>\n            </details>\n            </div>\n        </div>\n        \n        <div style=\"margin-bottom: 20px;\">\n            <div style=\"width: 24px; height: 24px; background-color: #DBF5FF; border: 3px solid #4CC9FF; border-radius: 5px; position: absolute;\"> </div>\n            <div style=\"margin-left: 48px;\">\n            <details>\n                <summary>\n                    <h4 style=\"margin-bottom: 0px; display: inline;\">Worker: 3</h4>\n                </summary>\n                <table style=\"width: 100%; text-align: left;\">\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Comm: </strong> tcp://127.0.0.1:38769\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Total threads: </strong> 1\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Dashboard: </strong> <a href=\"http://127.0.0.1:42091/status\" target=\"_blank\">http://127.0.0.1:42091/status</a>\n                        </td>\n                        <td style=\"text-align: left;\">\n                            <strong>Memory: </strong> 3.91 GiB\n                        </td>\n                    </tr>\n                    <tr>\n                        <td style=\"text-align: left;\">\n                            <strong>Nanny: </strong> tcp://127.0.0.1:39125\n                        </td>\n                        <td style=\"text-align: left;\"></td>\n                    </tr>\n                    <tr>\n                        <td colspan=\"2\" style=\"text-align: left;\">\n                            <strong>Local directory: </strong> /tmp/dask-scratch-space/worker-8ff7xenw\n                        </td>\n                    </tr>\n\n                    \n\n                    \n\n                </table>\n            </details>\n            </div>\n        </div>\n        \n\n    </details>\n</div>\n\n        </details>\n    </div>\n</div>\n            </details>\n        \n\n    </div>\n</div>","content_type":"text/html"}}}],"visibility":"show","key":"O5EjYaxYFn"}],"visibility":"show","key":"jLtqmZEqCQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data catalogs","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CpT9ALStZt"}],"identifier":"data-catalogs","label":"Data catalogs","html_id":"data-catalogs","implicit":true,"key":"vpqNoCBk5G"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"This notebook uses ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"tcpAhbb0dg"},{"type":"link","url":"https://intake-esm.readthedocs.io/en/latest/","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"inlineCode","value":"intake-esm","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"tsrleRHCGN"}],"urlSource":"https://intake-esm.readthedocs.io/en/latest/","key":"uE8ZdGWtRy"},{"type":"text","value":" to ingest and organize climate model output from the fresh-off-the-supercomputers Phase 6 of the Coupled Model Intercomparison Project (CMIP6).","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"LUG1rz3w7y"}],"key":"aa8Q4Zlgqx"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"The file ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"AM6tJM2KTR"},{"type":"inlineCode","value":"https://storage.googleapis.com/cmip6/cmip6-zarr-consolidated-stores.csv","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"l4P47LrW6D"},{"type":"text","value":" in Google Cloud Storage contains thousands of lines of metadata, each describing an individual climate model experiment’s simulated data.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"c5T5zsXejK"}],"key":"HkDXR3ofWe"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"For example, the first line in the ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"V5QCeLkmUR"},{"type":"inlineCode","value":".csv","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"azXwG8LC4V"},{"type":"text","value":" file contains the precipitation rate (","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"opmrhMO3fx"},{"type":"inlineCode","value":"variable_id = 'pr'","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"svzx0DCuO3"},{"type":"text","value":"), as a function of latitude, longitude, and time, in an individual climate model experiment with the BCC-ESM1 model (","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"bkOuSgaolL"},{"type":"inlineCode","value":"source_id = 'BCC-ESM1'","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"bnhq6vgfDD"},{"type":"text","value":") developed by the Beijing Climate Center (","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"ysFKZGC3Rj"},{"type":"inlineCode","value":"institution_id = 'BCC'","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"AeO54D77e7"},{"type":"text","value":"). The model is forced by the forcing experiment SSP370 (","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jkayqWGO0D"},{"type":"inlineCode","value":"experiment_id = 'ssp370'","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Dr7wRargnP"},{"type":"text","value":"), which stands for the Shared Socio-Economic Pathway 3 that results in a change in radiative forcing of ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"P10VXLmwdL"},{"type":"inlineMath","value":"\\Delta F=7.0","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">Δ</mi><mi>F</mi><mo>=</mo><mn>7.0</mn></mrow><annotation encoding=\"application/x-tex\">\\Delta F=7.0</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">Δ</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">F</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">7.0</span></span></span></span>","key":"y8LuE6XpMX"},{"type":"text","value":" W m","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"R6wnJsyFHh"},{"type":"inlineMath","value":"^{-2}","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mrow></mrow><mrow><mo>−</mo><mn>2</mn></mrow></msup></mrow><annotation encoding=\"application/x-tex\">^{-2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span>","key":"hKOCMHbxY9"},{"type":"text","value":" from pre-industrial to 2100. This simulation was run as part of the ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"PHg2D3n3iP"},{"type":"inlineCode","value":"AerChemMIP","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"WFpzlP9Cra"},{"type":"text","value":" activity, which is a spin-off of the CMIP activity that focuses specifically on how aerosol chemistry affects climate.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"gRAaVlvalZ"}],"key":"LPKBpUqWHC"}],"key":"LwEdjxyRdl"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"df = pd.read_csv('https://storage.googleapis.com/cmip6/cmip6-zarr-consolidated-stores.csv')\ndf.head()","visibility":"show","key":"yOw48upn1N"},{"type":"output","id":"rg7ilCIeadB9RB50iYhwo","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/plain":{"content":"  activity_id institution_id     source_id       experiment_id member_id  \\\n0  HighResMIP           CMCC  CMCC-CM2-HR4  highresSST-present  r1i1p1f1   \n1  HighResMIP           CMCC  CMCC-CM2-HR4  highresSST-present  r1i1p1f1   \n2  HighResMIP           CMCC  CMCC-CM2-HR4  highresSST-present  r1i1p1f1   \n3  HighResMIP           CMCC  CMCC-CM2-HR4  highresSST-present  r1i1p1f1   \n4  HighResMIP           CMCC  CMCC-CM2-HR4  highresSST-present  r1i1p1f1   \n\n  table_id variable_id grid_label  \\\n0     Amon          ps         gn   \n1     Amon        rsds         gn   \n2     Amon        rlus         gn   \n3     Amon        rlds         gn   \n4     Amon         psl         gn   \n\n                                              zstore  dcpp_init_year   version  \n0  gs://cmip6/CMIP6/HighResMIP/CMCC/CMCC-CM2-HR4/...             NaN  20170706  \n1  gs://cmip6/CMIP6/HighResMIP/CMCC/CMCC-CM2-HR4/...             NaN  20170706  \n2  gs://cmip6/CMIP6/HighResMIP/CMCC/CMCC-CM2-HR4/...             NaN  20170706  \n3  gs://cmip6/CMIP6/HighResMIP/CMCC/CMCC-CM2-HR4/...             NaN  20170706  \n4  gs://cmip6/CMIP6/HighResMIP/CMCC/CMCC-CM2-HR4/...             NaN  20170706  ","content_type":"text/plain"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>activity_id</th>\n      <th>institution_id</th>\n      <th>source_id</th>\n      <th>experiment_id</th>\n      <th>member_id</th>\n      <th>table_id</th>\n      <th>variable_id</th>\n      <th>grid_label</th>\n      <th>zstore</th>\n      <th>dcpp_init_year</th>\n      <th>version</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>HighResMIP</td>\n      <td>CMCC</td>\n      <td>CMCC-CM2-HR4</td>\n      <td>highresSST-present</td>\n      <td>r1i1p1f1</td>\n      <td>Amon</td>\n      <td>ps</td>\n      <td>gn</td>\n      <td>gs://cmip6/CMIP6/HighResMIP/CMCC/CMCC-CM2-HR4/...</td>\n      <td>NaN</td>\n      <td>20170706</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>HighResMIP</td>\n      <td>CMCC</td>\n      <td>CMCC-CM2-HR4</td>\n      <td>highresSST-present</td>\n      <td>r1i1p1f1</td>\n      <td>Amon</td>\n      <td>rsds</td>\n      <td>gn</td>\n      <td>gs://cmip6/CMIP6/HighResMIP/CMCC/CMCC-CM2-HR4/...</td>\n      <td>NaN</td>\n      <td>20170706</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>HighResMIP</td>\n      <td>CMCC</td>\n      <td>CMCC-CM2-HR4</td>\n      <td>highresSST-present</td>\n      <td>r1i1p1f1</td>\n      <td>Amon</td>\n      <td>rlus</td>\n      <td>gn</td>\n      <td>gs://cmip6/CMIP6/HighResMIP/CMCC/CMCC-CM2-HR4/...</td>\n      <td>NaN</td>\n      <td>20170706</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>HighResMIP</td>\n      <td>CMCC</td>\n      <td>CMCC-CM2-HR4</td>\n      <td>highresSST-present</td>\n      <td>r1i1p1f1</td>\n      <td>Amon</td>\n      <td>rlds</td>\n      <td>gn</td>\n      <td>gs://cmip6/CMIP6/HighResMIP/CMCC/CMCC-CM2-HR4/...</td>\n      <td>NaN</td>\n      <td>20170706</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>HighResMIP</td>\n      <td>CMCC</td>\n      <td>CMCC-CM2-HR4</td>\n      <td>highresSST-present</td>\n      <td>r1i1p1f1</td>\n      <td>Amon</td>\n      <td>psl</td>\n      <td>gn</td>\n      <td>gs://cmip6/CMIP6/HighResMIP/CMCC/CMCC-CM2-HR4/...</td>\n      <td>NaN</td>\n      <td>20170706</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"}}}],"visibility":"show","key":"DaeZgFGOuK"}],"visibility":"show","key":"kYttOI3rdM"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The file ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"noJMpeHWXb"},{"type":"inlineCode","value":"pangeo-cmip6.json","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nX4zinX9nU"},{"type":"text","value":" describes the structure of the CMIP6 metadata and is formatted so as to be read in by the ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gqBWPPq9xU"},{"type":"inlineCode","value":"intake.open_esm_datastore","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iOC7Ijvl1X"},{"type":"text","value":" method, which categorizes all of the data pointers into a tiered collection. For example, this collection contains the simulated data from 28691 individual experiments, representing 48 different models from 23 different scientific institutions. There are 190 different climate variables (e.g. sea surface temperature, sea ice concentration, atmospheric winds, dissolved organic carbon in the ocean, etc.) available for 29 different forcing experiments.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mrrrBiDnZz"}],"key":"gW08d5uP1P"}],"key":"pLBcbJQw8x"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Use Intake-ESM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kKZeMkFuig"}],"identifier":"use-intake-esm","label":"Use Intake-ESM","html_id":"use-intake-esm","implicit":true,"key":"ZgvspedHoU"}],"visibility":"show","key":"cp9FS4solv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"link","url":"https://intake-esm.readthedocs.io/en/stable/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Intake-ESM","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"md1AlzVdXf"}],"urlSource":"https://intake-esm.readthedocs.io/en/stable/","key":"Wl5VBXqA6h"},{"type":"text","value":" is a new package designed to make working with these data archives a bit simpler.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SFZSmtx5xA"}],"key":"pZcqLM6Kc3"}],"key":"MIbqyex39Y"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"col = intake.open_esm_datastore(\"https://storage.googleapis.com/cmip6/pangeo-cmip6.json\")\ncol","visibility":"show","key":"EYsjwyQksK"},{"type":"output","id":"kovY2tbVoCu0LzmUYu2dQ","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<IPython.core.display.HTML object>","content_type":"text/plain"},"text/html":{"content":"<p><strong>pangeo-cmip6 catalog with 7674 dataset(s) from 514818 asset(s)</strong>:</p> <div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>unique</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>activity_id</th>\n      <td>18</td>\n    </tr>\n    <tr>\n      <th>institution_id</th>\n      <td>36</td>\n    </tr>\n    <tr>\n      <th>source_id</th>\n      <td>88</td>\n    </tr>\n    <tr>\n      <th>experiment_id</th>\n      <td>170</td>\n    </tr>\n    <tr>\n      <th>member_id</th>\n      <td>657</td>\n    </tr>\n    <tr>\n      <th>table_id</th>\n      <td>37</td>\n    </tr>\n    <tr>\n      <th>variable_id</th>\n      <td>700</td>\n    </tr>\n    <tr>\n      <th>grid_label</th>\n      <td>10</td>\n    </tr>\n    <tr>\n      <th>zstore</th>\n      <td>514818</td>\n    </tr>\n    <tr>\n      <th>dcpp_init_year</th>\n      <td>60</td>\n    </tr>\n    <tr>\n      <th>version</th>\n      <td>736</td>\n    </tr>\n    <tr>\n      <th>derived_variable_id</th>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"}}}],"visibility":"show","key":"K0b0m63cRW"}],"visibility":"show","key":"ncU1ym8TCR"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here, we show the various forcing experiments that climate modellers ran in these simulations.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JLDcJXaD02"}],"key":"KLiai3ieXZ"}],"key":"Ed58x76EEU"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"df['experiment_id'].unique()","visibility":"show","key":"WLDX9PwSfT"},{"type":"output","id":"reJfH2wbNGA70sRbGvNcu","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"array(['highresSST-present', 'piControl', 'control-1950', 'hist-1950',\n       'historical', 'amip', 'abrupt-4xCO2', 'abrupt-2xCO2',\n       'abrupt-0p5xCO2', '1pctCO2', 'ssp585', 'esm-piControl', 'esm-hist',\n       'hist-piAer', 'histSST-1950HC', 'ssp245', 'hist-1950HC', 'histSST',\n       'piClim-2xVOC', 'piClim-2xNOx', 'piClim-2xdust', 'piClim-2xss',\n       'piClim-histall', 'hist-piNTCF', 'histSST-piNTCF',\n       'aqua-control-lwoff', 'piClim-lu', 'histSST-piO3', 'piClim-CH4',\n       'piClim-NTCF', 'piClim-NOx', 'piClim-O3', 'piClim-HC',\n       'faf-heat-NA0pct', 'ssp370SST-lowCH4', 'piClim-VOC',\n       'ssp370-lowNTCF', 'piClim-control', 'piClim-aer', 'hist-aer',\n       'faf-heat', 'faf-heat-NA50pct', 'ssp370SST-lowNTCF',\n       'ssp370SST-ssp126Lu', 'ssp370SST', 'ssp370pdSST', 'histSST-piAer',\n       'piClim-ghg', 'piClim-anthro', 'faf-all', 'hist-nat', 'hist-GHG',\n       'ssp119', 'piClim-histnat', 'piClim-4xCO2', 'ssp370',\n       'piClim-histghg', 'highresSST-future', 'esm-ssp585-ssp126Lu',\n       'ssp126-ssp370Lu', 'ssp370-ssp126Lu', 'land-noLu', 'histSST-piCH4',\n       'ssp126', 'esm-pi-CO2pulse', 'amip-hist', 'piClim-histaer',\n       'amip-4xCO2', 'faf-water', 'faf-passiveheat', '1pctCO2-rad',\n       'faf-stress', '1pctCO2-bgc', 'aqua-control', 'amip-future4K',\n       'amip-p4K', 'aqua-p4K', 'amip-lwoff', 'amip-m4K', 'aqua-4xCO2',\n       'amip-p4K-lwoff', 'hist-noLu', '1pctCO2-cdr',\n       'land-hist-altStartYear', 'land-hist', 'omip1', 'esm-pi-cdr-pulse',\n       'esm-ssp585', 'abrupt-solp4p', 'piControl-spinup', 'hist-stratO3',\n       'abrupt-solm4p', 'midHolocene', 'lig127k', 'aqua-p4K-lwoff',\n       'esm-piControl-spinup', 'ssp245-GHG', 'ssp245-nat',\n       'dcppC-amv-neg', 'dcppC-amv-ExTrop-neg', 'dcppC-atl-control',\n       'dcppC-amv-pos', 'dcppC-ipv-NexTrop-neg', 'dcppC-ipv-NexTrop-pos',\n       'dcppC-atl-pacemaker', 'dcppC-amv-ExTrop-pos',\n       'dcppC-amv-Trop-neg', 'dcppC-pac-control', 'dcppC-ipv-pos',\n       'dcppC-pac-pacemaker', 'dcppC-ipv-neg', 'dcppC-amv-Trop-pos',\n       'piClim-BC', 'piClim-2xfire', 'piClim-SO2', 'piClim-OC',\n       'piClim-N2O', 'piClim-2xDMS', 'ssp460', 'ssp434', 'ssp534-over',\n       'deforest-globe', 'historical-cmip5', 'hist-bgc',\n       'piControl-cmip5', 'rcp26-cmip5', 'rcp45-cmip5', 'rcp85-cmip5',\n       'pdSST-piArcSIC', 'pdSST-piAntSIC', 'piSST-piSIC', 'piSST-pdSIC',\n       'ssp245-stratO3', 'hist-sol', 'hist-CO2', 'hist-volc',\n       'hist-totalO3', 'hist-nat-cmip5', 'hist-aer-cmip5',\n       'hist-GHG-cmip5', 'pdSST-futAntSIC', 'futSST-pdSIC', 'pdSST-pdSIC',\n       'ssp245-aer', 'pdSST-futArcSIC', 'dcppA-hindcast', 'dcppA-assim',\n       'dcppC-hindcast-noPinatubo', 'dcppC-hindcast-noElChichon',\n       'dcppC-hindcast-noAgung', 'hist-resIPO', 'ssp245-cov-modgreen',\n       'ssp245-cov-fossil', 'ssp245-cov-strgreen', 'ssp245-covid', 'lgm',\n       'ssp585-bgc', '1pctCO2to4x-withism', '1pctCO2-4xext', 'past1000',\n       'pa-futArcSIC', 'pa-pdSIC', 'historical-ext', 'pdSST-futArcSICSIT',\n       'pdSST-futOkhotskSIC', 'pdSST-futBKSeasSIC', 'pa-piArcSIC',\n       'pa-piAntSIC', 'pa-futAntSIC', 'pdSST-pdSICSIT'], dtype=object)","content_type":"text/plain"}}}],"visibility":"show","key":"lg1ORGRWym"}],"visibility":"show","key":"U2WyOnI1CX"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Loading Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UIugQNaa3V"}],"identifier":"loading-data","label":"Loading Data","html_id":"loading-data","implicit":true,"key":"l2n0qQLw2i"}],"visibility":"show","key":"EnNDgu3ZIF"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Intake-ESM enables loading data directly into an ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Tqh7iMzQqa"},{"type":"inlineCode","value":"xarray.DataArray","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"j0lXHoHE7d"},{"type":"text","value":", a metadata-aware extension of numpy arrays. Xarray objects leverage ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UcDVsWVHp3"},{"type":"link","url":"https://www.dask.org/","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Dask","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"madrcu0CRm"}],"urlSource":"https://www.dask.org/","key":"iyC0ExRpvo"},{"type":"text","value":" to only read data into memory as needed for any specific operation (i.e. lazy evaluation). Think of Xarray Datasets as ways of conveniently organizing large arrays of floating point numbers (e.g. climate model data) on an n-dimensional discrete grid, with important metadata such as units, variable, names, etc.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RAXl0GQ9gA"}],"key":"lauWRD51pS"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Note that data on the cloud are in ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"r5OHY6W7WZ"},{"type":"link","url":"https://zarr.readthedocs.io/en/stable/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Zarr","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IUaSdZWU1E"}],"urlSource":"https://zarr.readthedocs.io/en/stable/","key":"asnsHVfX73"},{"type":"text","value":" format, an extension of the metadata-aware format ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uQpDBwJLHB"},{"type":"link","url":"https://www.unidata.ucar.edu/software/netcdf/","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"NetCDF","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ywy6NkmW9v"}],"urlSource":"https://www.unidata.ucar.edu/software/netcdf/","key":"rRbQKZEjiG"},{"type":"text","value":" commonly used in the geosciences.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YZ8nkjoAl5"}],"key":"bT1QpXnsFc"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Intake-ESM has rules for aggegating datasets; these rules are defined in the collection-specification file.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Bxnf7nO19d"}],"key":"w6SzdTXJ22"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Here, we choose the ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"eWGXfT2URY"},{"type":"inlineCode","value":"piControl","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"m6Frc5tsCG"},{"type":"text","value":" experiment (in which CO","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"U8ayL8Jnql"},{"type":"inlineMath","value":"_2","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow></mrow><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4511em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"LTnvDRt9WZ"},{"type":"text","value":" concentrations are held fixed at a pre-industrial level of ~300 ppm) and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"d9aLxzTwM8"},{"type":"inlineCode","value":"abrupt-2xCO2","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"zFhJ91cQ8t"},{"type":"text","value":" experiment (in which CO","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Mgalbt0vcu"},{"type":"inlineMath","value":"_2","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow></mrow><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4511em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"GRIJQRROJx"},{"type":"text","value":" concentrations are instantaneously doubled from a pre-industrial control state). Since the radiative forcing of CO","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"eXHXlHyRcq"},{"type":"inlineMath","value":"_2","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow></mrow><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4511em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"lGNxvKYnDs"},{"type":"text","value":" is roughly a logarithmic function of CO","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"wPEVz66LeM"},{"type":"inlineMath","value":"_2","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow></mrow><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4511em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"PnWc83XKeM"},{"type":"text","value":" concentrations, the ECS is roughly independent of the initial CO","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Ijmek5dBIA"},{"type":"inlineMath","value":"_2","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mrow></mrow><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">_2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4511em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span>","key":"YJ1uusFbuP"},{"type":"text","value":" concentration.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"bFUVpvGR8M"}],"key":"sB4bpLhj3S"},{"type":"div","class":"admonition alert alert-warning","children":[{"type":"paragraph","children":[{"type":"text","value":"Warning","key":"qf7nkM6qev"}],"key":"Gb6XijaRen"},{"type":"text","value":"The version of this notebook in the ","key":"FOHC6XLhRQ"},{"type":"link","url":"http://gallery.pangeo.io/repos/pangeo-gallery/cmip6/","children":[{"type":"text","value":"Pangeo Gallery","key":"o9SvGoWfZj"}],"urlSource":"http://gallery.pangeo.io/repos/pangeo-gallery/cmip6/","key":"pqsAMJzng3"},{"type":"text","value":" uses the ","key":"dPqRJqWe8X"},{"type":"inlineCode","value":"abrupt-4xCO2","key":"qLfm8AdfbQ"},{"type":"text","value":" forcing experiment, but fewer ","key":"KqwsyUw0A7"},{"type":"inlineCode","value":"abrupt-2xCO2","key":"eq84DnzWRV"},{"type":"text","value":" datasets are currently avaiable in Google Cloud Storage, which significantly reduces run time. If you want to run this notebook on your own computer with the ","key":"q2sDFBPeWb"},{"type":"inlineCode","value":"abrupt-4xCO2","key":"Bl4pwukCP0"},{"type":"text","value":" experiment instead, change ","key":"oqtqoDQNty"},{"type":"inlineCode","value":"co2_option","key":"yrFzl5gJpq"},{"type":"text","value":" in the cell below. You will also need to take half of ","key":"Ohtqmle4NZ"},{"type":"inlineCode","value":"ecs","key":"FIEhUzLutU"},{"type":"text","value":", as described in the Overview.","key":"AppuM4KvsC"}],"key":"Xbmjg2aZQA"}],"key":"VroZbMgFOh"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"co2_option = 'abrupt-2xCO2'","visibility":"show","key":"H9JjpQ2qDx"},{"type":"output","id":"duD8dvFXbaLaHdu5QtJfe","data":[],"visibility":"show","key":"HMgKDMo84X"}],"visibility":"show","key":"vZrOvjSUng"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Prepare Data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"h7nlnOG5uu"}],"identifier":"prepare-data","label":"Prepare Data","html_id":"prepare-data","implicit":true,"key":"jg4wWTvsNr"}],"visibility":"show","key":"tDq5P27K1G"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"query = dict(\n    experiment_id=[co2_option,'piControl'], # pick the `abrupt-2xCO2` and `piControl` forcing experiments\n    table_id='Amon',                            # choose to look at atmospheric variables (A) saved at monthly resolution (mon)\n    variable_id=['tas', 'rsut','rsdt','rlut'],  # choose to look at near-surface air temperature (tas) as our variable\n    member_id = 'r1i1p1f1',                     # arbitrarily pick one realization for each model (i.e. just one set of initial conditions)\n)\n\ncol_subset = col.search(require_all_on=[\"source_id\"], **query)\ncol_subset.df.groupby(\"source_id\")[\n    [\"experiment_id\", \"variable_id\", \"table_id\"]\n].nunique()","visibility":"show","key":"X9ljh9IhmA"},{"type":"output","id":"7y2T0KCIS5sL6vvzRfQgH","data":[{"output_type":"execute_result","execution_count":8,"metadata":{},"data":{"text/plain":{"content":"              experiment_id  variable_id  table_id\nsource_id                                         \nCESM2                     2            4         1\nGISS-E2-1-G               2            4         1\nGISS-E2-1-H               2            4         1\nGISS-E2-2-G               2            4         1\nIPSL-CM6A-LR              2            4         1\nMIROC6                    2            4         1\nMRI-ESM2-0                2            4         1","content_type":"text/plain"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>experiment_id</th>\n      <th>variable_id</th>\n      <th>table_id</th>\n    </tr>\n    <tr>\n      <th>source_id</th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>CESM2</th>\n      <td>2</td>\n      <td>4</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>GISS-E2-1-G</th>\n      <td>2</td>\n      <td>4</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>GISS-E2-1-H</th>\n      <td>2</td>\n      <td>4</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>GISS-E2-2-G</th>\n      <td>2</td>\n      <td>4</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>IPSL-CM6A-LR</th>\n      <td>2</td>\n      <td>4</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>MIROC6</th>\n      <td>2</td>\n      <td>4</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>MRI-ESM2-0</th>\n      <td>2</td>\n      <td>4</td>\n      <td>1</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"}}}],"visibility":"show","key":"y1sWfz2SoH"}],"visibility":"show","key":"qEicqnXfM7"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The following functions help us load and homogenize the data. We use some ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JTNdu0FOcd"},{"type":"link","url":"https://docs.dask.org/en/latest/delayed.html","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"inlineCode","value":"dask.delayed","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TL0D9slODn"}],"urlSource":"https://docs.dask.org/en/latest/delayed.html","key":"wtZH0eKkGQ"},{"type":"text","value":" programming to open the datasets in parallel.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YLWsZFNBdX"}],"key":"Wrt9SBoZQi"}],"key":"FE0zHbgobX"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def drop_all_bounds(ds):\n    \"\"\"Drop coordinates like 'time_bounds' from datasets,\n    which can lead to issues when merging.\"\"\"\n    drop_vars = [vname for vname in ds.coords\n                 if (('_bounds') in vname ) or ('_bnds') in vname]\n    return ds.drop_vars(drop_vars)\n\ndef open_dsets(df):\n    \"\"\"Open datasets from cloud storage and return xarray dataset.\"\"\"\n    dsets = [xr.open_zarr(fsspec.get_mapper(ds_url), consolidated=True)\n             .pipe(drop_all_bounds)\n             for ds_url in df.zstore]\n    try:\n        ds = xr.merge(dsets, join='exact')\n        return ds\n    except ValueError:\n        return None\n\ndef open_delayed(df):\n    \"\"\"A dask.delayed wrapper around `open_dsets`.\n    Allows us to open many datasets in parallel.\"\"\"\n    return dask.delayed(open_dsets)(df)","visibility":"show","key":"qFMqmcNULJ"},{"type":"output","id":"0haS3q0fv9KtWa8ndFwNz","data":[],"visibility":"show","key":"okY4KvCyxS"}],"visibility":"show","key":"Sxm56r8AQ2"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Create a nested dictionary of models and experiments. It will be structured like this:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ADzH9BRhzB"}],"key":"FslYcLulYb"},{"type":"code","lang":"","value":"{'CESM2':\n  {\n    'piControl': <xarray.Dataset>,\n    'abrupt-2xCO2': <xarray.Dataset>\n  },\n  ...\n}","position":{"start":{"line":2,"column":1},"end":{"line":10,"column":1}},"key":"vIZTrcVp8d"}],"key":"Jzhdyr2mjB"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from collections import defaultdict\n\ndsets = defaultdict(dict)\nfor group, df in col_subset.df.groupby(by=['source_id', 'experiment_id']):\n    dsets[group[0]][group[1]] = open_delayed(df)","visibility":"show","key":"D3a8VTp4Tl"},{"type":"output","id":"Q_bqHoPHlRgR-CKD79gUT","data":[],"visibility":"show","key":"t5b6dBiGjK"}],"visibility":"show","key":"XQBJP5KQog"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Open one of the datasets directly, just to show what it looks like:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"C5uJutuAVm"}],"key":"Rpbc8p7NOJ"}],"key":"FveCpMCtId"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"%time open_dsets(df)","visibility":"show","key":"Akn44rBQwR"},{"type":"output","id":"pm-kRsbYV_AfNEji155sq","data":[{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n  dsets = [xr.open_zarr(fsspec.get_mapper(ds_url), consolidated=True)\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n  dsets = [xr.open_zarr(fsspec.get_mapper(ds_url), consolidated=True)\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n  dsets = [xr.open_zarr(fsspec.get_mapper(ds_url), consolidated=True)\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n  dsets = [xr.open_zarr(fsspec.get_mapper(ds_url), consolidated=True)\n"},{"output_type":"stream","name":"stdout","text":"CPU times: user 1.73 s, sys: 219 ms, total: 1.95 s\nWall time: 19.1 s\n"},{"output_type":"execute_result","execution_count":11,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 7GB\nDimensions:  (lat: 160, lon: 320, time: 8412)\nCoordinates:\n    height   float64 8B ...\n  * lat      (lat) float64 1kB -89.14 -88.03 -86.91 -85.79 ... 86.91 88.03 89.14\n  * lon      (lon) float64 3kB 0.0 1.125 2.25 3.375 ... 355.5 356.6 357.8 358.9\n  * time     (time) object 67kB 1850-01-16 00:00:00 ... 2550-12-16 00:00:00\nData variables:\n    tas      (time, lat, lon) float32 2GB dask.array<chunksize=(600, 160, 320), meta=np.ndarray>\n    rsut     (time, lat, lon) float32 2GB dask.array<chunksize=(600, 160, 320), meta=np.ndarray>\n    rsdt     (time, lat, lon) float32 2GB dask.array<chunksize=(600, 160, 320), meta=np.ndarray>\n    rlut     (time, lat, lon) float32 2GB dask.array<chunksize=(600, 160, 320), meta=np.ndarray>\nAttributes: (12/47)\n    Conventions:            CF-1.7 CMIP-6.2\n    activity_id:            CMIP\n    branch_method:          standard\n    branch_time_in_child:   0.0\n    branch_time_in_parent:  365243.0\n    cmor_version:           3.4.0\n    ...                     ...\n    tracking_id:            hdl:21.14100/a0bd7d8f-4785-4687-b510-fd87808051b6\n    variable_id:            tas\n    variant_label:          r1i1p1f1\n    status:                 2019-10-25;created;by nhn2@columbia.edu\n    netcdf_tracking_ids:    hdl:21.14100/a0bd7d8f-4785-4687-b510-fd87808051b6\n    version_id:             v20190222","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"d9ef8e36f524be12cb775110905c4699","path":"/cmip6-cookbook/build/d9ef8e36f524be12cb775110905c4699.html"}}}],"visibility":"show","key":"Vj2BClHSCR"}],"visibility":"show","key":"rMovPs7HRk"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now use dask to do this in parallel on all of the datasets:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lYUOhVCygQ"}],"key":"P7UqDdYxJw"}],"key":"u587AFx0Hq"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"dsets_ = dask.compute(dict(dsets))[0]","visibility":"show","key":"cf28RIJXxV"},{"type":"output","id":"5eKcgIk6PoxBO25vgpn1G","data":[{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"},{"output_type":"stream","name":"stderr","text":"/tmp/ipykernel_4265/1448205721.py:10: SerializationWarning: Unable to decode time axis into full numpy.datetime64[ns] objects, continuing using cftime.datetime objects instead, reason: dates out of range. To silence this warning use a coarser resolution 'time_unit' or specify 'use_cftime=True'.\n"}],"visibility":"show","key":"fw2ethpwtH"}],"visibility":"show","key":"EIiYCtxxig"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Reduce Data via Global Mean","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XhQ0w2s1YT"}],"identifier":"reduce-data-via-global-mean","label":"Reduce Data via Global Mean","html_id":"reduce-data-via-global-mean","implicit":true,"key":"wsTYUNWLwu"}],"visibility":"show","key":"hu9JgE9fDC"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We don’t want to load all of the raw model data into memory right away. Instead, we want to reduce the data by taking the global mean. We need to remember to weight this global mean by a factor proportional to ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CzMlotre1n"},{"type":"inlineCode","value":"cos(lat)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UWL6oUC7Jc"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Mis9en02QD"}],"key":"oGDOXsZQKC"}],"key":"UrUKk0RQ0W"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def get_lat_name(ds):\n    \"\"\"Figure out what is the latitude coordinate for each dataset.\"\"\"\n    for lat_name in ['lat', 'latitude']:\n        if lat_name in ds.coords:\n            return lat_name\n    raise RuntimeError(\"Couldn't find a latitude coordinate\")\n\ndef global_mean(ds):\n    \"\"\"Return global mean of a whole dataset.\"\"\"\n    lat = ds[get_lat_name(ds)]\n    weight = np.cos(np.deg2rad(lat))\n    weight /= weight.mean()\n    other_dims = set(ds.dims) - {'time'}\n    return (ds * weight).mean(other_dims)","visibility":"show","key":"Wv8WwL64YL"},{"type":"output","id":"uMn5P0fQJh9nFpA8WMl6i","data":[],"visibility":"show","key":"WqgUG0o6nk"}],"visibility":"show","key":"Mng71q0FeP"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We now apply this function, plus resampling to annual mean data, to all of the datasets. We also concatenate the experiments together into a single Dataset for each model. This is the most complex cell in the notebook. A lot is happening here.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H5CwI7p7Af"}],"key":"Cs29kKcpuD"}],"key":"PiAy1HxzTM"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"expts = ['piControl', co2_option]\nexpt_da = xr.DataArray(expts, dims='experiment_id',\n                       coords={'experiment_id': expts})\n\ndsets_aligned = {}\n\nfor k, v in tqdm(dsets_.items()):\n    expt_dsets = v.values()\n    if any([d is None for d in expt_dsets]):\n        print(f\"Missing experiment for {k}\")\n        continue\n\n    for ds in expt_dsets:\n        ds.coords['year'] = ds.time.dt.year - ds.time.dt.year[0]\n\n    # workaround for\n    # https://github.com/pydata/xarray/issues/2237#issuecomment-620961663\n    dsets_ann_mean = [v[expt].pipe(global_mean)\n                             .swap_dims({'time': 'year'})\n                             .drop_vars('time')\n                             .coarsen(year=12).mean()\n                      for expt in expts]\n\n    # align everything with the 2xCO2 experiment\n    dsets_aligned[k] = xr.concat(dsets_ann_mean, join='right',\n                                 dim=expt_da)","visibility":"show","key":"kPhwiNjC2w"},{"type":"output","id":"HHmj-4n_6yeQvKbCN1XnK","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"  0%|          | 0/7 [00:00<?, ?it/s]","content_type":"text/plain"},"application/vnd.jupyter.widget-view+json":{"content":"{\"version_major\":2,\"version_minor\":0,\"model_id\":\"d0e423022f66451cb515e094ddf22963\"}","content_type":"application/vnd.jupyter.widget-view+json"}}}],"visibility":"show","key":"ZZX4oDAolj"}],"visibility":"show","key":"GkBa1OA7Um"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Do the Computation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cr5ZUuqbTf"}],"identifier":"do-the-computation","label":"Do the Computation","html_id":"do-the-computation","implicit":true,"key":"V5T92Pdi0v"}],"key":"s3ABnMVN15"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Up to this point, no computations have actually happened. Everything has been “lazy”. Now we trigger the computation to actual occur and load the global/annual mean data into memory.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OXbcqRJqnP"}],"key":"Cd7J9EeVlu"}],"key":"TQzPV3Cwmy"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"dsets_aligned_ = dask.compute(dsets_aligned)[0]","visibility":"show","key":"pKu7dOg2Ot"},{"type":"output","id":"Bd3qI33NYv-ie292dSXQ5","data":[],"visibility":"show","key":"vUPTWOeJBG"}],"visibility":"show","key":"rhtao3ttIO"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we concatenate across models to produce one big dataset with all the required variables.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sGp7qWLeSo"}],"key":"Fbss7PkHfd"}],"key":"EiG33mfJQW"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"source_ids = list(dsets_aligned_.keys())\nsource_da = xr.DataArray(source_ids, dims='source_id',\n                         coords={'source_id': source_ids})\n\nbig_ds = xr.concat([ds.reset_coords(drop=True)\n                    for ds in dsets_aligned_.values()],\n                   dim=source_da)\nbig_ds","visibility":"show","key":"JqR1KS3xt5"},{"type":"output","id":"FtVjlZsFi1Jy8f5C4ypOQ","data":[{"output_type":"execute_result","execution_count":16,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 114kB\nDimensions:        (source_id: 7, experiment_id: 2, year: 250)\nCoordinates:\n  * year           (year) float64 2kB 0.0 1.0 2.0 3.0 ... 247.0 248.0 249.0\n  * experiment_id  (experiment_id) <U12 96B 'piControl' 'abrupt-2xCO2'\n  * source_id      (source_id) <U12 336B 'CESM2' 'GISS-E2-1-G' ... 'MRI-ESM2-0'\nData variables:\n    rsut           (source_id, experiment_id, year) float64 28kB 99.36 ... nan\n    tas            (source_id, experiment_id, year) float64 28kB 287.0 ... nan\n    rsdt           (source_id, experiment_id, year) float64 28kB 340.3 ... nan\n    rlut           (source_id, experiment_id, year) float64 28kB 240.2 ... nan","content_type":"text/plain"},"text/html":{"content_type":"text/html","hash":"df0c81bac20c8f7c8719931a9d92b9ea","path":"/cmip6-cookbook/build/df0c81bac20c8f7c8719931a9d92b9ea.html"}}}],"visibility":"show","key":"fR9Louy6Hk"}],"visibility":"show","key":"mCjoBj8M6b"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Calculated Derived Variables","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cKq8yqdVSa"}],"identifier":"calculated-derived-variables","label":"Calculated Derived Variables","html_id":"calculated-derived-variables","implicit":true,"key":"wD6Bo4q3K0"}],"key":"uRjwWOWytr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We need to calculate the net radiative imbalance, plus the anomaly of the abrupt 2xCO2 run compared to the piControl run.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"M3qbqrbOHV"}],"key":"X9D9XsMRyv"}],"key":"MjRWZcqmaa"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"big_ds['imbalance'] = big_ds['rsdt'] - big_ds['rsut'] - big_ds['rlut']\n\nds_mean = big_ds[['tas', 'imbalance']].sel(experiment_id='piControl').mean(dim='year')\nds_anom = big_ds[['tas', 'imbalance']] - ds_mean\n\n# add some metadata\nds_anom.tas.attrs['long_name'] = 'Global Mean Surface Temp Anom'\nds_anom.tas.attrs['units'] = 'K'\nds_anom.imbalance.attrs['long_name'] = 'Global Mean Radiative Imbalance'\nds_anom.imbalance.attrs['units'] = 'W m$^{-2}$'\n\nds_anom","visibility":"show","key":"mUQMkfL78J"},{"type":"output","id":"_xnq8coZFOToC-yMaHLLx","data":[{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 58kB\nDimensions:        (year: 250, experiment_id: 2, source_id: 7)\nCoordinates:\n  * year           (year) float64 2kB 0.0 1.0 2.0 3.0 ... 247.0 248.0 249.0\n  * experiment_id  (experiment_id) <U12 96B 'piControl' 'abrupt-2xCO2'\n  * source_id      (source_id) <U12 336B 'CESM2' 'GISS-E2-1-G' ... 'MRI-ESM2-0'\nData variables:\n    tas            (source_id, experiment_id, year) float64 28kB 0.06312 ... nan\n    imbalance      (source_id, experiment_id, year) float64 28kB -0.04953 ......","content_type":"text/plain"},"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 58kB\nDimensions:        (year: 250, experiment_id: 2, source_id: 7)\nCoordinates:\n  * year           (year) float64 2kB 0.0 1.0 2.0 3.0 ... 247.0 248.0 249.0\n  * experiment_id  (experiment_id) &lt;U12 96B &#x27;piControl&#x27; &#x27;abrupt-2xCO2&#x27;\n  * source_id      (source_id) &lt;U12 336B &#x27;CESM2&#x27; &#x27;GISS-E2-1-G&#x27; ... &#x27;MRI-ESM2-0&#x27;\nData variables:\n    tas            (source_id, experiment_id, year) float64 28kB 0.06312 ... nan\n    imbalance      (source_id, experiment_id, year) float64 28kB -0.04953 ......</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-095455c0-b537-4013-9d17-6402948905a7' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-095455c0-b537-4013-9d17-6402948905a7' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 250</li><li><span class='xr-has-index'>experiment_id</span>: 2</li><li><span class='xr-has-index'>source_id</span>: 7</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d638f67b-202b-433a-b0a0-f97d46d24f02' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d638f67b-202b-433a-b0a0-f97d46d24f02' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.0 2.0 ... 247.0 248.0 249.0</div><input id='attrs-b3595341-bcb5-459e-9ef0-01e6be307634' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b3595341-bcb5-459e-9ef0-01e6be307634' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b8810876-6696-448c-8242-4fd482c7e131' class='xr-var-data-in' type='checkbox'><label for='data-b8810876-6696-448c-8242-4fd482c7e131' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0.,   1.,   2., ..., 247., 248., 249.], shape=(250,))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>experiment_id</span></div><div class='xr-var-dims'>(experiment_id)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;piControl&#x27; &#x27;abrupt-2xCO2&#x27;</div><input id='attrs-0bc56fc2-3358-4244-b2f7-be9995673c4d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0bc56fc2-3358-4244-b2f7-be9995673c4d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4e45b4cf-7c51-4215-bd1d-9092183d55f9' class='xr-var-data-in' type='checkbox'><label for='data-4e45b4cf-7c51-4215-bd1d-9092183d55f9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;piControl&#x27;, &#x27;abrupt-2xCO2&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>source_id</span></div><div class='xr-var-dims'>(source_id)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;CESM2&#x27; ... &#x27;MRI-ESM2-0&#x27;</div><input id='attrs-14138868-6b80-4c73-8b58-54b054dbddb8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-14138868-6b80-4c73-8b58-54b054dbddb8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3f4f0a26-4425-4d92-8c88-e37ce327af95' class='xr-var-data-in' type='checkbox'><label for='data-3f4f0a26-4425-4d92-8c88-e37ce327af95' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;CESM2&#x27;, &#x27;GISS-E2-1-G&#x27;, &#x27;GISS-E2-1-H&#x27;, &#x27;GISS-E2-2-G&#x27;, &#x27;IPSL-CM6A-LR&#x27;,\n       &#x27;MIROC6&#x27;, &#x27;MRI-ESM2-0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6a1164e9-09cb-43b5-8cd7-a1fe16164df4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6a1164e9-09cb-43b5-8cd7-a1fe16164df4' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tas</span></div><div class='xr-var-dims'>(source_id, experiment_id, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.06312 0.1446 0.06249 ... nan nan</div><input id='attrs-2261bf82-6b62-463d-8b33-c8a05d19c9d5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2261bf82-6b62-463d-8b33-c8a05d19c9d5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4f5d500b-82d0-495a-85fd-0176a1b476d1' class='xr-var-data-in' type='checkbox'><label for='data-4f5d500b-82d0-495a-85fd-0176a1b476d1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Global Mean Surface Temp Anom</dd><dt><span>units :</span></dt><dd>K</dd></dl></div><div class='xr-var-data'><pre>array([[[ 0.06312165,  0.14458142,  0.06249077, ...,         nan,\n                 nan,         nan],\n        [ 0.55819223,  0.81745784,  1.09535866, ...,         nan,\n                 nan,         nan]],\n\n       [[ 0.02001347,  0.00559697,  0.01366791, ...,         nan,\n                 nan,         nan],\n        [ 0.56209054,  0.72870342,  1.00904565, ...,         nan,\n                 nan,         nan]],\n\n       [[-0.04873387,  0.07247968,  0.07979664, ...,         nan,\n                 nan,         nan],\n        [ 0.54441231,  0.96414749,  1.21208022, ...,         nan,\n                 nan,         nan]],\n\n       ...,\n\n       [[ 0.19686259,  0.21245707,  0.13900126, ...,         nan,\n                 nan,         nan],\n        [ 0.69655741,  1.2796873 ,  1.4661497 , ...,         nan,\n                 nan,         nan]],\n\n       [[-0.03490859,  0.10057523,  0.12656646, ...,  0.10152306,\n          0.01966124,  0.12999935],\n        [ 0.46719446,  0.73404254,  0.96515788, ...,  2.21891955,\n          1.99650302,  1.83362038]],\n\n       [[-0.0086573 , -0.03461188, -0.07018693, ...,         nan,\n                 nan,         nan],\n        [ 0.53457776,  0.6964805 ,  0.9663586 , ...,         nan,\n                 nan,         nan]]], shape=(7, 2, 250))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>imbalance</span></div><div class='xr-var-dims'>(source_id, experiment_id, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.04953 -0.777 0.4191 ... nan nan</div><input id='attrs-55fedeaa-75f6-4beb-b5c4-99666ed12736' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-55fedeaa-75f6-4beb-b5c4-99666ed12736' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-27f34a56-7462-4acc-ad70-7cb0fc467189' class='xr-var-data-in' type='checkbox'><label for='data-27f34a56-7462-4acc-ad70-7cb0fc467189' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Global Mean Radiative Imbalance</dd><dt><span>units :</span></dt><dd>W m$^{-2}$</dd></dl></div><div class='xr-var-data'><pre>array([[[-0.04953143, -0.77701077,  0.41913172, ...,         nan,\n                 nan,         nan],\n        [ 4.02604967,  3.35542682,  3.57872343, ...,         nan,\n                 nan,         nan]],\n\n       [[ 0.12200747, -0.16419291, -0.018885  , ...,         nan,\n                 nan,         nan],\n        [ 3.16992385,  2.79513042,  2.60900003, ...,         nan,\n                 nan,         nan]],\n\n       [[ 0.36922609,  0.21314474,  0.06571119, ...,         nan,\n                 nan,         nan],\n        [ 3.39890584,  2.55774641,  2.24246484, ...,         nan,\n                 nan,         nan]],\n\n       ...,\n\n       [[-0.091017  , -0.30018448, -0.13379501, ...,         nan,\n                 nan,         nan],\n        [ 3.90769363,  2.61029984,  1.81991745, ...,         nan,\n                 nan,         nan]],\n\n       [[ 0.05491239,  0.28466133, -0.20750343, ...,  0.11830477,\n         -0.1641636 ,  0.02286943],\n        [ 2.84889607,  2.16866012,  2.01363648, ..., -0.22945657,\n          0.64003458,  0.92900159]],\n\n       [[-0.41629225, -0.16471851, -0.34318069, ...,         nan,\n                 nan,         nan],\n        [ 2.99631382,  2.48143489,  2.49059289, ...,         nan,\n                 nan,         nan]]], shape=(7, 2, 250))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-48f13af2-3f43-4d1a-8b10-1425a91aa238' class='xr-section-summary-in' type='checkbox'  ><label for='section-48f13af2-3f43-4d1a-8b10-1425a91aa238' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-d9291a4f-bd82-479f-897e-a27798ce69c1' class='xr-index-data-in' type='checkbox'/><label for='index-d9291a4f-bd82-479f-897e-a27798ce69c1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,\n       ...\n       240.0, 241.0, 242.0, 243.0, 244.0, 245.0, 246.0, 247.0, 248.0, 249.0],\n      dtype=&#x27;float64&#x27;, name=&#x27;year&#x27;, length=250))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>experiment_id</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-05aa0012-caad-4c8c-8d0c-dbeb6b557190' class='xr-index-data-in' type='checkbox'/><label for='index-05aa0012-caad-4c8c-8d0c-dbeb6b557190' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;piControl&#x27;, &#x27;abrupt-2xCO2&#x27;], dtype=&#x27;object&#x27;, name=&#x27;experiment_id&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>source_id</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-ea28ae3d-830b-4abc-a69f-9ea36cf6fa08' class='xr-index-data-in' type='checkbox'/><label for='index-ea28ae3d-830b-4abc-a69f-9ea36cf6fa08' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;CESM2&#x27;, &#x27;GISS-E2-1-G&#x27;, &#x27;GISS-E2-1-H&#x27;, &#x27;GISS-E2-2-G&#x27;, &#x27;IPSL-CM6A-LR&#x27;,\n       &#x27;MIROC6&#x27;, &#x27;MRI-ESM2-0&#x27;],\n      dtype=&#x27;object&#x27;, name=&#x27;source_id&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a7e72816-06cd-4741-bb80-8ac0a45e3a5c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a7e72816-06cd-4741-bb80-8ac0a45e3a5c' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"}}}],"visibility":"show","key":"YI3nlEHiaY"}],"visibility":"show","key":"KAAktIMY8v"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Plot Timeseries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"R30Rv6lgxo"}],"identifier":"plot-timeseries","label":"Plot Timeseries","html_id":"plot-timeseries","implicit":true,"key":"fLRboeTNgy"}],"key":"yMoYVpokiF"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here we plot the global mean surface temperature for each model:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SHcLxAraEz"}],"key":"OrZnxUTjLT"}],"key":"Jhwoxop7mW"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_anom.tas.plot.line(col='source_id', x='year', col_wrap=5)","visibility":"show","key":"vFxomDUa2X"},{"type":"output","id":"8cUKZkmFqztbA6DKqD3Ka","data":[{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"text/plain":{"content":"<xarray.plot.facetgrid.FacetGrid at 0x7fb69ddf2e10>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1747.88x600 with 10 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"39eba73697119748ba47062959703431","path":"/cmip6-cookbook/build/39eba73697119748ba47062959703431.png"}}}],"visibility":"show","key":"G3FzcIG8wE"}],"visibility":"show","key":"rD53Hvavtu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can see that the models cover different time intervals. Let’s limit the rest of our analysis to the first 150 years.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Rn6taKunCf"}],"key":"KQUBxO2uuw"}],"key":"Tpg2oIKn9A"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"first_150_years = slice(0, 149)\nds_anom.tas.sel(year=first_150_years).plot.line(col='source_id', x='year', col_wrap=5)","visibility":"show","key":"OF7z0BH02v"},{"type":"output","id":"2o_CZOpoRS0_XtGhQuVa3","data":[{"output_type":"execute_result","execution_count":19,"metadata":{},"data":{"text/plain":{"content":"<xarray.plot.facetgrid.FacetGrid at 0x7fb69dc429d0>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1747.88x600 with 10 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"578bbd3a6f9e6d6265db92c8c47886c3","path":"/cmip6-cookbook/build/578bbd3a6f9e6d6265db92c8c47886c3.png"}}}],"visibility":"show","key":"AbqZxx0haj"}],"visibility":"show","key":"doVeUa3Ybf"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Same thing for radiative imbalance:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ukvn7lQd7e"}],"key":"YuMj6huBvq"}],"key":"Zw8croBV4O"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_anom.imbalance.sel(year=first_150_years).plot.line(col='source_id', x='year', col_wrap=5)","visibility":"show","key":"ZI65sV1Ap5"},{"type":"output","id":"I3PViih0LtteH-u6gSRb5","data":[{"output_type":"execute_result","execution_count":20,"metadata":{},"data":{"text/plain":{"content":"<xarray.plot.facetgrid.FacetGrid at 0x7fb69b92a2d0>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1747.88x600 with 10 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"c3ca5cc305be98d11eebedda4d0282fc","path":"/cmip6-cookbook/build/c3ca5cc305be98d11eebedda4d0282fc.png"}}}],"visibility":"show","key":"ruJJEDWzCm"}],"visibility":"show","key":"YK5R1dAbN0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Calculate ECS","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pQGAes71eB"}],"identifier":"calculate-ecs","label":"Calculate ECS","html_id":"calculate-ecs","implicit":true,"key":"EjMjlIXkmC"}],"key":"tjZhxf1QfD"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_abrupt = ds_anom.sel(year=first_150_years, experiment_id=co2_option).reset_coords(drop=True)\n\ndef calc_ecs(tas, imb):\n    a, b = np.polyfit(tas, imb, 1)\n    ecs = -1.0 * (b/a) # Change -1.0 to -0.5 if using 4xCO2\n    return xr.DataArray(ecs)\n\nds_abrupt['ecs'] = xr.apply_ufunc(calc_ecs, ds_abrupt.tas, ds_abrupt.imbalance, vectorize=True, input_core_dims=[['year'], ['year']])\nds_abrupt.compute()","visibility":"show","key":"tx5wKiYbr3"},{"type":"output","id":"1WJvXP9M1XhxOxpCYQDFw","data":[{"output_type":"execute_result","execution_count":21,"metadata":{},"data":{"text/plain":{"content":"<xarray.Dataset> Size: 18kB\nDimensions:    (year: 150, source_id: 7)\nCoordinates:\n  * year       (year) float64 1kB 0.0 1.0 2.0 3.0 ... 146.0 147.0 148.0 149.0\n  * source_id  (source_id) <U12 336B 'CESM2' 'GISS-E2-1-G' ... 'MRI-ESM2-0'\nData variables:\n    tas        (source_id, year) float64 8kB 0.5582 0.8175 1.095 ... 1.646 1.616\n    imbalance  (source_id, year) float64 8kB 4.026 3.355 3.579 ... 1.022 0.7031\n    ecs        (source_id) float64 56B 3.526 2.659 2.932 2.501 3.827 2.235 2.552","content_type":"text/plain"},"text/html":{"content":"<div><svg style=\"position: absolute; width: 0; height: 0; overflow: hidden\">\n<defs>\n<symbol id=\"icon-database\" viewBox=\"0 0 32 32\">\n<path d=\"M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z\"></path>\n<path d=\"M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n<path d=\"M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z\"></path>\n</symbol>\n<symbol id=\"icon-file-text2\" viewBox=\"0 0 32 32\">\n<path d=\"M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z\"></path>\n<path d=\"M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n<path d=\"M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z\"></path>\n</symbol>\n</defs>\n</svg>\n<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.\n *\n */\n\n:root {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base rgba(0, 0, 0, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(0, 0, 0, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, white)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, white) h s calc(l - 15))\n  );\n}\n\nhtml[theme=\"dark\"],\nhtml[data-theme=\"dark\"],\nbody[data-theme=\"dark\"],\nbody.vscode-dark {\n  --xr-font-color0: var(\n    --jp-content-font-color0,\n    var(--pst-color-text-base, rgba(255, 255, 255, 1))\n  );\n  --xr-font-color2: var(\n    --jp-content-font-color2,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.54))\n  );\n  --xr-font-color3: var(\n    --jp-content-font-color3,\n    var(--pst-color-text-base, rgba(255, 255, 255, 0.38))\n  );\n  --xr-border-color: var(\n    --jp-border-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 10))\n  );\n  --xr-disabled-color: var(\n    --jp-layout-color3,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 40))\n  );\n  --xr-background-color: var(\n    --jp-layout-color0,\n    var(--pst-color-on-background, #111111)\n  );\n  --xr-background-color-row-even: var(\n    --jp-layout-color1,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 5))\n  );\n  --xr-background-color-row-odd: var(\n    --jp-layout-color2,\n    hsl(from var(--pst-color-on-background, #111111) h s calc(l + 15))\n  );\n}\n\n.xr-wrap {\n  display: block !important;\n  min-width: 300px;\n  max-width: 700px;\n}\n\n.xr-text-repr-fallback {\n  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */\n  display: none;\n}\n\n.xr-header {\n  padding-top: 6px;\n  padding-bottom: 6px;\n  margin-bottom: 4px;\n  border-bottom: solid 1px var(--xr-border-color);\n}\n\n.xr-header > div,\n.xr-header > ul {\n  display: inline;\n  margin-top: 0;\n  margin-bottom: 0;\n}\n\n.xr-obj-type,\n.xr-array-name {\n  margin-left: 2px;\n  margin-right: 10px;\n}\n\n.xr-obj-type {\n  color: var(--xr-font-color2);\n}\n\n.xr-sections {\n  padding-left: 0 !important;\n  display: grid;\n  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;\n}\n\n.xr-section-item {\n  display: contents;\n}\n\n.xr-section-item input {\n  display: inline-block;\n  opacity: 0;\n  height: 0;\n}\n\n.xr-section-item input + label {\n  color: var(--xr-disabled-color);\n  border: 2px solid transparent !important;\n}\n\n.xr-section-item input:enabled + label {\n  cursor: pointer;\n  color: var(--xr-font-color2);\n}\n\n.xr-section-item input:focus + label {\n  border: 2px solid var(--xr-font-color0) !important;\n}\n\n.xr-section-item input:enabled + label:hover {\n  color: var(--xr-font-color0);\n}\n\n.xr-section-summary {\n  grid-column: 1;\n  color: var(--xr-font-color2);\n  font-weight: 500;\n}\n\n.xr-section-summary > span {\n  display: inline-block;\n  padding-left: 0.5em;\n}\n\n.xr-section-summary-in:disabled + label {\n  color: var(--xr-font-color2);\n}\n\n.xr-section-summary-in + label:before {\n  display: inline-block;\n  content: \"►\";\n  font-size: 11px;\n  width: 15px;\n  text-align: center;\n}\n\n.xr-section-summary-in:disabled + label:before {\n  color: var(--xr-disabled-color);\n}\n\n.xr-section-summary-in:checked + label:before {\n  content: \"▼\";\n}\n\n.xr-section-summary-in:checked + label > span {\n  display: none;\n}\n\n.xr-section-summary,\n.xr-section-inline-details {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n.xr-section-inline-details {\n  grid-column: 2 / -1;\n}\n\n.xr-section-details {\n  display: none;\n  grid-column: 1 / -1;\n  margin-bottom: 5px;\n}\n\n.xr-section-summary-in:checked ~ .xr-section-details {\n  display: contents;\n}\n\n.xr-array-wrap {\n  grid-column: 1 / -1;\n  display: grid;\n  grid-template-columns: 20px auto;\n}\n\n.xr-array-wrap > label {\n  grid-column: 1;\n  vertical-align: top;\n}\n\n.xr-preview {\n  color: var(--xr-font-color3);\n}\n\n.xr-array-preview,\n.xr-array-data {\n  padding: 0 5px !important;\n  grid-column: 2;\n}\n\n.xr-array-data,\n.xr-array-in:checked ~ .xr-array-preview {\n  display: none;\n}\n\n.xr-array-in:checked ~ .xr-array-data,\n.xr-array-preview {\n  display: inline-block;\n}\n\n.xr-dim-list {\n  display: inline-block !important;\n  list-style: none;\n  padding: 0 !important;\n  margin: 0;\n}\n\n.xr-dim-list li {\n  display: inline-block;\n  padding: 0;\n  margin: 0;\n}\n\n.xr-dim-list:before {\n  content: \"(\";\n}\n\n.xr-dim-list:after {\n  content: \")\";\n}\n\n.xr-dim-list li:not(:last-child):after {\n  content: \",\";\n  padding-right: 5px;\n}\n\n.xr-has-index {\n  font-weight: bold;\n}\n\n.xr-var-list,\n.xr-var-item {\n  display: contents;\n}\n\n.xr-var-item > div,\n.xr-var-item label,\n.xr-var-item > .xr-var-name span {\n  background-color: var(--xr-background-color-row-even);\n  border-color: var(--xr-background-color-row-odd);\n  margin-bottom: 0;\n  padding-top: 2px;\n}\n\n.xr-var-item > .xr-var-name:hover span {\n  padding-right: 5px;\n}\n\n.xr-var-list > li:nth-child(odd) > div,\n.xr-var-list > li:nth-child(odd) > label,\n.xr-var-list > li:nth-child(odd) > .xr-var-name span {\n  background-color: var(--xr-background-color-row-odd);\n  border-color: var(--xr-background-color-row-even);\n}\n\n.xr-var-name {\n  grid-column: 1;\n}\n\n.xr-var-dims {\n  grid-column: 2;\n}\n\n.xr-var-dtype {\n  grid-column: 3;\n  text-align: right;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-preview {\n  grid-column: 4;\n}\n\n.xr-index-preview {\n  grid-column: 2 / 5;\n  color: var(--xr-font-color2);\n}\n\n.xr-var-name,\n.xr-var-dims,\n.xr-var-dtype,\n.xr-preview,\n.xr-attrs dt {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-right: 10px;\n}\n\n.xr-var-name:hover,\n.xr-var-dims:hover,\n.xr-var-dtype:hover,\n.xr-attrs dt:hover {\n  overflow: visible;\n  width: auto;\n  z-index: 1;\n}\n\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  display: none;\n  border-top: 2px dotted var(--xr-background-color);\n  padding-bottom: 20px !important;\n  padding-top: 10px !important;\n}\n\n.xr-var-attrs-in + label,\n.xr-var-data-in + label,\n.xr-index-data-in + label {\n  padding: 0 1px;\n}\n\n.xr-var-attrs-in:checked ~ .xr-var-attrs,\n.xr-var-data-in:checked ~ .xr-var-data,\n.xr-index-data-in:checked ~ .xr-index-data {\n  display: block;\n}\n\n.xr-var-data > table {\n  float: right;\n}\n\n.xr-var-data > pre,\n.xr-index-data > pre,\n.xr-var-data > table > tbody > tr {\n  background-color: transparent !important;\n}\n\n.xr-var-name span,\n.xr-var-data,\n.xr-index-name div,\n.xr-index-data,\n.xr-attrs {\n  padding-left: 25px !important;\n}\n\n.xr-attrs,\n.xr-var-attrs,\n.xr-var-data,\n.xr-index-data {\n  grid-column: 1 / -1;\n}\n\ndl.xr-attrs {\n  padding: 0;\n  margin: 0;\n  display: grid;\n  grid-template-columns: 125px auto;\n}\n\n.xr-attrs dt,\n.xr-attrs dd {\n  padding: 0;\n  margin: 0;\n  float: left;\n  padding-right: 10px;\n  width: auto;\n}\n\n.xr-attrs dt {\n  font-weight: normal;\n  grid-column: 1;\n}\n\n.xr-attrs dt:hover span {\n  display: inline-block;\n  background: var(--xr-background-color);\n  padding-right: 10px;\n}\n\n.xr-attrs dd {\n  grid-column: 2;\n  white-space: pre-wrap;\n  word-break: break-all;\n}\n\n.xr-icon-database,\n.xr-icon-file-text2,\n.xr-no-icon {\n  display: inline-block;\n  vertical-align: middle;\n  width: 1em;\n  height: 1.5em !important;\n  stroke-width: 0;\n  stroke: currentColor;\n  fill: currentColor;\n}\n\n.xr-var-attrs-in:checked + label > .xr-icon-file-text2,\n.xr-var-data-in:checked + label > .xr-icon-database,\n.xr-index-data-in:checked + label > .xr-icon-database {\n  color: var(--xr-font-color0);\n  filter: drop-shadow(1px 1px 5px var(--xr-font-color2));\n  stroke-width: 0.8px;\n}\n</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 18kB\nDimensions:    (year: 150, source_id: 7)\nCoordinates:\n  * year       (year) float64 1kB 0.0 1.0 2.0 3.0 ... 146.0 147.0 148.0 149.0\n  * source_id  (source_id) &lt;U12 336B &#x27;CESM2&#x27; &#x27;GISS-E2-1-G&#x27; ... &#x27;MRI-ESM2-0&#x27;\nData variables:\n    tas        (source_id, year) float64 8kB 0.5582 0.8175 1.095 ... 1.646 1.616\n    imbalance  (source_id, year) float64 8kB 4.026 3.355 3.579 ... 1.022 0.7031\n    ecs        (source_id) float64 56B 3.526 2.659 2.932 2.501 3.827 2.235 2.552</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-2c092837-c7d4-4c5c-879e-1b2a1b3f8c40' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2c092837-c7d4-4c5c-879e-1b2a1b3f8c40' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>year</span>: 150</li><li><span class='xr-has-index'>source_id</span>: 7</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-68297c16-2621-4e14-813d-cc02b24c43f8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-68297c16-2621-4e14-813d-cc02b24c43f8' class='xr-section-summary' >Coordinates: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>year</span></div><div class='xr-var-dims'>(year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 1.0 2.0 ... 147.0 148.0 149.0</div><input id='attrs-1ee454eb-73e3-40c4-b87a-23a9b9cf1e41' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1ee454eb-73e3-40c4-b87a-23a9b9cf1e41' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7d829b83-7af4-4eb2-bfad-bdd70f33a784' class='xr-var-data-in' type='checkbox'><label for='data-7d829b83-7af4-4eb2-bfad-bdd70f33a784' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  0.,   1.,   2.,   3.,   4.,   5.,   6.,   7.,   8.,   9.,  10.,  11.,\n        12.,  13.,  14.,  15.,  16.,  17.,  18.,  19.,  20.,  21.,  22.,  23.,\n        24.,  25.,  26.,  27.,  28.,  29.,  30.,  31.,  32.,  33.,  34.,  35.,\n        36.,  37.,  38.,  39.,  40.,  41.,  42.,  43.,  44.,  45.,  46.,  47.,\n        48.,  49.,  50.,  51.,  52.,  53.,  54.,  55.,  56.,  57.,  58.,  59.,\n        60.,  61.,  62.,  63.,  64.,  65.,  66.,  67.,  68.,  69.,  70.,  71.,\n        72.,  73.,  74.,  75.,  76.,  77.,  78.,  79.,  80.,  81.,  82.,  83.,\n        84.,  85.,  86.,  87.,  88.,  89.,  90.,  91.,  92.,  93.,  94.,  95.,\n        96.,  97.,  98.,  99., 100., 101., 102., 103., 104., 105., 106., 107.,\n       108., 109., 110., 111., 112., 113., 114., 115., 116., 117., 118., 119.,\n       120., 121., 122., 123., 124., 125., 126., 127., 128., 129., 130., 131.,\n       132., 133., 134., 135., 136., 137., 138., 139., 140., 141., 142., 143.,\n       144., 145., 146., 147., 148., 149.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>source_id</span></div><div class='xr-var-dims'>(source_id)</div><div class='xr-var-dtype'>&lt;U12</div><div class='xr-var-preview xr-preview'>&#x27;CESM2&#x27; ... &#x27;MRI-ESM2-0&#x27;</div><input id='attrs-bfcc825b-a4e5-4136-91a8-7cc2f2c837ec' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bfcc825b-a4e5-4136-91a8-7cc2f2c837ec' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5d5fce60-da9f-4769-a1b4-507032eb6f9d' class='xr-var-data-in' type='checkbox'><label for='data-5d5fce60-da9f-4769-a1b4-507032eb6f9d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;CESM2&#x27;, &#x27;GISS-E2-1-G&#x27;, &#x27;GISS-E2-1-H&#x27;, &#x27;GISS-E2-2-G&#x27;, &#x27;IPSL-CM6A-LR&#x27;,\n       &#x27;MIROC6&#x27;, &#x27;MRI-ESM2-0&#x27;], dtype=&#x27;&lt;U12&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e4f1bee2-9c55-4db9-afef-2347fa13b009' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e4f1bee2-9c55-4db9-afef-2347fa13b009' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tas</span></div><div class='xr-var-dims'>(source_id, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.5582 0.8175 1.095 ... 1.646 1.616</div><input id='attrs-2a2fb98f-1070-4c27-b799-4245a2fcb222' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2a2fb98f-1070-4c27-b799-4245a2fcb222' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7133ee10-b368-414d-b073-1be33064118a' class='xr-var-data-in' type='checkbox'><label for='data-7133ee10-b368-414d-b073-1be33064118a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Global Mean Surface Temp Anom</dd><dt><span>units :</span></dt><dd>K</dd></dl></div><div class='xr-var-data'><pre>array([[0.55819223, 0.81745784, 1.09535866, ..., 2.78579546, 2.81815608,\n        2.84298753],\n       [0.56209054, 0.72870342, 1.00904565, ..., 2.30772005, 2.2496876 ,\n        2.14807954],\n       [0.54441231, 0.96414749, 1.21208022, ..., 2.63851405, 2.42792187,\n        2.34847531],\n       ...,\n       [0.69655741, 1.2796873 , 1.4661497 , ..., 3.09743632, 3.02495707,\n        3.20421733],\n       [0.46719446, 0.73404254, 0.96515788, ..., 2.01300088, 1.91896167,\n        1.96757883],\n       [0.53457776, 0.6964805 , 0.9663586 , ..., 1.89364471, 1.64573962,\n        1.61609827]], shape=(7, 150))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>imbalance</span></div><div class='xr-var-dims'>(source_id, year)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.026 3.355 3.579 ... 1.022 0.7031</div><input id='attrs-adeadc84-88d7-4dcc-9ff4-e4586852f222' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-adeadc84-88d7-4dcc-9ff4-e4586852f222' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-50bdd885-70b5-4a6a-93c8-08bcec3024e8' class='xr-var-data-in' type='checkbox'><label for='data-50bdd885-70b5-4a6a-93c8-08bcec3024e8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Global Mean Radiative Imbalance</dd><dt><span>units :</span></dt><dd>W m$^{-2}$</dd></dl></div><div class='xr-var-data'><pre>array([[4.02604967, 3.35542682, 3.57872343, ..., 0.65531467, 1.46648058,\n        1.09784156],\n       [3.16992385, 2.79513042, 2.60900003, ..., 0.46905707, 0.54642323,\n        0.5188314 ],\n       [3.39890584, 2.55774641, 2.24246484, ..., 0.16186796, 0.48404896,\n        1.12914552],\n       ...,\n       [3.90769363, 2.61029984, 1.81991745, ..., 0.58088089, 0.90067459,\n        1.13007523],\n       [2.84889607, 2.16866012, 2.01363648, ..., 1.03411792, 0.76245993,\n        0.66630028],\n       [2.99631382, 2.48143489, 2.49059289, ..., 0.81439704, 1.02247347,\n        0.70310016]], shape=(7, 150))</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ecs</span></div><div class='xr-var-dims'>(source_id)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>3.526 2.659 2.932 ... 2.235 2.552</div><input id='attrs-831a6f66-3f81-4688-ada3-164d0c6abb09' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-831a6f66-3f81-4688-ada3-164d0c6abb09' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6900c593-374f-4b7a-b9c0-fc7f98687b93' class='xr-var-data-in' type='checkbox'><label for='data-6900c593-374f-4b7a-b9c0-fc7f98687b93' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([3.52587433, 2.65858194, 2.93219464, 2.50138386, 3.82672137,\n       2.23504735, 2.55244043])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-50469e9f-256a-4b32-b516-38a906df96dd' class='xr-section-summary-in' type='checkbox'  ><label for='section-50469e9f-256a-4b32-b516-38a906df96dd' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>year</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-5fa95db7-2914-4331-90ce-2e3e0813fad4' class='xr-index-data-in' type='checkbox'/><label for='index-5fa95db7-2914-4331-90ce-2e3e0813fad4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  0.0,   1.0,   2.0,   3.0,   4.0,   5.0,   6.0,   7.0,   8.0,   9.0,\n       ...\n       140.0, 141.0, 142.0, 143.0, 144.0, 145.0, 146.0, 147.0, 148.0, 149.0],\n      dtype=&#x27;float64&#x27;, name=&#x27;year&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>source_id</div></div><div class='xr-index-preview'>PandasIndex</div><input type='checkbox' disabled/><label></label><input id='index-95834cb2-1f27-42f9-8eca-061efe629240' class='xr-index-data-in' type='checkbox'/><label for='index-95834cb2-1f27-42f9-8eca-061efe629240' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([&#x27;CESM2&#x27;, &#x27;GISS-E2-1-G&#x27;, &#x27;GISS-E2-1-H&#x27;, &#x27;GISS-E2-2-G&#x27;, &#x27;IPSL-CM6A-LR&#x27;,\n       &#x27;MIROC6&#x27;, &#x27;MRI-ESM2-0&#x27;],\n      dtype=&#x27;object&#x27;, name=&#x27;source_id&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d5a7e8a0-17b3-4df6-afd2-cf0b5aa9f509' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d5a7e8a0-17b3-4df6-afd2-cf0b5aa9f509' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div>","content_type":"text/html"}}}],"visibility":"show","key":"OC7azaqtAy"}],"visibility":"show","key":"BA2hoYF68Q"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Also, make sure that we set a couple of the variables to be coordinates.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LnTxU2Xapk"}],"key":"Bm3JA5GXwK"}],"key":"dQb8aMuVrZ"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_abrupt = ds_abrupt.set_coords(['tas', 'imbalance'])\n\nfg = ds_abrupt.plot.scatter(x='tas', y='imbalance', col='source_id', col_wrap=4, add_colorbar=False)\n\ndef calc_and_plot_ecs(x, y, **kwargs):\n    x = x[~np.isnan(x)]\n    y = y[~np.isnan(y)]\n    a, b = np.polyfit(x, y, 1)\n    ecs = -1.0 * b/a\n    plt.autoscale(False)\n    plt.plot([0, 10], np.polyval([a, b], [0, 10]), 'k')\n    plt.text(2, 3, f'ECS = {ecs:3.2f}', fontdict={'weight': 'bold', 'size': 12})\n    plt.grid()\n\nfg.map(calc_and_plot_ecs, 'tas', 'imbalance')","visibility":"show","key":"QuYxbZLp41"},{"type":"output","id":"DfqxB1h1Ki-R1w4bFUGXI","data":[{"output_type":"execute_result","execution_count":22,"metadata":{},"data":{"text/plain":{"content":"<xarray.plot.facetgrid.FacetGrid at 0x7fb688e26510>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1300x600 with 8 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ce9ccb6595570730cab4236557190096","path":"/cmip6-cookbook/build/ce9ccb6595570730cab4236557190096.png"}}}],"visibility":"show","key":"EcxA0vCzbS"}],"visibility":"show","key":"vSznFowojG"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_abrupt.ecs.plot.hist();","visibility":"show","key":"OnfgxsqHmw"},{"type":"output","id":"67PrT6PRI6-esdbauGKLr","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"ab7242afe2df40f4a71edc636d926b5b","path":"/cmip6-cookbook/build/ab7242afe2df40f4a71edc636d926b5b.png"}}}],"visibility":"show","key":"bmtOzkLDM9"}],"visibility":"show","key":"XPsobCiY0o"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"ds_abrupt.ecs.to_dataframe().sort_values('ecs').plot(kind='bar')","visibility":"show","key":"gXBpdbazjj"},{"type":"output","id":"9KagPlgAecqg5xEmwpaCQ","data":[{"output_type":"execute_result","execution_count":24,"metadata":{},"data":{"text/plain":{"content":"<Axes: xlabel='source_id'>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"<Figure size 1200x600 with 1 Axes>","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"d57e1e714599e7c0a085fd473e3c7563","path":"/cmip6-cookbook/build/d57e1e714599e7c0a085fd473e3c7563.png"}}}],"visibility":"show","key":"fWQaBUNOGz"}],"visibility":"show","key":"IUZXEMrFH0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We’re at the end of the notebook, so let’s shutdown our Dask cluster.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gtvk6Ltq6Z"}],"key":"lMRigObT9m"}],"key":"U6w3I1lDGP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"client.shutdown()","key":"K0LAeGTVwU"},{"type":"output","id":"j6wdUrbK2fFJzfShTL9oy","data":[],"key":"cidc3WaXFl"}],"key":"ShD8VRe4zQ"},{"type":"block","kind":"notebook-content","children":[{"type":"thematicBreak","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rEsSNGrpuA"}],"key":"ilWcRT5WUT"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Summary","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kuVtjtDoIX"}],"identifier":"summary","label":"Summary","html_id":"summary","implicit":true,"key":"cExBpmGoFF"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In this notebook, we estimated ECS for a subset of CMIP6 models using the Gregory method.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"BN2rPxR93w"}],"key":"K4vfHtnuoo"},{"type":"heading","depth":3,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"What’s next?","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"EgJ49Jjfmo"}],"identifier":"whats-next","label":"What’s next?","html_id":"whats-next","implicit":true,"key":"TvvhouosT1"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"We will plot global average surface air temperature for a historical run and two branching emissions scenarios.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dsj7WzAcwo"}],"key":"UXqZnBUOdX"}],"key":"nXqzaEEII3"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Resources and references","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L26peglvlJ"}],"identifier":"resources-and-references","label":"Resources and references","html_id":"resources-and-references","implicit":true,"key":"jCIfiWcL4U"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"link","url":"http://gallery.pangeo.io/repos/pangeo-gallery/cmip6/ECS_Gregory_method.html","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Original notebook in the Pangeo Gallery","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"VtNjojoqJ7"}],"urlSource":"http://gallery.pangeo.io/repos/pangeo-gallery/cmip6/ECS_Gregory_method.html","key":"Ur82xU4IWl"},{"type":"text","value":" by Henri Drake and ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RlCIlSQZPi"},{"type":"link","url":"https://ocean-transport.github.io/","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Ryan Abernathey","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"etDtsOrRQa"}],"urlSource":"https://ocean-transport.github.io/","key":"lnVmUeJbv7"}],"key":"QD3X3kvtV7"}],"key":"FLsIAQbSr7"}],"visibility":"show","key":"LulwVGIQgf"}],"key":"ZoTI31Thy3"},"references":{"cite":{"order":["Gregory_2004","Mauritsen_2019"],"data":{"Gregory_2004":{"label":"Gregory_2004","enumerator":"1","doi":"10.1029/2003gl018747","html":"Gregory, J. M., Ingram, W. J., Palmer, M. A., Jones, G. S., Stott, P. A., Thorpe, R. B., Lowe, J. A., Johns, T. C., & Williams, K. D. (2004). A new method for diagnosing radiative forcing and climate sensitivity. <i>Geophysical Research Letters</i>, <i>31</i>(3). <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1029/2003gl018747\">10.1029/2003gl018747</a>","url":"https://doi.org/10.1029/2003gl018747"},"Mauritsen_2019":{"label":"Mauritsen_2019","enumerator":"2","doi":"10.1029/2018ms001400","html":"Mauritsen, T., Bader, J., Becker, T., Behrens, J., Bittner, M., Brokopf, R., Brovkin, V., Claussen, M., Crueger, T., Esch, M., Fast, I., Fiedler, S., Fläschner, D., Gayler, V., Giorgetta, M., Goll, D. S., Haak, H., Hagemann, S., Hedemann, C., … Roeckner, E. (2019). Developments in the MPI‐M Earth System Model version 1.2 (MPI‐ESM1.2) and Its Response to Increasing CO2. <i>Journal of Advances in Modeling Earth Systems</i>, <i>11</i>(4), 998–1038. <a target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.1029/2018ms001400\">10.1029/2018ms001400</a>","url":"https://doi.org/10.1029/2018ms001400"}}}},"footer":{"navigation":{"prev":{"title":"Search and Load CMIP6 Data via ESGF/OPeNDAP","url":"/notebooks/foundations/esgf-opendap","group":"Foundations"},"next":{"title":"Global Mean Surface Temperature","url":"/notebooks/example-workflows/gmst","group":"Example workflows"}}},"domain":"http://localhost:3000"}